webpackHotUpdate_N_E("pages/_app",{

/***/ "./components/Search.js":
/*!******************************!*\
  !*** ./components/Search.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(module) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Search; });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"./node_modules/react/jsx-dev-runtime.js\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var downshift__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! downshift */ \"./node_modules/downshift/dist/downshift.esm.js\");\n/* harmony import */ var _styles_DropDown__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./styles/DropDown */ \"./components/styles/DropDown.js\");\n\nvar _jsxFileName = \"/Users/robkondratowicz/Desktop/Actualize/fretstop_frontend/components/Search.js\";\n\n\nfunction Search() {\n  var getMenuProps = downshift__WEBPACK_IMPORTED_MODULE_1__[\"useCombobox\"].getMenuProps,\n      getInputProps = downshift__WEBPACK_IMPORTED_MODULE_1__[\"useCombobox\"].getInputProps,\n      getComboboxProps = downshift__WEBPACK_IMPORTED_MODULE_1__[\"useCombobox\"].getComboboxProps;\n  return /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(_styles_DropDown__WEBPACK_IMPORTED_MODULE_2__[\"SearchStyles\"], {\n    children: [/*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(\"div\", {\n      children: /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(\"input\", {\n        type: \"search\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 9,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 8,\n      columnNumber: 7\n    }, this), /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(_styles_DropDown__WEBPACK_IMPORTED_MODULE_2__[\"DropDown\"], {\n      children: [/*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(_styles_DropDown__WEBPACK_IMPORTED_MODULE_2__[\"DropDownItem\"], {\n        children: \"Hey\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 12,\n        columnNumber: 9\n      }, this), /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(_styles_DropDown__WEBPACK_IMPORTED_MODULE_2__[\"DropDownItem\"], {\n        children: \"Hey\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 13,\n        columnNumber: 9\n      }, this), /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(_styles_DropDown__WEBPACK_IMPORTED_MODULE_2__[\"DropDownItem\"], {\n        children: \"Hey\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 14,\n        columnNumber: 9\n      }, this), /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxDEV\"])(_styles_DropDown__WEBPACK_IMPORTED_MODULE_2__[\"DropDownItem\"], {\n        children: \"Hey\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 15,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 11,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 7,\n    columnNumber: 5\n  }, this);\n}\n_c = Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");\n\n;\n    var _a, _b;\n    // Legacy CSS implementations will `eval` browser code in a Node.js context\n    // to extract CSS. For backwards compatibility, we need to check we're in a\n    // browser context before continuing.\n    if (typeof self !== 'undefined' &&\n        // AMP / No-JS mode does not inject these helpers:\n        '$RefreshHelpers$' in self) {\n        var currentExports = module.__proto__.exports;\n        var prevExports = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevExports) !== null && _b !== void 0 ? _b : null;\n        // This cannot happen in MainTemplate because the exports mismatch between\n        // templating and execution.\n        self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.i);\n        // A module can be accepted automatically based on its exports, e.g. when\n        // it is a Refresh Boundary.\n        if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n            // Save the previous exports on update so we can compare the boundary\n            // signatures.\n            module.hot.dispose(function (data) {\n                data.prevExports = currentExports;\n            });\n            // Unconditionally accept an update to this module, we'll check if it's\n            // still a Refresh Boundary later.\n            module.hot.accept();\n            // This field is set when the previous version of this module was a\n            // Refresh Boundary, letting us know we need to check for invalidation or\n            // enqueue an update.\n            if (prevExports !== null) {\n                // A boundary can become ineligible if its exports are incompatible\n                // with the previous exports.\n                //\n                // For example, if you add/remove/change exports, we'll want to\n                // re-execute the importing modules, and force those components to\n                // re-render. Similarly, if you convert a class component to a\n                // function, we want to invalidate the boundary.\n                if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevExports, currentExports)) {\n                    module.hot.invalidate();\n                }\n                else {\n                    self.$RefreshHelpers$.scheduleUpdate();\n                }\n            }\n        }\n        else {\n            // Since we just executed the code for the module, it's possible that the\n            // new exports made it ineligible for being a boundary.\n            // We only care about the case when we were _previously_ a boundary,\n            // because we already accepted this update (accidental side effect).\n            var isNoLongerABoundary = prevExports !== null;\n            if (isNoLongerABoundary) {\n                module.hot.invalidate();\n            }\n        }\n    }\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../node_modules/webpack/buildin/harmony-module.js */ \"./node_modules/webpack/buildin/harmony-module.js\")(module)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vY29tcG9uZW50cy9TZWFyY2guanM/NjYxZSJdLCJuYW1lcyI6WyJTZWFyY2giLCJnZXRNZW51UHJvcHMiLCJ1c2VDb21ib2JveCIsImdldElucHV0UHJvcHMiLCJnZXRDb21ib2JveFByb3BzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFFZSxTQUFTQSxNQUFULEdBQWtCO0FBQUEsTUFDdkJDLFlBRHVCLEdBQzJCQyxxREFEM0IsQ0FDdkJELFlBRHVCO0FBQUEsTUFDVEUsYUFEUyxHQUMyQkQscURBRDNCLENBQ1RDLGFBRFM7QUFBQSxNQUNNQyxnQkFETixHQUMyQkYscURBRDNCLENBQ01FLGdCQUROO0FBRS9CLHNCQUNFLHFFQUFDLDZEQUFEO0FBQUEsNEJBQ0U7QUFBQSw2QkFDRTtBQUFPLFlBQUksRUFBQztBQUFaO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFERjtBQUFBO0FBQUE7QUFBQTtBQUFBLFlBREYsZUFJRSxxRUFBQyx5REFBRDtBQUFBLDhCQUNFLHFFQUFDLDZEQUFEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBREYsZUFFRSxxRUFBQyw2REFBRDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxjQUZGLGVBR0UscUVBQUMsNkRBQUQ7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsY0FIRixlQUlFLHFFQUFDLDZEQUFEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBSkY7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFlBSkY7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFVBREY7QUFhRDtLQWZ1QkosTSIsImZpbGUiOiIuL2NvbXBvbmVudHMvU2VhcmNoLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlQ29tYm9ib3ggfSBmcm9tIFwiZG93bnNoaWZ0XCI7XG5pbXBvcnQgeyBEcm9wRG93biwgRHJvcERvd25JdGVtLCBTZWFyY2hTdHlsZXMgfSBmcm9tIFwiLi9zdHlsZXMvRHJvcERvd25cIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gU2VhcmNoKCkge1xuICBjb25zdCB7IGdldE1lbnVQcm9wcywgZ2V0SW5wdXRQcm9wcywgZ2V0Q29tYm9ib3hQcm9wcyB9ID0gdXNlQ29tYm9ib3hcbiAgcmV0dXJuIChcbiAgICA8U2VhcmNoU3R5bGVzPlxuICAgICAgPGRpdj5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJzZWFyY2hcIiAvPlxuICAgICAgPC9kaXY+XG4gICAgICA8RHJvcERvd24+XG4gICAgICAgIDxEcm9wRG93bkl0ZW0+SGV5PC9Ecm9wRG93bkl0ZW0+XG4gICAgICAgIDxEcm9wRG93bkl0ZW0+SGV5PC9Ecm9wRG93bkl0ZW0+IFxuICAgICAgICA8RHJvcERvd25JdGVtPkhleTwvRHJvcERvd25JdGVtPlxuICAgICAgICA8RHJvcERvd25JdGVtPkhleTwvRHJvcERvd25JdGVtPlxuICAgICAgPC9Ecm9wRG93bj5cbiAgICA8L1NlYXJjaFN0eWxlcz5cbiAgKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./components/Search.js\n");

/***/ }),

/***/ "./node_modules/compute-scroll-into-view/dist/index.module.js":
/*!********************************************************************!*\
  !*** ./node_modules/compute-scroll-into-view/dist/index.module.js ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nfunction t(t){return null!=t&&\"object\"==typeof t&&1===t.nodeType}function e(t,e){return(!e||\"hidden\"!==t)&&\"visible\"!==t&&\"clip\"!==t}function n(t,n){if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){var r=getComputedStyle(t,null);return e(r.overflowY,n)||e(r.overflowX,n)||function(t){var e=function(t){if(!t.ownerDocument||!t.ownerDocument.defaultView)return null;try{return t.ownerDocument.defaultView.frameElement}catch(t){return null}}(t);return!!e&&(e.clientHeight<t.scrollHeight||e.clientWidth<t.scrollWidth)}(t)}return!1}function r(t,e,n,r,i,o,l,d){return o<t&&l>e||o>t&&l<e?0:o<=t&&d<=n||l>=e&&d>=n?o-t-r:l>e&&d<n||o<t&&d>n?l-e+i:0}/* harmony default export */ __webpack_exports__[\"default\"] = (function(e,i){var o=window,l=i.scrollMode,d=i.block,u=i.inline,h=i.boundary,a=i.skipOverflowHiddenElements,c=\"function\"==typeof h?h:function(t){return t!==h};if(!t(e))throw new TypeError(\"Invalid target\");for(var f=document.scrollingElement||document.documentElement,s=[],p=e;t(p)&&c(p);){if((p=p.parentNode)===f){s.push(p);break}p===document.body&&n(p)&&!n(document.documentElement)||n(p,a)&&s.push(p)}for(var g=o.visualViewport?o.visualViewport.width:innerWidth,m=o.visualViewport?o.visualViewport.height:innerHeight,w=window.scrollX||pageXOffset,v=window.scrollY||pageYOffset,W=e.getBoundingClientRect(),b=W.height,H=W.width,y=W.top,M=W.right,E=W.bottom,V=W.left,x=\"start\"===d||\"nearest\"===d?y:\"end\"===d?E:y+b/2,I=\"center\"===u?V+H/2:\"end\"===u?M:V,C=[],T=0;T<s.length;T++){var k=s[T],B=k.getBoundingClientRect(),D=B.height,O=B.width,R=B.top,X=B.right,Y=B.bottom,L=B.left;if(\"if-needed\"===l&&y>=0&&V>=0&&E<=m&&M<=g&&y>=R&&E<=Y&&V>=L&&M<=X)return C;var S=getComputedStyle(k),j=parseInt(S.borderLeftWidth,10),N=parseInt(S.borderTopWidth,10),q=parseInt(S.borderRightWidth,10),z=parseInt(S.borderBottomWidth,10),A=0,F=0,G=\"offsetWidth\"in k?k.offsetWidth-k.clientWidth-j-q:0,J=\"offsetHeight\"in k?k.offsetHeight-k.clientHeight-N-z:0;if(f===k)A=\"start\"===d?x:\"end\"===d?x-m:\"nearest\"===d?r(v,v+m,m,N,z,v+x,v+x+b,b):x-m/2,F=\"start\"===u?I:\"center\"===u?I-g/2:\"end\"===u?I-g:r(w,w+g,g,j,q,w+I,w+I+H,H),A=Math.max(0,A+v),F=Math.max(0,F+w);else{A=\"start\"===d?x-R-N:\"end\"===d?x-Y+z+J:\"nearest\"===d?r(R,Y,D,N,z+J,x,x+b,b):x-(R+D/2)+J/2,F=\"start\"===u?I-L-j:\"center\"===u?I-(L+O/2)+G/2:\"end\"===u?I-X+q+G:r(L,X,O,j,q+G,I,I+H,H);var K=k.scrollLeft,P=k.scrollTop;x+=P-(A=Math.max(0,Math.min(P+A,k.scrollHeight-D+J))),I+=K-(F=Math.max(0,Math.min(K+F,k.scrollWidth-O+G)))}C.push({el:k,top:A,left:F})}return C});\n//# sourceMappingURL=index.module.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL2NvbXB1dGUtc2Nyb2xsLWludG8tdmlldy9kaXN0L2luZGV4Lm1vZHVsZS5qcz8wNmI2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsY0FBYyxtREFBbUQsZ0JBQWdCLG9EQUFvRCxnQkFBZ0IsK0RBQStELCtCQUErQix1REFBdUQsa0JBQWtCLDhEQUE4RCxJQUFJLGdEQUFnRCxTQUFTLGFBQWEsSUFBSSx3RUFBd0UsSUFBSSxTQUFTLDRCQUE0QixvRkFBbUcsNkVBQWMsa0lBQWtJLGNBQWMsK0NBQStDLHVFQUF1RSxXQUFXLEVBQUUseUJBQXlCLFVBQVUsTUFBTSx5RUFBeUUsb1dBQW9XLFdBQVcsS0FBSyxrR0FBa0csNEVBQTRFLHVSQUF1UixzTUFBc00sS0FBSyxpTEFBaUwsaUNBQWlDLDJHQUEyRyxRQUFRLGtCQUFrQixFQUFFLFNBQVM7QUFDcjVFIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2NvbXB1dGUtc2Nyb2xsLWludG8tdmlldy9kaXN0L2luZGV4Lm1vZHVsZS5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHQodCl7cmV0dXJuIG51bGwhPXQmJlwib2JqZWN0XCI9PXR5cGVvZiB0JiYxPT09dC5ub2RlVHlwZX1mdW5jdGlvbiBlKHQsZSl7cmV0dXJuKCFlfHxcImhpZGRlblwiIT09dCkmJlwidmlzaWJsZVwiIT09dCYmXCJjbGlwXCIhPT10fWZ1bmN0aW9uIG4odCxuKXtpZih0LmNsaWVudEhlaWdodDx0LnNjcm9sbEhlaWdodHx8dC5jbGllbnRXaWR0aDx0LnNjcm9sbFdpZHRoKXt2YXIgcj1nZXRDb21wdXRlZFN0eWxlKHQsbnVsbCk7cmV0dXJuIGUoci5vdmVyZmxvd1ksbil8fGUoci5vdmVyZmxvd1gsbil8fGZ1bmN0aW9uKHQpe3ZhciBlPWZ1bmN0aW9uKHQpe2lmKCF0Lm93bmVyRG9jdW1lbnR8fCF0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpcmV0dXJuIG51bGw7dHJ5e3JldHVybiB0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZnJhbWVFbGVtZW50fWNhdGNoKHQpe3JldHVybiBudWxsfX0odCk7cmV0dXJuISFlJiYoZS5jbGllbnRIZWlnaHQ8dC5zY3JvbGxIZWlnaHR8fGUuY2xpZW50V2lkdGg8dC5zY3JvbGxXaWR0aCl9KHQpfXJldHVybiExfWZ1bmN0aW9uIHIodCxlLG4scixpLG8sbCxkKXtyZXR1cm4gbzx0JiZsPmV8fG8+dCYmbDxlPzA6bzw9dCYmZDw9bnx8bD49ZSYmZD49bj9vLXQtcjpsPmUmJmQ8bnx8bzx0JiZkPm4/bC1lK2k6MH1leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihlLGkpe3ZhciBvPXdpbmRvdyxsPWkuc2Nyb2xsTW9kZSxkPWkuYmxvY2ssdT1pLmlubGluZSxoPWkuYm91bmRhcnksYT1pLnNraXBPdmVyZmxvd0hpZGRlbkVsZW1lbnRzLGM9XCJmdW5jdGlvblwiPT10eXBlb2YgaD9oOmZ1bmN0aW9uKHQpe3JldHVybiB0IT09aH07aWYoIXQoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgdGFyZ2V0XCIpO2Zvcih2YXIgZj1kb2N1bWVudC5zY3JvbGxpbmdFbGVtZW50fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQscz1bXSxwPWU7dChwKSYmYyhwKTspe2lmKChwPXAucGFyZW50Tm9kZSk9PT1mKXtzLnB1c2gocCk7YnJlYWt9cD09PWRvY3VtZW50LmJvZHkmJm4ocCkmJiFuKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCl8fG4ocCxhKSYmcy5wdXNoKHApfWZvcih2YXIgZz1vLnZpc3VhbFZpZXdwb3J0P28udmlzdWFsVmlld3BvcnQud2lkdGg6aW5uZXJXaWR0aCxtPW8udmlzdWFsVmlld3BvcnQ/by52aXN1YWxWaWV3cG9ydC5oZWlnaHQ6aW5uZXJIZWlnaHQsdz13aW5kb3cuc2Nyb2xsWHx8cGFnZVhPZmZzZXQsdj13aW5kb3cuc2Nyb2xsWXx8cGFnZVlPZmZzZXQsVz1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGI9Vy5oZWlnaHQsSD1XLndpZHRoLHk9Vy50b3AsTT1XLnJpZ2h0LEU9Vy5ib3R0b20sVj1XLmxlZnQseD1cInN0YXJ0XCI9PT1kfHxcIm5lYXJlc3RcIj09PWQ/eTpcImVuZFwiPT09ZD9FOnkrYi8yLEk9XCJjZW50ZXJcIj09PXU/VitILzI6XCJlbmRcIj09PXU/TTpWLEM9W10sVD0wO1Q8cy5sZW5ndGg7VCsrKXt2YXIgaz1zW1RdLEI9ay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxEPUIuaGVpZ2h0LE89Qi53aWR0aCxSPUIudG9wLFg9Qi5yaWdodCxZPUIuYm90dG9tLEw9Qi5sZWZ0O2lmKFwiaWYtbmVlZGVkXCI9PT1sJiZ5Pj0wJiZWPj0wJiZFPD1tJiZNPD1nJiZ5Pj1SJiZFPD1ZJiZWPj1MJiZNPD1YKXJldHVybiBDO3ZhciBTPWdldENvbXB1dGVkU3R5bGUoayksaj1wYXJzZUludChTLmJvcmRlckxlZnRXaWR0aCwxMCksTj1wYXJzZUludChTLmJvcmRlclRvcFdpZHRoLDEwKSxxPXBhcnNlSW50KFMuYm9yZGVyUmlnaHRXaWR0aCwxMCksej1wYXJzZUludChTLmJvcmRlckJvdHRvbVdpZHRoLDEwKSxBPTAsRj0wLEc9XCJvZmZzZXRXaWR0aFwiaW4gaz9rLm9mZnNldFdpZHRoLWsuY2xpZW50V2lkdGgtai1xOjAsSj1cIm9mZnNldEhlaWdodFwiaW4gaz9rLm9mZnNldEhlaWdodC1rLmNsaWVudEhlaWdodC1OLXo6MDtpZihmPT09aylBPVwic3RhcnRcIj09PWQ/eDpcImVuZFwiPT09ZD94LW06XCJuZWFyZXN0XCI9PT1kP3Iodix2K20sbSxOLHosdit4LHYreCtiLGIpOngtbS8yLEY9XCJzdGFydFwiPT09dT9JOlwiY2VudGVyXCI9PT11P0ktZy8yOlwiZW5kXCI9PT11P0ktZzpyKHcsdytnLGcsaixxLHcrSSx3K0krSCxIKSxBPU1hdGgubWF4KDAsQSt2KSxGPU1hdGgubWF4KDAsRit3KTtlbHNle0E9XCJzdGFydFwiPT09ZD94LVItTjpcImVuZFwiPT09ZD94LVkreitKOlwibmVhcmVzdFwiPT09ZD9yKFIsWSxELE4seitKLHgseCtiLGIpOngtKFIrRC8yKStKLzIsRj1cInN0YXJ0XCI9PT11P0ktTC1qOlwiY2VudGVyXCI9PT11P0ktKEwrTy8yKStHLzI6XCJlbmRcIj09PXU/SS1YK3ErRzpyKEwsWCxPLGoscStHLEksSStILEgpO3ZhciBLPWsuc2Nyb2xsTGVmdCxQPWsuc2Nyb2xsVG9wO3grPVAtKEE9TWF0aC5tYXgoMCxNYXRoLm1pbihQK0Esay5zY3JvbGxIZWlnaHQtRCtKKSkpLEkrPUstKEY9TWF0aC5tYXgoMCxNYXRoLm1pbihLK0Ysay5zY3JvbGxXaWR0aC1PK0cpKSl9Qy5wdXNoKHtlbDprLHRvcDpBLGxlZnQ6Rn0pfXJldHVybiBDfVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubW9kdWxlLmpzLm1hcFxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/compute-scroll-into-view/dist/index.module.js\n");

/***/ }),

/***/ "./node_modules/downshift/dist/downshift.esm.js":
/*!******************************************************!*\
  !*** ./node_modules/downshift/dist/downshift.esm.js ***!
  \******************************************************/
/*! exports provided: default, resetIdCounter, useCombobox, useMultipleSelection, useSelect */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"resetIdCounter\", function() { return resetIdCounter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useCombobox\", function() { return useCombobox; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useMultipleSelection\", function() { return useMultipleSelection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useSelect\", function() { return useSelect; });\n/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutPropertiesLoose */ \"./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ \"./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/assertThisInitialized */ \"./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inheritsLoose */ \"./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! prop-types */ \"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var react_is__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-is */ \"./node_modules/react-is/index.js\");\n/* harmony import */ var react_is__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react_is__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var compute_scroll_into_view__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! compute-scroll-into-view */ \"./node_modules/compute-scroll-into-view/dist/index.module.js\");\n\n\n\n\n\n\n\n\n\nvar idCounter = 0;\n/**\n * Accepts a parameter and returns it if it's a function\n * or a noop function if it's not. This allows us to\n * accept a callback, but not worry about it if it's not\n * passed.\n * @param {Function} cb the callback\n * @return {Function} a function\n */\n\nfunction cbToCb(cb) {\n  return typeof cb === 'function' ? cb : noop;\n}\n\nfunction noop() {}\n/**\n * Scroll node into view if necessary\n * @param {HTMLElement} node the element that should scroll into view\n * @param {HTMLElement} menuNode the menu element of the component\n */\n\n\nfunction scrollIntoView(node, menuNode) {\n  if (!node) {\n    return;\n  }\n\n  var actions = Object(compute_scroll_into_view__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(node, {\n    boundary: menuNode,\n    block: 'nearest',\n    scrollMode: 'if-needed'\n  });\n  actions.forEach(function (_ref) {\n    var el = _ref.el,\n        top = _ref.top,\n        left = _ref.left;\n    el.scrollTop = top;\n    el.scrollLeft = left;\n  });\n}\n/**\n * @param {HTMLElement} parent the parent node\n * @param {HTMLElement} child the child node\n * @return {Boolean} whether the parent is the child or the child is in the parent\n */\n\n\nfunction isOrContainsNode(parent, child) {\n  return parent === child || parent.contains && parent.contains(child);\n}\n/**\n * Simple debounce implementation. Will call the given\n * function once after the time given has passed since\n * it was last called.\n * @param {Function} fn the function to call after the time\n * @param {Number} time the time to wait\n * @return {Function} the debounced function\n */\n\n\nfunction debounce(fn, time) {\n  var timeoutId;\n\n  function cancel() {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n  }\n\n  function wrapper() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    cancel();\n    timeoutId = setTimeout(function () {\n      timeoutId = null;\n      fn.apply(void 0, args);\n    }, time);\n  }\n\n  wrapper.cancel = cancel;\n  return wrapper;\n}\n/**\n * This is intended to be used to compose event handlers.\n * They are executed in order until one of them sets\n * `event.preventDownshiftDefault = true`.\n * @param {...Function} fns the event handler functions\n * @return {Function} the event handler to add to an element\n */\n\n\nfunction callAllEventHandlers() {\n  for (var _len2 = arguments.length, fns = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    fns[_key2] = arguments[_key2];\n  }\n\n  return function (event) {\n    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n      args[_key3 - 1] = arguments[_key3];\n    }\n\n    return fns.some(function (fn) {\n      if (fn) {\n        fn.apply(void 0, [event].concat(args));\n      }\n\n      return event.preventDownshiftDefault || event.hasOwnProperty('nativeEvent') && event.nativeEvent.preventDownshiftDefault;\n    });\n  };\n}\n\nfunction handleRefs() {\n  for (var _len4 = arguments.length, refs = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n    refs[_key4] = arguments[_key4];\n  }\n\n  return function (node) {\n    refs.forEach(function (ref) {\n      if (typeof ref === 'function') {\n        ref(node);\n      } else if (ref) {\n        ref.current = node;\n      }\n    });\n  };\n}\n/**\n * This generates a unique ID for an instance of Downshift\n * @return {String} the unique ID\n */\n\n\nfunction generateId() {\n  return String(idCounter++);\n}\n/**\n * Resets idCounter to 0. Used for SSR.\n */\n\n\nfunction resetIdCounter() {\n  idCounter = 0;\n}\n/**\n * Default implementation for status message. Only added when menu is open.\n * Will specift if there are results in the list, and if so, how many,\n * and what keys are relevant.\n *\n * @param {Object} param the downshift state and other relevant properties\n * @return {String} the a11y status message\n */\n\n\nfunction getA11yStatusMessage(_ref2) {\n  var isOpen = _ref2.isOpen,\n      resultCount = _ref2.resultCount,\n      previousResultCount = _ref2.previousResultCount;\n\n  if (!isOpen) {\n    return '';\n  }\n\n  if (!resultCount) {\n    return 'No results are available.';\n  }\n\n  if (resultCount !== previousResultCount) {\n    return resultCount + \" result\" + (resultCount === 1 ? ' is' : 's are') + \" available, use up and down arrow keys to navigate. Press Enter key to select.\";\n  }\n\n  return '';\n}\n/**\n * Takes an argument and if it's an array, returns the first item in the array\n * otherwise returns the argument\n * @param {*} arg the maybe-array\n * @param {*} defaultValue the value if arg is falsey not defined\n * @return {*} the arg or it's first item\n */\n\n\nfunction unwrapArray(arg, defaultValue) {\n  arg = Array.isArray(arg) ?\n  /* istanbul ignore next (preact) */\n  arg[0] : arg;\n\n  if (!arg && defaultValue) {\n    return defaultValue;\n  } else {\n    return arg;\n  }\n}\n/**\n * @param {Object} element (P)react element\n * @return {Boolean} whether it's a DOM element\n */\n\n\nfunction isDOMElement(element) {\n  // then we assume this is react\n  return typeof element.type === 'string';\n}\n/**\n * @param {Object} element (P)react element\n * @return {Object} the props\n */\n\n\nfunction getElementProps(element) {\n  return element.props;\n}\n/**\n * Throws a helpful error message for required properties. Useful\n * to be used as a default in destructuring or object params.\n * @param {String} fnName the function name\n * @param {String} propName the prop name\n */\n\n\nfunction requiredProp(fnName, propName) {\n  // eslint-disable-next-line no-console\n  console.error(\"The property \\\"\" + propName + \"\\\" is required in \\\"\" + fnName + \"\\\"\");\n}\n\nvar stateKeys = ['highlightedIndex', 'inputValue', 'isOpen', 'selectedItem', 'type'];\n/**\n * @param {Object} state the state object\n * @return {Object} state that is relevant to downshift\n */\n\nfunction pickState(state) {\n  if (state === void 0) {\n    state = {};\n  }\n\n  var result = {};\n  stateKeys.forEach(function (k) {\n    if (state.hasOwnProperty(k)) {\n      result[k] = state[k];\n    }\n  });\n  return result;\n}\n/**\n * This will perform a shallow merge of the given state object\n * with the state coming from props\n * (for the controlled component scenario)\n * This is used in state updater functions so they're referencing\n * the right state regardless of where it comes from.\n *\n * @param {Object} state The state of the component/hook.\n * @param {Object} props The props that may contain controlled values.\n * @returns {Object} The merged controlled state.\n */\n\n\nfunction getState(state, props) {\n  return Object.keys(state).reduce(function (prevState, key) {\n    prevState[key] = isControlledProp(props, key) ? props[key] : state[key];\n    return prevState;\n  }, {});\n}\n/**\n * This determines whether a prop is a \"controlled prop\" meaning it is\n * state which is controlled by the outside of this component rather\n * than within this component.\n *\n * @param {Object} props The props that may contain controlled values.\n * @param {String} key the key to check\n * @return {Boolean} whether it is a controlled controlled prop\n */\n\n\nfunction isControlledProp(props, key) {\n  return props[key] !== undefined;\n}\n/**\n * Normalizes the 'key' property of a KeyboardEvent in IE/Edge\n * @param {Object} event a keyboardEvent object\n * @return {String} keyboard key\n */\n\n\nfunction normalizeArrowKey(event) {\n  var key = event.key,\n      keyCode = event.keyCode;\n  /* istanbul ignore next (ie) */\n\n  if (keyCode >= 37 && keyCode <= 40 && key.indexOf('Arrow') !== 0) {\n    return \"Arrow\" + key;\n  }\n\n  return key;\n}\n/**\n * Simple check if the value passed is object literal\n * @param {*} obj any things\n * @return {Boolean} whether it's object literal\n */\n\n\nfunction isPlainObject(obj) {\n  return Object.prototype.toString.call(obj) === '[object Object]';\n}\n/**\n * Returns the new index in the list, in a circular way. If next value is out of bonds from the total,\n * it will wrap to either 0 or itemCount - 1.\n *\n * @param {number} moveAmount Number of positions to move. Negative to move backwards, positive forwards.\n * @param {number} baseIndex The initial position to move from.\n * @param {number} itemCount The total number of items.\n * @param {Function} getItemNodeFromIndex Used to check if item is disabled.\n * @param {boolean} circular Specify if navigation is circular. Default is true.\n * @returns {number} The new index after the move.\n */\n\n\nfunction getNextWrappingIndex(moveAmount, baseIndex, itemCount, getItemNodeFromIndex, circular) {\n  if (circular === void 0) {\n    circular = true;\n  }\n\n  if (itemCount === 0) {\n    return -1;\n  }\n\n  var itemsLastIndex = itemCount - 1;\n\n  if (typeof baseIndex !== 'number' || baseIndex < 0 || baseIndex >= itemCount) {\n    baseIndex = moveAmount > 0 ? -1 : itemsLastIndex + 1;\n  }\n\n  var newIndex = baseIndex + moveAmount;\n\n  if (newIndex < 0) {\n    newIndex = circular ? itemsLastIndex : 0;\n  } else if (newIndex > itemsLastIndex) {\n    newIndex = circular ? 0 : itemsLastIndex;\n  }\n\n  var nonDisabledNewIndex = getNextNonDisabledIndex(moveAmount, newIndex, itemCount, getItemNodeFromIndex, circular);\n\n  if (nonDisabledNewIndex === -1) {\n    return baseIndex >= itemCount ? -1 : baseIndex;\n  }\n\n  return nonDisabledNewIndex;\n}\n/**\n * Returns the next index in the list of an item that is not disabled.\n *\n * @param {number} moveAmount Number of positions to move. Negative to move backwards, positive forwards.\n * @param {number} baseIndex The initial position to move from.\n * @param {number} itemCount The total number of items.\n * @param {Function} getItemNodeFromIndex Used to check if item is disabled.\n * @param {boolean} circular Specify if navigation is circular. Default is true.\n * @returns {number} The new index. Returns baseIndex if item is not disabled. Returns next non-disabled item otherwise. If no non-disabled found it will return -1.\n */\n\n\nfunction getNextNonDisabledIndex(moveAmount, baseIndex, itemCount, getItemNodeFromIndex, circular) {\n  var currentElementNode = getItemNodeFromIndex(baseIndex);\n\n  if (!currentElementNode || !currentElementNode.hasAttribute('disabled')) {\n    return baseIndex;\n  }\n\n  if (moveAmount > 0) {\n    for (var index = baseIndex + 1; index < itemCount; index++) {\n      if (!getItemNodeFromIndex(index).hasAttribute('disabled')) {\n        return index;\n      }\n    }\n  } else {\n    for (var _index = baseIndex - 1; _index >= 0; _index--) {\n      if (!getItemNodeFromIndex(_index).hasAttribute('disabled')) {\n        return _index;\n      }\n    }\n  }\n\n  if (circular) {\n    return moveAmount > 0 ? getNextNonDisabledIndex(1, 0, itemCount, getItemNodeFromIndex, false) : getNextNonDisabledIndex(-1, itemCount - 1, itemCount, getItemNodeFromIndex, false);\n  }\n\n  return -1;\n}\n/**\n * Checks if event target is within the downshift elements.\n *\n * @param {EventTarget} target Target to check.\n * @param {HTMLElement[]} downshiftElements The elements that form downshift (list, toggle button etc).\n * @param {Document} document The document.\n * @param {boolean} checkActiveElement Whether to also check activeElement.\n *\n * @returns {boolean} Whether or not the target is within downshift elements.\n */\n\n\nfunction targetWithinDownshift(target, downshiftElements, document, checkActiveElement) {\n  if (checkActiveElement === void 0) {\n    checkActiveElement = true;\n  }\n\n  return downshiftElements.some(function (contextNode) {\n    return contextNode && (isOrContainsNode(contextNode, target) || checkActiveElement && isOrContainsNode(contextNode, document.activeElement));\n  });\n}\n\nfunction validateControlledUnchanged(state, prevProps, nextProps) {\n  if (false) {}\n\n  var warningDescription = \"This prop should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled Downshift element for the lifetime of the component. More info: https://github.com/downshift-js/downshift#control-props\";\n  Object.keys(state).forEach(function (propKey) {\n    if (prevProps[propKey] !== undefined && nextProps[propKey] === undefined) {\n      // eslint-disable-next-line no-console\n      console.error(\"downshift: A component has changed the controlled prop \\\"\" + propKey + \"\\\" to be uncontrolled. \" + warningDescription);\n    } else if (prevProps[propKey] === undefined && nextProps[propKey] !== undefined) {\n      // eslint-disable-next-line no-console\n      console.error(\"downshift: A component has changed the uncontrolled prop \\\"\" + propKey + \"\\\" to be controlled. \" + warningDescription);\n    }\n  });\n}\n\nvar cleanupStatus = debounce(function () {\n  getStatusDiv().textContent = '';\n}, 500);\n/**\n * @param {String} status the status message\n * @param {Object} documentProp document passed by the user.\n */\n\nfunction setStatus(status, documentProp) {\n  var div = getStatusDiv(documentProp);\n\n  if (!status) {\n    return;\n  }\n\n  div.textContent = status;\n  cleanupStatus();\n}\n/**\n * Get the status node or create it if it does not already exist.\n * @param {Object} documentProp document passed by the user.\n * @return {HTMLElement} the status node.\n */\n\n\nfunction getStatusDiv(documentProp) {\n  if (documentProp === void 0) {\n    documentProp = document;\n  }\n\n  var statusDiv = documentProp.getElementById('a11y-status-message');\n\n  if (statusDiv) {\n    return statusDiv;\n  }\n\n  statusDiv = documentProp.createElement('div');\n  statusDiv.setAttribute('id', 'a11y-status-message');\n  statusDiv.setAttribute('role', 'status');\n  statusDiv.setAttribute('aria-live', 'polite');\n  statusDiv.setAttribute('aria-relevant', 'additions text');\n  Object.assign(statusDiv.style, {\n    border: '0',\n    clip: 'rect(0 0 0 0)',\n    height: '1px',\n    margin: '-1px',\n    overflow: 'hidden',\n    padding: '0',\n    position: 'absolute',\n    width: '1px'\n  });\n  documentProp.body.appendChild(statusDiv);\n  return statusDiv;\n}\n\nvar unknown =  true ? '__autocomplete_unknown__' : undefined;\nvar mouseUp =  true ? '__autocomplete_mouseup__' : undefined;\nvar itemMouseEnter =  true ? '__autocomplete_item_mouseenter__' : undefined;\nvar keyDownArrowUp =  true ? '__autocomplete_keydown_arrow_up__' : undefined;\nvar keyDownArrowDown =  true ? '__autocomplete_keydown_arrow_down__' : undefined;\nvar keyDownEscape =  true ? '__autocomplete_keydown_escape__' : undefined;\nvar keyDownEnter =  true ? '__autocomplete_keydown_enter__' : undefined;\nvar keyDownHome =  true ? '__autocomplete_keydown_home__' : undefined;\nvar keyDownEnd =  true ? '__autocomplete_keydown_end__' : undefined;\nvar clickItem =  true ? '__autocomplete_click_item__' : undefined;\nvar blurInput =  true ? '__autocomplete_blur_input__' : undefined;\nvar changeInput =  true ? '__autocomplete_change_input__' : undefined;\nvar keyDownSpaceButton =  true ? '__autocomplete_keydown_space_button__' : undefined;\nvar clickButton =  true ? '__autocomplete_click_button__' : undefined;\nvar blurButton =  true ? '__autocomplete_blur_button__' : undefined;\nvar controlledPropUpdatedSelectedItem =  true ? '__autocomplete_controlled_prop_updated_selected_item__' : undefined;\nvar touchEnd =  true ? '__autocomplete_touchend__' : undefined;\n\nvar stateChangeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  unknown: unknown,\n  mouseUp: mouseUp,\n  itemMouseEnter: itemMouseEnter,\n  keyDownArrowUp: keyDownArrowUp,\n  keyDownArrowDown: keyDownArrowDown,\n  keyDownEscape: keyDownEscape,\n  keyDownEnter: keyDownEnter,\n  keyDownHome: keyDownHome,\n  keyDownEnd: keyDownEnd,\n  clickItem: clickItem,\n  blurInput: blurInput,\n  changeInput: changeInput,\n  keyDownSpaceButton: keyDownSpaceButton,\n  clickButton: clickButton,\n  blurButton: blurButton,\n  controlledPropUpdatedSelectedItem: controlledPropUpdatedSelectedItem,\n  touchEnd: touchEnd\n});\n\nvar Downshift =\n/*#__PURE__*/\nfunction () {\n  var Downshift =\n  /*#__PURE__*/\n  function (_Component) {\n    Object(_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(Downshift, _Component);\n\n    function Downshift(_props) {\n      var _this = _Component.call(this, _props) || this;\n\n      _this.id = _this.props.id || \"downshift-\" + generateId();\n      _this.menuId = _this.props.menuId || _this.id + \"-menu\";\n      _this.labelId = _this.props.labelId || _this.id + \"-label\";\n      _this.inputId = _this.props.inputId || _this.id + \"-input\";\n\n      _this.getItemId = _this.props.getItemId || function (index) {\n        return _this.id + \"-item-\" + index;\n      };\n\n      _this.input = null;\n      _this.items = [];\n      _this.itemCount = null;\n      _this.previousResultCount = 0;\n      _this.timeoutIds = [];\n\n      _this.internalSetTimeout = function (fn, time) {\n        var id = setTimeout(function () {\n          _this.timeoutIds = _this.timeoutIds.filter(function (i) {\n            return i !== id;\n          });\n          fn();\n        }, time);\n\n        _this.timeoutIds.push(id);\n      };\n\n      _this.setItemCount = function (count) {\n        _this.itemCount = count;\n      };\n\n      _this.unsetItemCount = function () {\n        _this.itemCount = null;\n      };\n\n      _this.setHighlightedIndex = function (highlightedIndex, otherStateToSet) {\n        if (highlightedIndex === void 0) {\n          highlightedIndex = _this.props.defaultHighlightedIndex;\n        }\n\n        if (otherStateToSet === void 0) {\n          otherStateToSet = {};\n        }\n\n        otherStateToSet = pickState(otherStateToSet);\n\n        _this.internalSetState(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          highlightedIndex: highlightedIndex\n        }, otherStateToSet));\n      };\n\n      _this.clearSelection = function (cb) {\n        _this.internalSetState({\n          selectedItem: null,\n          inputValue: '',\n          highlightedIndex: _this.props.defaultHighlightedIndex,\n          isOpen: _this.props.defaultIsOpen\n        }, cb);\n      };\n\n      _this.selectItem = function (item, otherStateToSet, cb) {\n        otherStateToSet = pickState(otherStateToSet);\n\n        _this.internalSetState(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          isOpen: _this.props.defaultIsOpen,\n          highlightedIndex: _this.props.defaultHighlightedIndex,\n          selectedItem: item,\n          inputValue: _this.props.itemToString(item)\n        }, otherStateToSet), cb);\n      };\n\n      _this.selectItemAtIndex = function (itemIndex, otherStateToSet, cb) {\n        var item = _this.items[itemIndex];\n\n        if (item == null) {\n          return;\n        }\n\n        _this.selectItem(item, otherStateToSet, cb);\n      };\n\n      _this.selectHighlightedItem = function (otherStateToSet, cb) {\n        return _this.selectItemAtIndex(_this.getState().highlightedIndex, otherStateToSet, cb);\n      };\n\n      _this.internalSetState = function (stateToSet, cb) {\n        var isItemSelected, onChangeArg;\n        var onStateChangeArg = {};\n        var isStateToSetFunction = typeof stateToSet === 'function'; // we want to call `onInputValueChange` before the `setState` call\n        // so someone controlling the `inputValue` state gets notified of\n        // the input change as soon as possible. This avoids issues with\n        // preserving the cursor position.\n        // See https://github.com/downshift-js/downshift/issues/217 for more info.\n\n        if (!isStateToSetFunction && stateToSet.hasOwnProperty('inputValue')) {\n          _this.props.onInputValueChange(stateToSet.inputValue, Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, _this.getStateAndHelpers(), stateToSet));\n        }\n\n        return _this.setState(function (state) {\n          state = _this.getState(state);\n          var newStateToSet = isStateToSetFunction ? stateToSet(state) : stateToSet; // Your own function that could modify the state that will be set.\n\n          newStateToSet = _this.props.stateReducer(state, newStateToSet); // checks if an item is selected, regardless of if it's different from\n          // what was selected before\n          // used to determine if onSelect and onChange callbacks should be called\n\n          isItemSelected = newStateToSet.hasOwnProperty('selectedItem'); // this keeps track of the object we want to call with setState\n\n          var nextState = {}; // this is just used to tell whether the state changed\n\n          var nextFullState = {}; // we need to call on change if the outside world is controlling any of our state\n          // and we're trying to update that state. OR if the selection has changed and we're\n          // trying to update the selection\n\n          if (isItemSelected && newStateToSet.selectedItem !== state.selectedItem) {\n            onChangeArg = newStateToSet.selectedItem;\n          }\n\n          newStateToSet.type = newStateToSet.type || unknown;\n          Object.keys(newStateToSet).forEach(function (key) {\n            // onStateChangeArg should only have the state that is\n            // actually changing\n            if (state[key] !== newStateToSet[key]) {\n              onStateChangeArg[key] = newStateToSet[key];\n            } // the type is useful for the onStateChangeArg\n            // but we don't actually want to set it in internal state.\n            // this is an undocumented feature for now... Not all internalSetState\n            // calls support it and I'm not certain we want them to yet.\n            // But it enables users controlling the isOpen state to know when\n            // the isOpen state changes due to mouseup events which is quite handy.\n\n\n            if (key === 'type') {\n              return;\n            }\n\n            nextFullState[key] = newStateToSet[key]; // if it's coming from props, then we don't care to set it internally\n\n            if (!isControlledProp(_this.props, key)) {\n              nextState[key] = newStateToSet[key];\n            }\n          }); // if stateToSet is a function, then we weren't able to call onInputValueChange\n          // earlier, so we'll call it now that we know what the inputValue state will be.\n\n          if (isStateToSetFunction && newStateToSet.hasOwnProperty('inputValue')) {\n            _this.props.onInputValueChange(newStateToSet.inputValue, Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, _this.getStateAndHelpers(), newStateToSet));\n          }\n\n          return nextState;\n        }, function () {\n          // call the provided callback if it's a function\n          cbToCb(cb)(); // only call the onStateChange and onChange callbacks if\n          // we have relevant information to pass them.\n\n          var hasMoreStateThanType = Object.keys(onStateChangeArg).length > 1;\n\n          if (hasMoreStateThanType) {\n            _this.props.onStateChange(onStateChangeArg, _this.getStateAndHelpers());\n          }\n\n          if (isItemSelected) {\n            _this.props.onSelect(stateToSet.selectedItem, _this.getStateAndHelpers());\n          }\n\n          if (onChangeArg !== undefined) {\n            _this.props.onChange(onChangeArg, _this.getStateAndHelpers());\n          } // this is currently undocumented and therefore subject to change\n          // We'll try to not break it, but just be warned.\n\n\n          _this.props.onUserAction(onStateChangeArg, _this.getStateAndHelpers());\n        });\n      };\n\n      _this.rootRef = function (node) {\n        return _this._rootNode = node;\n      };\n\n      _this.getRootProps = function (_temp, _temp2) {\n        var _extends2;\n\n        var _ref = _temp === void 0 ? {} : _temp,\n            _ref$refKey = _ref.refKey,\n            refKey = _ref$refKey === void 0 ? 'ref' : _ref$refKey,\n            ref = _ref.ref,\n            rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref, [\"refKey\", \"ref\"]);\n\n        var _ref2 = _temp2 === void 0 ? {} : _temp2,\n            _ref2$suppressRefErro = _ref2.suppressRefError,\n            suppressRefError = _ref2$suppressRefErro === void 0 ? false : _ref2$suppressRefErro;\n\n        // this is used in the render to know whether the user has called getRootProps.\n        // It uses that to know whether to apply the props automatically\n        _this.getRootProps.called = true;\n        _this.getRootProps.refKey = refKey;\n        _this.getRootProps.suppressRefError = suppressRefError;\n\n        var _this$getState = _this.getState(),\n            isOpen = _this$getState.isOpen;\n\n        return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends2 = {}, _extends2[refKey] = handleRefs(ref, _this.rootRef), _extends2.role = 'combobox', _extends2['aria-expanded'] = isOpen, _extends2['aria-haspopup'] = 'listbox', _extends2['aria-owns'] = isOpen ? _this.menuId : null, _extends2['aria-labelledby'] = _this.labelId, _extends2), rest);\n      };\n\n      _this.keyDownHandlers = {\n        ArrowDown: function ArrowDown(event) {\n          var _this2 = this;\n\n          event.preventDefault();\n\n          if (this.getState().isOpen) {\n            var amount = event.shiftKey ? 5 : 1;\n            this.moveHighlightedIndex(amount, {\n              type: keyDownArrowDown\n            });\n          } else {\n            this.internalSetState({\n              isOpen: true,\n              type: keyDownArrowDown\n            }, function () {\n              var itemCount = _this2.getItemCount();\n\n              if (itemCount > 0) {\n                var _this2$getState = _this2.getState(),\n                    highlightedIndex = _this2$getState.highlightedIndex;\n\n                var nextHighlightedIndex = getNextWrappingIndex(1, highlightedIndex, itemCount, function (index) {\n                  return _this2.getItemNodeFromIndex(index);\n                });\n\n                _this2.setHighlightedIndex(nextHighlightedIndex, {\n                  type: keyDownArrowDown\n                });\n              }\n            });\n          }\n        },\n        ArrowUp: function ArrowUp(event) {\n          var _this3 = this;\n\n          event.preventDefault();\n\n          if (this.getState().isOpen) {\n            var amount = event.shiftKey ? -5 : -1;\n            this.moveHighlightedIndex(amount, {\n              type: keyDownArrowUp\n            });\n          } else {\n            this.internalSetState({\n              isOpen: true,\n              type: keyDownArrowUp\n            }, function () {\n              var itemCount = _this3.getItemCount();\n\n              if (itemCount > 0) {\n                var _this3$getState = _this3.getState(),\n                    highlightedIndex = _this3$getState.highlightedIndex;\n\n                var nextHighlightedIndex = getNextWrappingIndex(-1, highlightedIndex, itemCount, function (index) {\n                  return _this3.getItemNodeFromIndex(index);\n                });\n\n                _this3.setHighlightedIndex(nextHighlightedIndex, {\n                  type: keyDownArrowUp\n                });\n              }\n            });\n          }\n        },\n        Enter: function Enter(event) {\n          if (event.which === 229) {\n            return;\n          }\n\n          var _this$getState2 = this.getState(),\n              isOpen = _this$getState2.isOpen,\n              highlightedIndex = _this$getState2.highlightedIndex;\n\n          if (isOpen && highlightedIndex != null) {\n            event.preventDefault();\n            var item = this.items[highlightedIndex];\n            var itemNode = this.getItemNodeFromIndex(highlightedIndex);\n\n            if (item == null || itemNode && itemNode.hasAttribute('disabled')) {\n              return;\n            }\n\n            this.selectHighlightedItem({\n              type: keyDownEnter\n            });\n          }\n        },\n        Escape: function Escape(event) {\n          event.preventDefault();\n          this.reset(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            type: keyDownEscape\n          }, !this.state.isOpen && {\n            selectedItem: null,\n            inputValue: ''\n          }));\n        }\n      };\n      _this.buttonKeyDownHandlers = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, _this.keyDownHandlers, {\n        ' ': function _(event) {\n          event.preventDefault();\n          this.toggleMenu({\n            type: keyDownSpaceButton\n          });\n        }\n      });\n      _this.inputKeyDownHandlers = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, _this.keyDownHandlers, {\n        Home: function Home(event) {\n          var _this4 = this;\n\n          event.preventDefault();\n          var itemCount = this.getItemCount();\n\n          var _this$getState3 = this.getState(),\n              isOpen = _this$getState3.isOpen;\n\n          if (itemCount <= 0 || !isOpen) {\n            return;\n          } // get next non-disabled starting downwards from 0 if that's disabled.\n\n\n          var newHighlightedIndex = getNextNonDisabledIndex(1, 0, itemCount, function (index) {\n            return _this4.getItemNodeFromIndex(index);\n          }, false);\n          this.setHighlightedIndex(newHighlightedIndex, {\n            type: keyDownHome\n          });\n        },\n        End: function End(event) {\n          var _this5 = this;\n\n          event.preventDefault();\n          var itemCount = this.getItemCount();\n\n          var _this$getState4 = this.getState(),\n              isOpen = _this$getState4.isOpen;\n\n          if (itemCount <= 0 || !isOpen) {\n            return;\n          } // get next non-disabled starting upwards from last index if that's disabled.\n\n\n          var newHighlightedIndex = getNextNonDisabledIndex(-1, itemCount - 1, itemCount, function (index) {\n            return _this5.getItemNodeFromIndex(index);\n          }, false);\n          this.setHighlightedIndex(newHighlightedIndex, {\n            type: keyDownEnd\n          });\n        }\n      });\n\n      _this.getToggleButtonProps = function (_temp3) {\n        var _ref3 = _temp3 === void 0 ? {} : _temp3,\n            onClick = _ref3.onClick,\n            onPress = _ref3.onPress,\n            onKeyDown = _ref3.onKeyDown,\n            onKeyUp = _ref3.onKeyUp,\n            onBlur = _ref3.onBlur,\n            rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref3, [\"onClick\", \"onPress\", \"onKeyDown\", \"onKeyUp\", \"onBlur\"]);\n\n        var _this$getState5 = _this.getState(),\n            isOpen = _this$getState5.isOpen;\n\n        var enabledEventHandlers = {\n          onClick: callAllEventHandlers(onClick, _this.buttonHandleClick),\n          onKeyDown: callAllEventHandlers(onKeyDown, _this.buttonHandleKeyDown),\n          onKeyUp: callAllEventHandlers(onKeyUp, _this.buttonHandleKeyUp),\n          onBlur: callAllEventHandlers(onBlur, _this.buttonHandleBlur)\n        };\n        var eventHandlers = rest.disabled ? {} : enabledEventHandlers;\n        return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          type: 'button',\n          role: 'button',\n          'aria-label': isOpen ? 'close menu' : 'open menu',\n          'aria-haspopup': true,\n          'data-toggle': true\n        }, eventHandlers, rest);\n      };\n\n      _this.buttonHandleKeyUp = function (event) {\n        // Prevent click event from emitting in Firefox\n        event.preventDefault();\n      };\n\n      _this.buttonHandleKeyDown = function (event) {\n        var key = normalizeArrowKey(event);\n\n        if (_this.buttonKeyDownHandlers[key]) {\n          _this.buttonKeyDownHandlers[key].call(Object(_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_this), event);\n        }\n      };\n\n      _this.buttonHandleClick = function (event) {\n        event.preventDefault(); // handle odd case for Safari and Firefox which\n        // don't give the button the focus properly.\n\n        /* istanbul ignore if (can't reasonably test this) */\n\n        if ( _this.props.environment.document.activeElement === _this.props.environment.document.body) {\n          event.target.focus();\n        } // to simplify testing components that use downshift, we'll not wrap this in a setTimeout\n        // if the NODE_ENV is test. With the proper build system, this should be dead code eliminated\n        // when building for production and should therefore have no impact on production code.\n\n\n        if (false) {} else {\n          // Ensure that toggle of menu occurs after the potential blur event in iOS\n          _this.internalSetTimeout(function () {\n            return _this.toggleMenu({\n              type: clickButton\n            });\n          });\n        }\n      };\n\n      _this.buttonHandleBlur = function (event) {\n        var blurTarget = event.target; // Save blur target for comparison with activeElement later\n        // Need setTimeout, so that when the user presses Tab, the activeElement is the next focused element, not body element\n\n        _this.internalSetTimeout(function () {\n          if (!_this.isMouseDown && (_this.props.environment.document.activeElement == null || _this.props.environment.document.activeElement.id !== _this.inputId) && _this.props.environment.document.activeElement !== blurTarget // Do nothing if we refocus the same element again (to solve issue in Safari on iOS)\n          ) {\n              _this.reset({\n                type: blurButton\n              });\n            }\n        });\n      };\n\n      _this.getLabelProps = function (props) {\n        return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          htmlFor: _this.inputId,\n          id: _this.labelId\n        }, props);\n      };\n\n      _this.getInputProps = function (_temp4) {\n        var _ref4 = _temp4 === void 0 ? {} : _temp4,\n            onKeyDown = _ref4.onKeyDown,\n            onBlur = _ref4.onBlur,\n            onChange = _ref4.onChange,\n            onInput = _ref4.onInput,\n            onChangeText = _ref4.onChangeText,\n            rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref4, [\"onKeyDown\", \"onBlur\", \"onChange\", \"onInput\", \"onChangeText\"]);\n\n        var onChangeKey;\n        var eventHandlers = {};\n        /* istanbul ignore next (preact) */\n\n        onChangeKey = 'onChange';\n\n        var _this$getState6 = _this.getState(),\n            inputValue = _this$getState6.inputValue,\n            isOpen = _this$getState6.isOpen,\n            highlightedIndex = _this$getState6.highlightedIndex;\n\n        if (!rest.disabled) {\n          var _eventHandlers;\n\n          eventHandlers = (_eventHandlers = {}, _eventHandlers[onChangeKey] = callAllEventHandlers(onChange, onInput, _this.inputHandleChange), _eventHandlers.onKeyDown = callAllEventHandlers(onKeyDown, _this.inputHandleKeyDown), _eventHandlers.onBlur = callAllEventHandlers(onBlur, _this.inputHandleBlur), _eventHandlers);\n        }\n        /* istanbul ignore if (react-native) */\n\n\n        return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          'aria-autocomplete': 'list',\n          'aria-activedescendant': isOpen && typeof highlightedIndex === 'number' && highlightedIndex >= 0 ? _this.getItemId(highlightedIndex) : null,\n          'aria-controls': isOpen ? _this.menuId : null,\n          'aria-labelledby': _this.labelId,\n          // https://developer.mozilla.org/en-US/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion\n          // revert back since autocomplete=\"nope\" is ignored on latest Chrome and Opera\n          autoComplete: 'off',\n          value: inputValue,\n          id: _this.inputId\n        }, eventHandlers, rest);\n      };\n\n      _this.inputHandleKeyDown = function (event) {\n        var key = normalizeArrowKey(event);\n\n        if (key && _this.inputKeyDownHandlers[key]) {\n          _this.inputKeyDownHandlers[key].call(Object(_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_this), event);\n        }\n      };\n\n      _this.inputHandleChange = function (event) {\n        _this.internalSetState({\n          type: changeInput,\n          isOpen: true,\n          inputValue: event.target.value,\n          highlightedIndex: _this.props.defaultHighlightedIndex\n        });\n      };\n\n      _this.inputHandleBlur = function () {\n        // Need setTimeout, so that when the user presses Tab, the activeElement is the next focused element, not the body element\n        _this.internalSetTimeout(function () {\n          var downshiftButtonIsActive = _this.props.environment.document && !!_this.props.environment.document.activeElement && !!_this.props.environment.document.activeElement.dataset && _this.props.environment.document.activeElement.dataset.toggle && _this._rootNode && _this._rootNode.contains(_this.props.environment.document.activeElement);\n\n          if (!_this.isMouseDown && !downshiftButtonIsActive) {\n            _this.reset({\n              type: blurInput\n            });\n          }\n        });\n      };\n\n      _this.menuRef = function (node) {\n        _this._menuNode = node;\n      };\n\n      _this.getMenuProps = function (_temp5, _temp6) {\n        var _extends3;\n\n        var _ref5 = _temp5 === void 0 ? {} : _temp5,\n            _ref5$refKey = _ref5.refKey,\n            refKey = _ref5$refKey === void 0 ? 'ref' : _ref5$refKey,\n            ref = _ref5.ref,\n            props = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref5, [\"refKey\", \"ref\"]);\n\n        var _ref6 = _temp6 === void 0 ? {} : _temp6,\n            _ref6$suppressRefErro = _ref6.suppressRefError,\n            suppressRefError = _ref6$suppressRefErro === void 0 ? false : _ref6$suppressRefErro;\n\n        _this.getMenuProps.called = true;\n        _this.getMenuProps.refKey = refKey;\n        _this.getMenuProps.suppressRefError = suppressRefError;\n        return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends3 = {}, _extends3[refKey] = handleRefs(ref, _this.menuRef), _extends3.role = 'listbox', _extends3['aria-labelledby'] = props && props['aria-label'] ? null : _this.labelId, _extends3.id = _this.menuId, _extends3), props);\n      };\n\n      _this.getItemProps = function (_temp7) {\n        var _enabledEventHandlers;\n\n        var _ref7 = _temp7 === void 0 ? {} : _temp7,\n            onMouseMove = _ref7.onMouseMove,\n            onMouseDown = _ref7.onMouseDown,\n            onClick = _ref7.onClick,\n            onPress = _ref7.onPress,\n            index = _ref7.index,\n            _ref7$item = _ref7.item,\n            item = _ref7$item === void 0 ?  false ?\n        /* istanbul ignore next */\n        undefined : requiredProp('getItemProps', 'item') : _ref7$item,\n            rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref7, [\"onMouseMove\", \"onMouseDown\", \"onClick\", \"onPress\", \"index\", \"item\"]);\n\n        if (index === undefined) {\n          _this.items.push(item);\n\n          index = _this.items.indexOf(item);\n        } else {\n          _this.items[index] = item;\n        }\n\n        var onSelectKey = 'onClick';\n        var customClickHandler = onClick;\n        var enabledEventHandlers = (_enabledEventHandlers = {\n          // onMouseMove is used over onMouseEnter here. onMouseMove\n          // is only triggered on actual mouse movement while onMouseEnter\n          // can fire on DOM changes, interrupting keyboard navigation\n          onMouseMove: callAllEventHandlers(onMouseMove, function () {\n            if (index === _this.getState().highlightedIndex) {\n              return;\n            }\n\n            _this.setHighlightedIndex(index, {\n              type: itemMouseEnter\n            }); // We never want to manually scroll when changing state based\n            // on `onMouseMove` because we will be moving the element out\n            // from under the user which is currently scrolling/moving the\n            // cursor\n\n\n            _this.avoidScrolling = true;\n\n            _this.internalSetTimeout(function () {\n              return _this.avoidScrolling = false;\n            }, 250);\n          }),\n          onMouseDown: callAllEventHandlers(onMouseDown, function (event) {\n            // This prevents the activeElement from being changed\n            // to the item so it can remain with the current activeElement\n            // which is a more common use case.\n            event.preventDefault();\n          })\n        }, _enabledEventHandlers[onSelectKey] = callAllEventHandlers(customClickHandler, function () {\n          _this.selectItemAtIndex(index, {\n            type: clickItem\n          });\n        }), _enabledEventHandlers); // Passing down the onMouseDown handler to prevent redirect\n        // of the activeElement if clicking on disabled items\n\n        var eventHandlers = rest.disabled ? {\n          onMouseDown: enabledEventHandlers.onMouseDown\n        } : enabledEventHandlers;\n        return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          id: _this.getItemId(index),\n          role: 'option',\n          'aria-selected': _this.getState().highlightedIndex === index\n        }, eventHandlers, rest);\n      };\n\n      _this.clearItems = function () {\n        _this.items = [];\n      };\n\n      _this.reset = function (otherStateToSet, cb) {\n        if (otherStateToSet === void 0) {\n          otherStateToSet = {};\n        }\n\n        otherStateToSet = pickState(otherStateToSet);\n\n        _this.internalSetState(function (_ref8) {\n          var selectedItem = _ref8.selectedItem;\n          return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            isOpen: _this.props.defaultIsOpen,\n            highlightedIndex: _this.props.defaultHighlightedIndex,\n            inputValue: _this.props.itemToString(selectedItem)\n          }, otherStateToSet);\n        }, cb);\n      };\n\n      _this.toggleMenu = function (otherStateToSet, cb) {\n        if (otherStateToSet === void 0) {\n          otherStateToSet = {};\n        }\n\n        otherStateToSet = pickState(otherStateToSet);\n\n        _this.internalSetState(function (_ref9) {\n          var isOpen = _ref9.isOpen;\n          return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            isOpen: !isOpen\n          }, isOpen && {\n            highlightedIndex: _this.props.defaultHighlightedIndex\n          }, otherStateToSet);\n        }, function () {\n          var _this$getState7 = _this.getState(),\n              isOpen = _this$getState7.isOpen,\n              highlightedIndex = _this$getState7.highlightedIndex;\n\n          if (isOpen) {\n            if (_this.getItemCount() > 0 && typeof highlightedIndex === 'number') {\n              _this.setHighlightedIndex(highlightedIndex, otherStateToSet);\n            }\n          }\n\n          cbToCb(cb)();\n        });\n      };\n\n      _this.openMenu = function (cb) {\n        _this.internalSetState({\n          isOpen: true\n        }, cb);\n      };\n\n      _this.closeMenu = function (cb) {\n        _this.internalSetState({\n          isOpen: false\n        }, cb);\n      };\n\n      _this.updateStatus = debounce(function () {\n        var state = _this.getState();\n\n        var item = _this.items[state.highlightedIndex];\n\n        var resultCount = _this.getItemCount();\n\n        var status = _this.props.getA11yStatusMessage(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          itemToString: _this.props.itemToString,\n          previousResultCount: _this.previousResultCount,\n          resultCount: resultCount,\n          highlightedItem: item\n        }, state));\n\n        _this.previousResultCount = resultCount;\n        setStatus(status, _this.props.environment.document);\n      }, 200);\n\n      // fancy destructuring + defaults + aliases\n      // this basically says each value of state should either be set to\n      // the initial value or the default value if the initial value is not provided\n      var _this$props = _this.props,\n          defaultHighlightedIndex = _this$props.defaultHighlightedIndex,\n          _this$props$initialHi = _this$props.initialHighlightedIndex,\n          _highlightedIndex = _this$props$initialHi === void 0 ? defaultHighlightedIndex : _this$props$initialHi,\n          defaultIsOpen = _this$props.defaultIsOpen,\n          _this$props$initialIs = _this$props.initialIsOpen,\n          _isOpen = _this$props$initialIs === void 0 ? defaultIsOpen : _this$props$initialIs,\n          _this$props$initialIn = _this$props.initialInputValue,\n          _inputValue = _this$props$initialIn === void 0 ? '' : _this$props$initialIn,\n          _this$props$initialSe = _this$props.initialSelectedItem,\n          _selectedItem = _this$props$initialSe === void 0 ? null : _this$props$initialSe;\n\n      var _state = _this.getState({\n        highlightedIndex: _highlightedIndex,\n        isOpen: _isOpen,\n        inputValue: _inputValue,\n        selectedItem: _selectedItem\n      });\n\n      if (_state.selectedItem != null && _this.props.initialInputValue === undefined) {\n        _state.inputValue = _this.props.itemToString(_state.selectedItem);\n      }\n\n      _this.state = _state;\n      return _this;\n    }\n\n    var _proto = Downshift.prototype;\n\n    /**\n     * Clear all running timeouts\n     */\n    _proto.internalClearTimeouts = function internalClearTimeouts() {\n      this.timeoutIds.forEach(function (id) {\n        clearTimeout(id);\n      });\n      this.timeoutIds = [];\n    }\n    /**\n     * Gets the state based on internal state or props\n     * If a state value is passed via props, then that\n     * is the value given, otherwise it's retrieved from\n     * stateToMerge\n     *\n     * @param {Object} stateToMerge defaults to this.state\n     * @return {Object} the state\n     */\n    ;\n\n    _proto.getState = function getState$1(stateToMerge) {\n      if (stateToMerge === void 0) {\n        stateToMerge = this.state;\n      }\n\n      return getState(stateToMerge, this.props);\n    };\n\n    _proto.getItemCount = function getItemCount() {\n      // things read better this way. They're in priority order:\n      // 1. `this.itemCount`\n      // 2. `this.props.itemCount`\n      // 3. `this.items.length`\n      var itemCount = this.items.length;\n\n      if (this.itemCount != null) {\n        itemCount = this.itemCount;\n      } else if (this.props.itemCount !== undefined) {\n        itemCount = this.props.itemCount;\n      }\n\n      return itemCount;\n    };\n\n    _proto.getItemNodeFromIndex = function getItemNodeFromIndex(index) {\n      return this.props.environment.document.getElementById(this.getItemId(index));\n    };\n\n    _proto.scrollHighlightedItemIntoView = function scrollHighlightedItemIntoView() {\n      /* istanbul ignore else (react-native) */\n      {\n        var node = this.getItemNodeFromIndex(this.getState().highlightedIndex);\n        this.props.scrollIntoView(node, this._menuNode);\n      }\n    };\n\n    _proto.moveHighlightedIndex = function moveHighlightedIndex(amount, otherStateToSet) {\n      var _this6 = this;\n\n      var itemCount = this.getItemCount();\n\n      var _this$getState8 = this.getState(),\n          highlightedIndex = _this$getState8.highlightedIndex;\n\n      if (itemCount > 0) {\n        var nextHighlightedIndex = getNextWrappingIndex(amount, highlightedIndex, itemCount, function (index) {\n          return _this6.getItemNodeFromIndex(index);\n        });\n        this.setHighlightedIndex(nextHighlightedIndex, otherStateToSet);\n      }\n    };\n\n    _proto.getStateAndHelpers = function getStateAndHelpers() {\n      var _this$getState9 = this.getState(),\n          highlightedIndex = _this$getState9.highlightedIndex,\n          inputValue = _this$getState9.inputValue,\n          selectedItem = _this$getState9.selectedItem,\n          isOpen = _this$getState9.isOpen;\n\n      var itemToString = this.props.itemToString;\n      var id = this.id;\n      var getRootProps = this.getRootProps,\n          getToggleButtonProps = this.getToggleButtonProps,\n          getLabelProps = this.getLabelProps,\n          getMenuProps = this.getMenuProps,\n          getInputProps = this.getInputProps,\n          getItemProps = this.getItemProps,\n          openMenu = this.openMenu,\n          closeMenu = this.closeMenu,\n          toggleMenu = this.toggleMenu,\n          selectItem = this.selectItem,\n          selectItemAtIndex = this.selectItemAtIndex,\n          selectHighlightedItem = this.selectHighlightedItem,\n          setHighlightedIndex = this.setHighlightedIndex,\n          clearSelection = this.clearSelection,\n          clearItems = this.clearItems,\n          reset = this.reset,\n          setItemCount = this.setItemCount,\n          unsetItemCount = this.unsetItemCount,\n          setState = this.internalSetState;\n      return {\n        // prop getters\n        getRootProps: getRootProps,\n        getToggleButtonProps: getToggleButtonProps,\n        getLabelProps: getLabelProps,\n        getMenuProps: getMenuProps,\n        getInputProps: getInputProps,\n        getItemProps: getItemProps,\n        // actions\n        reset: reset,\n        openMenu: openMenu,\n        closeMenu: closeMenu,\n        toggleMenu: toggleMenu,\n        selectItem: selectItem,\n        selectItemAtIndex: selectItemAtIndex,\n        selectHighlightedItem: selectHighlightedItem,\n        setHighlightedIndex: setHighlightedIndex,\n        clearSelection: clearSelection,\n        clearItems: clearItems,\n        setItemCount: setItemCount,\n        unsetItemCount: unsetItemCount,\n        setState: setState,\n        // props\n        itemToString: itemToString,\n        // derived\n        id: id,\n        // state\n        highlightedIndex: highlightedIndex,\n        inputValue: inputValue,\n        isOpen: isOpen,\n        selectedItem: selectedItem\n      };\n    } //////////////////////////// ROOT\n    ;\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this7 = this;\n\n      /* istanbul ignore if (react-native) */\n      if ( true && this.getMenuProps.called && !this.getMenuProps.suppressRefError) {\n        validateGetMenuPropsCalledCorrectly(this._menuNode, this.getMenuProps);\n      }\n      /* istanbul ignore if (react-native) */\n\n\n      {\n        // this.isMouseDown helps us track whether the mouse is currently held down.\n        // This is useful when the user clicks on an item in the list, but holds the mouse\n        // down long enough for the list to disappear (because the blur event fires on the input)\n        // this.isMouseDown is used in the blur handler on the input to determine whether the blur event should\n        // trigger hiding the menu.\n        var onMouseDown = function () {\n          _this7.isMouseDown = true;\n        };\n\n        var onMouseUp = function (event) {\n          _this7.isMouseDown = false; // if the target element or the activeElement is within a downshift node\n          // then we don't want to reset downshift\n\n          var contextWithinDownshift = targetWithinDownshift(event.target, [_this7._rootNode, _this7._menuNode], _this7.props.environment.document);\n\n          if (!contextWithinDownshift && _this7.getState().isOpen) {\n            _this7.reset({\n              type: mouseUp\n            }, function () {\n              return _this7.props.onOuterClick(_this7.getStateAndHelpers());\n            });\n          }\n        }; // Touching an element in iOS gives focus and hover states, but touching out of\n        // the element will remove hover, and persist the focus state, resulting in the\n        // blur event not being triggered.\n        // this.isTouchMove helps us track whether the user is tapping or swiping on a touch screen.\n        // If the user taps outside of Downshift, the component should be reset,\n        // but not if the user is swiping\n\n\n        var onTouchStart = function () {\n          _this7.isTouchMove = false;\n        };\n\n        var onTouchMove = function () {\n          _this7.isTouchMove = true;\n        };\n\n        var onTouchEnd = function (event) {\n          var contextWithinDownshift = targetWithinDownshift(event.target, [_this7._rootNode, _this7._menuNode], _this7.props.environment.document, false);\n\n          if (!_this7.isTouchMove && !contextWithinDownshift && _this7.getState().isOpen) {\n            _this7.reset({\n              type: touchEnd\n            }, function () {\n              return _this7.props.onOuterClick(_this7.getStateAndHelpers());\n            });\n          }\n        };\n\n        var environment = this.props.environment;\n        environment.addEventListener('mousedown', onMouseDown);\n        environment.addEventListener('mouseup', onMouseUp);\n        environment.addEventListener('touchstart', onTouchStart);\n        environment.addEventListener('touchmove', onTouchMove);\n        environment.addEventListener('touchend', onTouchEnd);\n\n        this.cleanup = function () {\n          _this7.internalClearTimeouts();\n\n          _this7.updateStatus.cancel();\n\n          environment.removeEventListener('mousedown', onMouseDown);\n          environment.removeEventListener('mouseup', onMouseUp);\n          environment.removeEventListener('touchstart', onTouchStart);\n          environment.removeEventListener('touchmove', onTouchMove);\n          environment.removeEventListener('touchend', onTouchEnd);\n        };\n      }\n    };\n\n    _proto.shouldScroll = function shouldScroll(prevState, prevProps) {\n      var _ref10 = this.props.highlightedIndex === undefined ? this.getState() : this.props,\n          currentHighlightedIndex = _ref10.highlightedIndex;\n\n      var _ref11 = prevProps.highlightedIndex === undefined ? prevState : prevProps,\n          prevHighlightedIndex = _ref11.highlightedIndex;\n\n      var scrollWhenOpen = currentHighlightedIndex && this.getState().isOpen && !prevState.isOpen;\n      return scrollWhenOpen || currentHighlightedIndex !== prevHighlightedIndex;\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n      if (true) {\n        validateControlledUnchanged(this.state, prevProps, this.props);\n        /* istanbul ignore if (react-native) */\n\n        if ( this.getMenuProps.called && !this.getMenuProps.suppressRefError) {\n          validateGetMenuPropsCalledCorrectly(this._menuNode, this.getMenuProps);\n        }\n      }\n\n      if (isControlledProp(this.props, 'selectedItem') && this.props.selectedItemChanged(prevProps.selectedItem, this.props.selectedItem)) {\n        this.internalSetState({\n          type: controlledPropUpdatedSelectedItem,\n          inputValue: this.props.itemToString(this.props.selectedItem)\n        });\n      }\n\n      if (!this.avoidScrolling && this.shouldScroll(prevState, prevProps)) {\n        this.scrollHighlightedItemIntoView();\n      }\n      /* istanbul ignore else (react-native) */\n\n\n      this.updateStatus();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      this.cleanup(); // avoids memory leak\n    };\n\n    _proto.render = function render() {\n      var children = unwrapArray(this.props.children, noop); // because the items are rerendered every time we call the children\n      // we clear this out each render and it will be populated again as\n      // getItemProps is called.\n\n      this.clearItems(); // we reset this so we know whether the user calls getRootProps during\n      // this render. If they do then we don't need to do anything,\n      // if they don't then we need to clone the element they return and\n      // apply the props for them.\n\n      this.getRootProps.called = false;\n      this.getRootProps.refKey = undefined;\n      this.getRootProps.suppressRefError = undefined; // we do something similar for getMenuProps\n\n      this.getMenuProps.called = false;\n      this.getMenuProps.refKey = undefined;\n      this.getMenuProps.suppressRefError = undefined; // we do something similar for getLabelProps\n\n      this.getLabelProps.called = false; // and something similar for getInputProps\n\n      this.getInputProps.called = false;\n      var element = unwrapArray(children(this.getStateAndHelpers()));\n\n      if (!element) {\n        return null;\n      }\n\n      if (this.getRootProps.called || this.props.suppressRefError) {\n        if ( true && !this.getRootProps.suppressRefError && !this.props.suppressRefError) {\n          validateGetRootPropsCalledCorrectly(element, this.getRootProps);\n        }\n\n        return element;\n      } else if (isDOMElement(element)) {\n        // they didn't apply the root props, but we can clone\n        // this and apply the props ourselves\n        return Object(react__WEBPACK_IMPORTED_MODULE_5__[\"cloneElement\"])(element, this.getRootProps(getElementProps(element)));\n      }\n      /* istanbul ignore else */\n\n\n      if (true) {\n        // they didn't apply the root props, but they need to\n        // otherwise we can't query around the autocomplete\n        throw new Error('downshift: If you return a non-DOM element, you must apply the getRootProps function');\n      }\n      /* istanbul ignore next */\n\n\n      return undefined;\n    };\n\n    return Downshift;\n  }(react__WEBPACK_IMPORTED_MODULE_5__[\"Component\"]);\n\n  Downshift.defaultProps = {\n    defaultHighlightedIndex: null,\n    defaultIsOpen: false,\n    getA11yStatusMessage: getA11yStatusMessage,\n    itemToString: function itemToString(i) {\n      if (i == null) {\n        return '';\n      }\n\n      if ( true && isPlainObject(i) && !i.hasOwnProperty('toString')) {\n        // eslint-disable-next-line no-console\n        console.warn('downshift: An object was passed to the default implementation of `itemToString`. You should probably provide your own `itemToString` implementation. Please refer to the `itemToString` API documentation.', 'The object that was passed:', i);\n      }\n\n      return String(i);\n    },\n    onStateChange: noop,\n    onInputValueChange: noop,\n    onUserAction: noop,\n    onChange: noop,\n    onSelect: noop,\n    onOuterClick: noop,\n    selectedItemChanged: function selectedItemChanged(prevItem, item) {\n      return prevItem !== item;\n    },\n    environment: typeof window === 'undefined'\n    /* istanbul ignore next (ssr) */\n    ? {} : window,\n    stateReducer: function stateReducer(state, stateToSet) {\n      return stateToSet;\n    },\n    suppressRefError: false,\n    scrollIntoView: scrollIntoView\n  };\n  Downshift.stateChangeTypes = stateChangeTypes;\n  return Downshift;\n}();\n\n true ? Downshift.propTypes = {\n  children: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  defaultHighlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  defaultIsOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  initialHighlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  initialSelectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  initialInputValue: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  initialIsOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  getA11yStatusMessage: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  itemToString: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onSelect: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onStateChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onInputValueChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onUserAction: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onOuterClick: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  selectedItemChanged: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  stateReducer: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  itemCount: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  id: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  environment: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n    addEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    removeEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    document: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n      getElementById: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n      activeElement: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n      body: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any\n    })\n  }),\n  suppressRefError: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  scrollIntoView: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  // things we keep in state for uncontrolled components\n  // but can accept as props for controlled components\n\n  /* eslint-disable react/no-unused-prop-types */\n  selectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  isOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  inputValue: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  highlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  labelId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  inputId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  menuId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  getItemId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func\n  /* eslint-enable react/no-unused-prop-types */\n\n} : undefined;\n\nfunction validateGetMenuPropsCalledCorrectly(node, _ref12) {\n  var refKey = _ref12.refKey;\n\n  if (!node) {\n    // eslint-disable-next-line no-console\n    console.error(\"downshift: The ref prop \\\"\" + refKey + \"\\\" from getMenuProps was not applied correctly on your menu element.\");\n  }\n}\n\nfunction validateGetRootPropsCalledCorrectly(element, _ref13) {\n  var refKey = _ref13.refKey;\n  var refKeySpecified = refKey !== 'ref';\n  var isComposite = !isDOMElement(element);\n\n  if (isComposite && !refKeySpecified && !Object(react_is__WEBPACK_IMPORTED_MODULE_6__[\"isForwardRef\"])(element)) {\n    // eslint-disable-next-line no-console\n    console.error('downshift: You returned a non-DOM element. You must specify a refKey in getRootProps');\n  } else if (!isComposite && refKeySpecified) {\n    // eslint-disable-next-line no-console\n    console.error(\"downshift: You returned a DOM element. You should not specify a refKey in getRootProps. You specified \\\"\" + refKey + \"\\\"\");\n  }\n\n  if (!Object(react_is__WEBPACK_IMPORTED_MODULE_6__[\"isForwardRef\"])(element) && !getElementProps(element)[refKey]) {\n    // eslint-disable-next-line no-console\n    console.error(\"downshift: You must apply the ref prop \\\"\" + refKey + \"\\\" from getRootProps onto your root element.\");\n  }\n}\n\nvar dropdownDefaultStateValues = {\n  highlightedIndex: -1,\n  isOpen: false,\n  selectedItem: null,\n  inputValue: ''\n};\n\nfunction callOnChangeProps(action, state, newState) {\n  var props = action.props,\n      type = action.type;\n  var changes = {};\n  Object.keys(state).forEach(function (key) {\n    invokeOnChangeHandler(key, action, state, newState);\n\n    if (newState[key] !== state[key]) {\n      changes[key] = newState[key];\n    }\n  });\n\n  if (props.onStateChange && Object.keys(changes).length) {\n    props.onStateChange(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n      type: type\n    }, changes));\n  }\n}\n\nfunction invokeOnChangeHandler(key, action, state, newState) {\n  var props = action.props,\n      type = action.type;\n  var handler = \"on\" + capitalizeString(key) + \"Change\";\n\n  if (props[handler] && newState[key] !== undefined && newState[key] !== state[key]) {\n    props[handler](Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n      type: type\n    }, newState));\n  }\n}\n/**\n * Default state reducer that returns the changes.\n *\n * @param {Object} s state.\n * @param {Object} a action with changes.\n * @returns {Object} changes.\n */\n\n\nfunction stateReducer(s, a) {\n  return a.changes;\n}\n/**\n * Returns a message to be added to aria-live region when item is selected.\n *\n * @param {Object} selectionParameters Parameters required to build the message.\n * @returns {string} The a11y message.\n */\n\n\nfunction getA11ySelectionMessage(selectionParameters) {\n  var selectedItem = selectionParameters.selectedItem,\n      itemToStringLocal = selectionParameters.itemToString;\n  return selectedItem ? itemToStringLocal(selectedItem) + \" has been selected.\" : '';\n}\n/**\n * Debounced call for updating the a11y message.\n */\n\n\nvar updateA11yStatus = debounce(function (getA11yMessage, document) {\n  setStatus(getA11yMessage(), document);\n}, 200);\nfunction getElementIds(_ref) {\n  var id = _ref.id,\n      labelId = _ref.labelId,\n      menuId = _ref.menuId,\n      getItemId = _ref.getItemId,\n      toggleButtonId = _ref.toggleButtonId;\n  var uniqueId = id === undefined ? \"downshift-\" + generateId() : id;\n  return {\n    labelId: labelId || uniqueId + \"-label\",\n    menuId: menuId || uniqueId + \"-menu\",\n    getItemId: getItemId || function (index) {\n      return uniqueId + \"-item-\" + index;\n    },\n    toggleButtonId: toggleButtonId || uniqueId + \"-toggle-button\"\n  };\n}\nfunction getItemIndex(index, item, items) {\n  if (index !== undefined) {\n    return index;\n  }\n\n  if (items.length === 0) {\n    return -1;\n  }\n\n  return items.indexOf(item);\n}\n\nfunction itemToString(item) {\n  return item ? String(item) : '';\n}\n\nfunction getPropTypesValidator(caller, propTypes) {\n  // istanbul ignore next\n  return function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    Object.keys(propTypes).forEach(function (key) {\n      prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.checkPropTypes(propTypes, options, key, caller.name);\n    });\n  };\n}\nfunction isAcceptedCharacterKey(key) {\n  return /^\\S{1}$/.test(key);\n}\nfunction capitalizeString(string) {\n  return \"\" + string.slice(0, 1).toUpperCase() + string.slice(1);\n}\nfunction useLatestRef(val) {\n  var ref = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(val); // technically this is not \"concurrent mode safe\" because we're manipulating\n  // the value during render (so it's not idempotent). However, the places this\n  // hook is used is to support memoizing callbacks which will be called\n  // *during* render, so we need the latest values *during* render.\n  // If not for this, then we'd probably want to use useLayoutEffect instead.\n\n  ref.current = val;\n  return ref;\n}\n/**\n * Computes the controlled state using a the previous state, props,\n * two reducers, one from downshift and an optional one from the user.\n * Also calls the onChange handlers for state values that have changed.\n *\n * @param {Function} reducer Reducer function from downshift.\n * @param {Object} initialState Initial state of the hook.\n * @param {Object} props The hook props.\n * @returns {Array} An array with the state and an action dispatcher.\n */\n\nfunction useEnhancedReducer(reducer, initialState, props) {\n  var prevStateRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])();\n  var actionRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])();\n  var enhancedReducer = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (state, action) {\n    actionRef.current = action;\n    state = getState(state, action.props);\n    var changes = reducer(state, action);\n    var newState = action.props.stateReducer(state, Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, action, {\n      changes: changes\n    }));\n    return newState;\n  }, [reducer]);\n\n  var _useReducer = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useReducer\"])(enhancedReducer, initialState),\n      state = _useReducer[0],\n      dispatch = _useReducer[1];\n\n  var propsRef = useLatestRef(props);\n  var dispatchWithProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (action) {\n    return dispatch(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n      props: propsRef.current\n    }, action));\n  }, [propsRef]);\n  var action = actionRef.current;\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (action && prevStateRef.current && prevStateRef.current !== state) {\n      callOnChangeProps(action, getState(prevStateRef.current, action.props), state);\n    }\n\n    prevStateRef.current = state;\n  }, [state, props, action]);\n  return [state, dispatchWithProps];\n}\n/**\n * Wraps the useEnhancedReducer and applies the controlled prop values before\n * returning the new state.\n *\n * @param {Function} reducer Reducer function from downshift.\n * @param {Object} initialState Initial state of the hook.\n * @param {Object} props The hook props.\n * @returns {Array} An array with the state and an action dispatcher.\n */\n\nfunction useControlledReducer(reducer, initialState, props) {\n  var _useEnhancedReducer = useEnhancedReducer(reducer, initialState, props),\n      state = _useEnhancedReducer[0],\n      dispatch = _useEnhancedReducer[1];\n\n  return [getState(state, props), dispatch];\n}\nvar defaultProps = {\n  itemToString: itemToString,\n  stateReducer: stateReducer,\n  getA11ySelectionMessage: getA11ySelectionMessage,\n  scrollIntoView: scrollIntoView,\n  circularNavigation: false,\n  environment: typeof window === 'undefined'\n  /* istanbul ignore next (ssr) */\n  ? {} : window\n};\nfunction getDefaultValue(props, propKey, defaultStateValues) {\n  if (defaultStateValues === void 0) {\n    defaultStateValues = dropdownDefaultStateValues;\n  }\n\n  var defaultPropKey = \"default\" + capitalizeString(propKey);\n\n  if (defaultPropKey in props) {\n    return props[defaultPropKey];\n  }\n\n  return defaultStateValues[propKey];\n}\nfunction getInitialValue(props, propKey, defaultStateValues) {\n  if (defaultStateValues === void 0) {\n    defaultStateValues = dropdownDefaultStateValues;\n  }\n\n  if (propKey in props) {\n    return props[propKey];\n  }\n\n  var initialPropKey = \"initial\" + capitalizeString(propKey);\n\n  if (initialPropKey in props) {\n    return props[initialPropKey];\n  }\n\n  return getDefaultValue(props, propKey, defaultStateValues);\n}\nfunction getInitialState(props) {\n  var selectedItem = getInitialValue(props, 'selectedItem');\n  var isOpen = getInitialValue(props, 'isOpen');\n  var highlightedIndex = getInitialValue(props, 'highlightedIndex');\n  var inputValue = getInitialValue(props, 'inputValue');\n  return {\n    highlightedIndex: highlightedIndex < 0 && selectedItem && isOpen ? props.items.indexOf(selectedItem) : highlightedIndex,\n    isOpen: isOpen,\n    selectedItem: selectedItem,\n    inputValue: inputValue\n  };\n}\nfunction getHighlightedIndexOnOpen(props, state, offset, getItemNodeFromIndex) {\n  var items = props.items,\n      initialHighlightedIndex = props.initialHighlightedIndex,\n      defaultHighlightedIndex = props.defaultHighlightedIndex;\n  var selectedItem = state.selectedItem,\n      highlightedIndex = state.highlightedIndex;\n\n  if (items.length === 0) {\n    return -1;\n  } // initialHighlightedIndex will give value to highlightedIndex on initial state only.\n\n\n  if (initialHighlightedIndex !== undefined && highlightedIndex === initialHighlightedIndex) {\n    return initialHighlightedIndex;\n  }\n\n  if (defaultHighlightedIndex !== undefined) {\n    return defaultHighlightedIndex;\n  }\n\n  if (selectedItem) {\n    if (offset === 0) {\n      return items.indexOf(selectedItem);\n    }\n\n    return getNextWrappingIndex(offset, items.indexOf(selectedItem), items.length, getItemNodeFromIndex, false);\n  }\n\n  if (offset === 0) {\n    return -1;\n  }\n\n  return offset < 0 ? items.length - 1 : 0;\n}\n/**\n * Reuse the movement tracking of mouse and touch events.\n *\n * @param {boolean} isOpen Whether the dropdown is open or not.\n * @param {Array<Object>} downshiftElementRefs Downshift element refs to track movement (toggleButton, menu etc.)\n * @param {Object} environment Environment where component/hook exists.\n * @param {Function} handleBlur Handler on blur from mouse or touch.\n * @returns {Object} Ref containing whether mouseDown or touchMove event is happening\n */\n\nfunction useMouseAndTouchTracker(isOpen, downshiftElementRefs, environment, handleBlur) {\n  var mouseAndTouchTrackersRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])({\n    isMouseDown: false,\n    isTouchMove: false\n  });\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    // The same strategy for checking if a click occurred inside or outside downsift\n    // as in downshift.js.\n    var onMouseDown = function () {\n      mouseAndTouchTrackersRef.current.isMouseDown = true;\n    };\n\n    var onMouseUp = function (event) {\n      mouseAndTouchTrackersRef.current.isMouseDown = false;\n\n      if (isOpen && !targetWithinDownshift(event.target, downshiftElementRefs.map(function (ref) {\n        return ref.current;\n      }), environment.document)) {\n        handleBlur();\n      }\n    };\n\n    var onTouchStart = function () {\n      mouseAndTouchTrackersRef.current.isTouchMove = false;\n    };\n\n    var onTouchMove = function () {\n      mouseAndTouchTrackersRef.current.isTouchMove = true;\n    };\n\n    var onTouchEnd = function (event) {\n      if (isOpen && !mouseAndTouchTrackersRef.current.isTouchMove && !targetWithinDownshift(event.target, downshiftElementRefs.map(function (ref) {\n        return ref.current;\n      }), environment.document, false)) {\n        handleBlur();\n      }\n    };\n\n    environment.addEventListener('mousedown', onMouseDown);\n    environment.addEventListener('mouseup', onMouseUp);\n    environment.addEventListener('touchstart', onTouchStart);\n    environment.addEventListener('touchmove', onTouchMove);\n    environment.addEventListener('touchend', onTouchEnd);\n    return function () {\n      environment.removeEventListener('mousedown', onMouseDown);\n      environment.removeEventListener('mouseup', onMouseUp);\n      environment.removeEventListener('touchstart', onTouchStart);\n      environment.removeEventListener('touchmove', onTouchMove);\n      environment.removeEventListener('touchend', onTouchEnd);\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen, environment]);\n  return mouseAndTouchTrackersRef;\n}\n/**\n * Custom hook that checks if getter props are called correctly.\n *\n * @param  {...any} propKeys Getter prop names to be handled.\n * @returns {Function} Setter function called inside getter props to set call information.\n */\n\nfunction useGetterPropsCalledChecker() {\n  var isNotProduction = \"development\" !== 'production';\n  var isInitialMountRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(true);\n\n  for (var _len = arguments.length, propKeys = new Array(_len), _key = 0; _key < _len; _key++) {\n    propKeys[_key] = arguments[_key];\n  }\n\n  var getterPropsCalledRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(propKeys.reduce(function (acc, propKey) {\n    acc[propKey] = {};\n    return acc;\n  }, {}));\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (!isNotProduction) {\n      return;\n    }\n\n    Object.keys(getterPropsCalledRef.current).forEach(function (propKey) {\n      var propCallInfo = getterPropsCalledRef.current[propKey];\n\n      if (isInitialMountRef.current) {\n        if (!Object.keys(propCallInfo).length) {\n          // eslint-disable-next-line no-console\n          console.error(\"downshift: You forgot to call the \" + propKey + \" getter function on your component / element.\");\n          return;\n        }\n      }\n\n      var suppressRefError = propCallInfo.suppressRefError,\n          refKey = propCallInfo.refKey,\n          elementRef = propCallInfo.elementRef;\n\n      if ((!elementRef || !elementRef.current) && !suppressRefError) {\n        // eslint-disable-next-line no-console\n        console.error(\"downshift: The ref prop \\\"\" + refKey + \"\\\" from \" + propKey + \" was not applied correctly on your element.\");\n      }\n    });\n    isInitialMountRef.current = false;\n  });\n  var setGetterPropCallInfo = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (propKey, suppressRefError, refKey, elementRef) {\n    if (true) {\n      getterPropsCalledRef.current[propKey] = {\n        suppressRefError: suppressRefError,\n        refKey: refKey,\n        elementRef: elementRef\n      };\n    }\n  }, []);\n  return setGetterPropCallInfo;\n}\nfunction useA11yMessageSetter(getA11yMessage, dependencyArray, _ref2) {\n  var isInitialMount = _ref2.isInitialMount,\n      previousResultCount = _ref2.previousResultCount,\n      highlightedIndex = _ref2.highlightedIndex,\n      items = _ref2.items,\n      environment = _ref2.environment,\n      rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref2, [\"isInitialMount\", \"previousResultCount\", \"highlightedIndex\", \"items\", \"environment\"]);\n\n  // Sets a11y status message on changes in state.\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (isInitialMount) {\n      return;\n    }\n\n    updateA11yStatus(function () {\n      return getA11yMessage(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n        highlightedIndex: highlightedIndex,\n        highlightedItem: items[highlightedIndex],\n        resultCount: items.length,\n        previousResultCount: previousResultCount\n      }, rest));\n    }, environment.document); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencyArray);\n}\nfunction useScrollIntoView(_ref3) {\n  var highlightedIndex = _ref3.highlightedIndex,\n      isOpen = _ref3.isOpen,\n      itemRefs = _ref3.itemRefs,\n      getItemNodeFromIndex = _ref3.getItemNodeFromIndex,\n      menuElement = _ref3.menuElement,\n      scrollIntoViewProp = _ref3.scrollIntoView;\n  // used not to scroll on highlight by mouse.\n  var shouldScrollRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(true); // Scroll on highlighted item if change comes from keyboard.\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (highlightedIndex < 0 || !isOpen || !Object.keys(itemRefs.current).length) {\n      return;\n    }\n\n    if (shouldScrollRef.current === false) {\n      shouldScrollRef.current = true;\n    } else {\n      scrollIntoViewProp(getItemNodeFromIndex(highlightedIndex), menuElement);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [highlightedIndex]);\n  return shouldScrollRef;\n}\nfunction useControlPropsValidator(_ref4) {\n  var isInitialMount = _ref4.isInitialMount,\n      props = _ref4.props,\n      state = _ref4.state;\n  // used for checking when props are moving from controlled to uncontrolled.\n  var prevPropsRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(props);\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (isInitialMount) {\n      return;\n    }\n\n    validateControlledUnchanged(state, prevPropsRef.current, props);\n    prevPropsRef.current = props;\n  }, [state, props, isInitialMount]);\n}\n\nfunction getItemIndexByCharacterKey(keysSoFar, highlightedIndex, items, itemToStringParam, getItemNodeFromIndex) {\n  var lowerCasedItemStrings = items.map(function (item) {\n    return itemToStringParam(item).toLowerCase();\n  });\n  var lowerCasedKeysSoFar = keysSoFar.toLowerCase();\n\n  var isValid = function (itemString, index) {\n    var element = getItemNodeFromIndex(index);\n    return itemString.startsWith(lowerCasedKeysSoFar) && !(element && element.hasAttribute('disabled'));\n  };\n\n  for (var index = highlightedIndex + 1; index < lowerCasedItemStrings.length; index++) {\n    var itemString = lowerCasedItemStrings[index];\n\n    if (isValid(itemString, index)) {\n      return index;\n    }\n  }\n\n  for (var _index = 0; _index < highlightedIndex; _index++) {\n    var _itemString = lowerCasedItemStrings[_index];\n\n    if (isValid(_itemString, _index)) {\n      return _index;\n    }\n  }\n\n  return highlightedIndex;\n}\n\nvar propTypes = {\n  items: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.array.isRequired,\n  itemToString: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  getA11yStatusMessage: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  getA11ySelectionMessage: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  circularNavigation: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  highlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  defaultHighlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  initialHighlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  isOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  defaultIsOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  initialIsOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  selectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  initialSelectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  defaultSelectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  id: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  labelId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  menuId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  getItemId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  toggleButtonId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  stateReducer: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onSelectedItemChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onHighlightedIndexChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onStateChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onIsOpenChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  environment: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n    addEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    removeEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    document: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n      getElementById: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n      activeElement: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n      body: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any\n    })\n  })\n};\n/**\n * Default implementation for status message. Only added when menu is open.\n * Will specift if there are results in the list, and if so, how many,\n * and what keys are relevant.\n *\n * @param {Object} param the downshift state and other relevant properties\n * @return {String} the a11y status message\n */\n\nfunction getA11yStatusMessage$1(_ref) {\n  var isOpen = _ref.isOpen,\n      resultCount = _ref.resultCount,\n      previousResultCount = _ref.previousResultCount;\n\n  if (!isOpen) {\n    return '';\n  }\n\n  if (!resultCount) {\n    return 'No results are available.';\n  }\n\n  if (resultCount !== previousResultCount) {\n    return resultCount + \" result\" + (resultCount === 1 ? ' is' : 's are') + \" available, use up and down arrow keys to navigate. Press Enter or Space Bar keys to select.\";\n  }\n\n  return '';\n}\n\nvar defaultProps$1 = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, defaultProps, {\n  getA11yStatusMessage: getA11yStatusMessage$1\n});\n\nvar MenuKeyDownArrowDown =  true ? '__menu_keydown_arrow_down__' : undefined;\nvar MenuKeyDownArrowUp =  true ? '__menu_keydown_arrow_up__' : undefined;\nvar MenuKeyDownEscape =  true ? '__menu_keydown_escape__' : undefined;\nvar MenuKeyDownHome =  true ? '__menu_keydown_home__' : undefined;\nvar MenuKeyDownEnd =  true ? '__menu_keydown_end__' : undefined;\nvar MenuKeyDownEnter =  true ? '__menu_keydown_enter__' : undefined;\nvar MenuKeyDownSpaceButton =  true ? '__menu_keydown_space_button__' : undefined;\nvar MenuKeyDownCharacter =  true ? '__menu_keydown_character__' : undefined;\nvar MenuBlur =  true ? '__menu_blur__' : undefined;\nvar MenuMouseLeave =  true ? '__menu_mouse_leave__' : undefined;\nvar ItemMouseMove =  true ? '__item_mouse_move__' : undefined;\nvar ItemClick =  true ? '__item_click__' : undefined;\nvar ToggleButtonClick =  true ? '__togglebutton_click__' : undefined;\nvar ToggleButtonKeyDownArrowDown =  true ? '__togglebutton_keydown_arrow_down__' : undefined;\nvar ToggleButtonKeyDownArrowUp =  true ? '__togglebutton_keydown_arrow_up__' : undefined;\nvar ToggleButtonKeyDownCharacter =  true ? '__togglebutton_keydown_character__' : undefined;\nvar FunctionToggleMenu =  true ? '__function_toggle_menu__' : undefined;\nvar FunctionOpenMenu =  true ? '__function_open_menu__' : undefined;\nvar FunctionCloseMenu =  true ? '__function_close_menu__' : undefined;\nvar FunctionSetHighlightedIndex =  true ? '__function_set_highlighted_index__' : undefined;\nvar FunctionSelectItem =  true ? '__function_select_item__' : undefined;\nvar FunctionSetInputValue =  true ? '__function_set_input_value__' : undefined;\nvar FunctionReset =  true ? '__function_reset__' : undefined;\n\nvar stateChangeTypes$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  MenuKeyDownArrowDown: MenuKeyDownArrowDown,\n  MenuKeyDownArrowUp: MenuKeyDownArrowUp,\n  MenuKeyDownEscape: MenuKeyDownEscape,\n  MenuKeyDownHome: MenuKeyDownHome,\n  MenuKeyDownEnd: MenuKeyDownEnd,\n  MenuKeyDownEnter: MenuKeyDownEnter,\n  MenuKeyDownSpaceButton: MenuKeyDownSpaceButton,\n  MenuKeyDownCharacter: MenuKeyDownCharacter,\n  MenuBlur: MenuBlur,\n  MenuMouseLeave: MenuMouseLeave,\n  ItemMouseMove: ItemMouseMove,\n  ItemClick: ItemClick,\n  ToggleButtonClick: ToggleButtonClick,\n  ToggleButtonKeyDownArrowDown: ToggleButtonKeyDownArrowDown,\n  ToggleButtonKeyDownArrowUp: ToggleButtonKeyDownArrowUp,\n  ToggleButtonKeyDownCharacter: ToggleButtonKeyDownCharacter,\n  FunctionToggleMenu: FunctionToggleMenu,\n  FunctionOpenMenu: FunctionOpenMenu,\n  FunctionCloseMenu: FunctionCloseMenu,\n  FunctionSetHighlightedIndex: FunctionSetHighlightedIndex,\n  FunctionSelectItem: FunctionSelectItem,\n  FunctionSetInputValue: FunctionSetInputValue,\n  FunctionReset: FunctionReset\n});\n\n/* eslint-disable complexity */\n\nfunction downshiftSelectReducer(state, action) {\n  var type = action.type,\n      props = action.props,\n      shiftKey = action.shiftKey;\n  var changes;\n\n  switch (type) {\n    case ItemMouseMove:\n      changes = {\n        highlightedIndex: action.index\n      };\n      break;\n\n    case ItemClick:\n      changes = {\n        isOpen: getDefaultValue(props, 'isOpen'),\n        highlightedIndex: getDefaultValue(props, 'highlightedIndex'),\n        selectedItem: props.items[action.index]\n      };\n      break;\n\n    case ToggleButtonKeyDownCharacter:\n      {\n        var lowercasedKey = action.key;\n        var inputValue = \"\" + state.inputValue + lowercasedKey;\n        var itemIndex = getItemIndexByCharacterKey(inputValue, state.selectedItem ? props.items.indexOf(state.selectedItem) : -1, props.items, props.itemToString, action.getItemNodeFromIndex);\n        changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          inputValue: inputValue\n        }, itemIndex >= 0 && {\n          selectedItem: props.items[itemIndex]\n        });\n      }\n      break;\n\n    case ToggleButtonKeyDownArrowDown:\n      changes = {\n        highlightedIndex: getHighlightedIndexOnOpen(props, state, 1, action.getItemNodeFromIndex),\n        isOpen: true\n      };\n      break;\n\n    case ToggleButtonKeyDownArrowUp:\n      changes = {\n        highlightedIndex: getHighlightedIndexOnOpen(props, state, -1, action.getItemNodeFromIndex),\n        isOpen: true\n      };\n      break;\n\n    case MenuKeyDownEnter:\n    case MenuKeyDownSpaceButton:\n      changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n        isOpen: getDefaultValue(props, 'isOpen'),\n        highlightedIndex: getDefaultValue(props, 'highlightedIndex')\n      }, state.highlightedIndex >= 0 && {\n        selectedItem: props.items[state.highlightedIndex]\n      });\n      break;\n\n    case MenuKeyDownHome:\n      changes = {\n        highlightedIndex: getNextNonDisabledIndex(1, 0, props.items.length, action.getItemNodeFromIndex, false)\n      };\n      break;\n\n    case MenuKeyDownEnd:\n      changes = {\n        highlightedIndex: getNextNonDisabledIndex(-1, props.items.length - 1, props.items.length, action.getItemNodeFromIndex, false)\n      };\n      break;\n\n    case MenuKeyDownEscape:\n      changes = {\n        isOpen: false,\n        highlightedIndex: -1\n      };\n      break;\n\n    case MenuBlur:\n      changes = {\n        isOpen: false,\n        highlightedIndex: -1\n      };\n      break;\n\n    case MenuKeyDownCharacter:\n      {\n        var _lowercasedKey = action.key;\n\n        var _inputValue = \"\" + state.inputValue + _lowercasedKey;\n\n        var highlightedIndex = getItemIndexByCharacterKey(_inputValue, state.highlightedIndex, props.items, props.itemToString, action.getItemNodeFromIndex);\n        changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          inputValue: _inputValue\n        }, highlightedIndex >= 0 && {\n          highlightedIndex: highlightedIndex\n        });\n      }\n      break;\n\n    case MenuKeyDownArrowDown:\n      changes = {\n        highlightedIndex: getNextWrappingIndex(shiftKey ? 5 : 1, state.highlightedIndex, props.items.length, action.getItemNodeFromIndex, props.circularNavigation)\n      };\n      break;\n\n    case MenuKeyDownArrowUp:\n      changes = {\n        highlightedIndex: getNextWrappingIndex(shiftKey ? -5 : -1, state.highlightedIndex, props.items.length, action.getItemNodeFromIndex, props.circularNavigation)\n      };\n      break;\n\n    case MenuMouseLeave:\n      changes = {\n        highlightedIndex: -1\n      };\n      break;\n\n    case ToggleButtonClick:\n    case FunctionToggleMenu:\n      changes = {\n        isOpen: !state.isOpen,\n        highlightedIndex: state.isOpen ? -1 : getHighlightedIndexOnOpen(props, state, 0)\n      };\n      break;\n\n    case FunctionOpenMenu:\n      changes = {\n        isOpen: true,\n        highlightedIndex: getHighlightedIndexOnOpen(props, state, 0)\n      };\n      break;\n\n    case FunctionCloseMenu:\n      changes = {\n        isOpen: false\n      };\n      break;\n\n    case FunctionSetHighlightedIndex:\n      changes = {\n        highlightedIndex: action.highlightedIndex\n      };\n      break;\n\n    case FunctionSelectItem:\n      changes = {\n        selectedItem: action.selectedItem\n      };\n      break;\n\n    case FunctionSetInputValue:\n      changes = {\n        inputValue: action.inputValue\n      };\n      break;\n\n    case FunctionReset:\n      changes = {\n        highlightedIndex: getDefaultValue(props, 'highlightedIndex'),\n        isOpen: getDefaultValue(props, 'isOpen'),\n        selectedItem: getDefaultValue(props, 'selectedItem'),\n        inputValue: getDefaultValue(props, 'inputValue')\n      };\n      break;\n\n    default:\n      throw new Error('Reducer called without proper action type.');\n  }\n\n  return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state, changes);\n}\n/* eslint-enable complexity */\n\nvar validatePropTypes =  false ?\n/* istanbul ignore next */\nundefined : getPropTypesValidator(useSelect, propTypes);\nuseSelect.stateChangeTypes = stateChangeTypes$1;\n\nfunction useSelect(userProps) {\n  if (userProps === void 0) {\n    userProps = {};\n  }\n\n  /* istanbul ignore else */\n  if (true) {\n    validatePropTypes(userProps);\n  } // Props defaults and destructuring.\n\n\n  var props = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, defaultProps$1, userProps);\n\n  var items = props.items,\n      scrollIntoView = props.scrollIntoView,\n      environment = props.environment,\n      initialIsOpen = props.initialIsOpen,\n      defaultIsOpen = props.defaultIsOpen,\n      itemToString = props.itemToString,\n      getA11ySelectionMessage = props.getA11ySelectionMessage,\n      getA11yStatusMessage = props.getA11yStatusMessage; // Initial state depending on controlled props.\n\n  var initialState = getInitialState(props);\n\n  var _useControlledReducer = useControlledReducer(downshiftSelectReducer, initialState, props),\n      state = _useControlledReducer[0],\n      dispatch = _useControlledReducer[1];\n\n  var isOpen = state.isOpen,\n      highlightedIndex = state.highlightedIndex,\n      selectedItem = state.selectedItem,\n      inputValue = state.inputValue; // Element efs.\n\n  var toggleButtonRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null);\n  var menuRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null);\n  var itemRefs = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])();\n  itemRefs.current = {}; // used not to trigger menu blur action in some scenarios.\n\n  var shouldBlurRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(true); // used to keep the inputValue clearTimeout object between renders.\n\n  var clearTimeoutRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null); // prevent id re-generation between renders.\n\n  var elementIdsRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(getElementIds(props)); // used to keep track of how many items we had on previous cycle.\n\n  var previousResultCountRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])();\n  var isInitialMountRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(true); // utility callback to get item element.\n\n  var latest = useLatestRef({\n    state: state,\n    props: props\n  }); // Some utils.\n\n  var getItemNodeFromIndex = function (index) {\n    return itemRefs.current[elementIdsRef.current.getItemId(index)];\n  }; // Effects.\n  // Sets a11y status message on changes in state.\n\n\n  useA11yMessageSetter(getA11yStatusMessage, [isOpen, highlightedIndex, inputValue, items], Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n    isInitialMount: isInitialMountRef.current,\n    previousResultCount: previousResultCountRef.current,\n    items: items,\n    environment: environment,\n    itemToString: itemToString\n  }, state)); // Sets a11y status message on changes in selectedItem.\n\n  useA11yMessageSetter(getA11ySelectionMessage, [selectedItem], Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n    isInitialMount: isInitialMountRef.current,\n    previousResultCount: previousResultCountRef.current,\n    items: items,\n    environment: environment,\n    itemToString: itemToString\n  }, state)); // Scroll on highlighted item if change comes from keyboard.\n\n  var shouldScrollRef = useScrollIntoView({\n    menuElement: menuRef.current,\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    itemRefs: itemRefs,\n    scrollIntoView: scrollIntoView,\n    getItemNodeFromIndex: getItemNodeFromIndex\n  }); // Sets cleanup for the keysSoFar after 500ms.\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    // init the clean function here as we need access to dispatch.\n    if (isInitialMountRef.current) {\n      clearTimeoutRef.current = debounce(function (outerDispatch) {\n        outerDispatch({\n          type: FunctionSetInputValue,\n          inputValue: ''\n        });\n      }, 500);\n    }\n\n    if (!inputValue) {\n      return;\n    }\n\n    clearTimeoutRef.current(dispatch);\n  }, [dispatch, inputValue]);\n  useControlPropsValidator({\n    isInitialMount: isInitialMountRef.current,\n    props: props,\n    state: state\n  });\n  /* Controls the focus on the menu or the toggle button. */\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    // Don't focus menu on first render.\n    if (isInitialMountRef.current) {\n      // Unless it was initialised as open.\n      if ((initialIsOpen || defaultIsOpen || isOpen) && menuRef.current) {\n        menuRef.current.focus();\n      }\n\n      return;\n    } // Focus menu on open.\n\n\n    if (isOpen) {\n      // istanbul ignore else\n      if (menuRef.current) {\n        menuRef.current.focus();\n      }\n\n      return;\n    } // Focus toggleButton on close, but not if it was closed with (Shift+)Tab.\n\n\n    if (environment.document.activeElement === menuRef.current) {\n      // istanbul ignore else\n      if (toggleButtonRef.current) {\n        shouldBlurRef.current = false;\n        toggleButtonRef.current.focus();\n      }\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [isOpen]);\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (isInitialMountRef.current) {\n      return;\n    }\n\n    previousResultCountRef.current = items.length;\n  }); // Add mouse/touch events to document.\n\n  var mouseAndTouchTrackersRef = useMouseAndTouchTracker(isOpen, [menuRef, toggleButtonRef], environment, function () {\n    dispatch({\n      type: MenuBlur\n    });\n  });\n  var setGetterPropCallInfo = useGetterPropsCalledChecker('getMenuProps', 'getToggleButtonProps'); // Make initial ref false.\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    isInitialMountRef.current = false;\n  }, []); // Event handler functions.\n\n  var toggleButtonKeyDownHandlers = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useMemo\"])(function () {\n    return {\n      ArrowDown: function ArrowDown(event) {\n        event.preventDefault();\n        dispatch({\n          type: ToggleButtonKeyDownArrowDown,\n          getItemNodeFromIndex: getItemNodeFromIndex,\n          shiftKey: event.shiftKey\n        });\n      },\n      ArrowUp: function ArrowUp(event) {\n        event.preventDefault();\n        dispatch({\n          type: ToggleButtonKeyDownArrowUp,\n          getItemNodeFromIndex: getItemNodeFromIndex,\n          shiftKey: event.shiftKey\n        });\n      }\n    };\n  }, [dispatch]);\n  var menuKeyDownHandlers = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useMemo\"])(function () {\n    return {\n      ArrowDown: function ArrowDown(event) {\n        event.preventDefault();\n        dispatch({\n          type: MenuKeyDownArrowDown,\n          getItemNodeFromIndex: getItemNodeFromIndex,\n          shiftKey: event.shiftKey\n        });\n      },\n      ArrowUp: function ArrowUp(event) {\n        event.preventDefault();\n        dispatch({\n          type: MenuKeyDownArrowUp,\n          getItemNodeFromIndex: getItemNodeFromIndex,\n          shiftKey: event.shiftKey\n        });\n      },\n      Home: function Home(event) {\n        event.preventDefault();\n        dispatch({\n          type: MenuKeyDownHome,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      },\n      End: function End(event) {\n        event.preventDefault();\n        dispatch({\n          type: MenuKeyDownEnd,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      },\n      Escape: function Escape() {\n        dispatch({\n          type: MenuKeyDownEscape\n        });\n      },\n      Enter: function Enter(event) {\n        event.preventDefault();\n        dispatch({\n          type: MenuKeyDownEnter\n        });\n      },\n      ' ': function _(event) {\n        event.preventDefault();\n        dispatch({\n          type: MenuKeyDownSpaceButton\n        });\n      }\n    };\n  }, [dispatch]); // Action functions.\n\n  var toggleMenu = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionToggleMenu\n    });\n  }, [dispatch]);\n  var closeMenu = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionCloseMenu\n    });\n  }, [dispatch]);\n  var openMenu = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionOpenMenu\n    });\n  }, [dispatch]);\n  var setHighlightedIndex = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newHighlightedIndex) {\n    dispatch({\n      type: FunctionSetHighlightedIndex,\n      highlightedIndex: newHighlightedIndex\n    });\n  }, [dispatch]);\n  var selectItem = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newSelectedItem) {\n    dispatch({\n      type: FunctionSelectItem,\n      selectedItem: newSelectedItem\n    });\n  }, [dispatch]);\n  var reset = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionReset\n    });\n  }, [dispatch]);\n  var setInputValue = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newInputValue) {\n    dispatch({\n      type: FunctionSetInputValue,\n      inputValue: newInputValue\n    });\n  }, [dispatch]); // Getter functions.\n\n  var getLabelProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (labelProps) {\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n      id: elementIdsRef.current.labelId,\n      htmlFor: elementIdsRef.current.toggleButtonId\n    }, labelProps);\n  }, []);\n  var getMenuProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp, _temp2) {\n    var _extends2;\n\n    var _ref = _temp === void 0 ? {} : _temp,\n        onMouseLeave = _ref.onMouseLeave,\n        _ref$refKey = _ref.refKey,\n        refKey = _ref$refKey === void 0 ? 'ref' : _ref$refKey,\n        onKeyDown = _ref.onKeyDown,\n        onBlur = _ref.onBlur,\n        ref = _ref.ref,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref, [\"onMouseLeave\", \"refKey\", \"onKeyDown\", \"onBlur\", \"ref\"]);\n\n    var _ref2 = _temp2 === void 0 ? {} : _temp2,\n        _ref2$suppressRefErro = _ref2.suppressRefError,\n        suppressRefError = _ref2$suppressRefErro === void 0 ? false : _ref2$suppressRefErro;\n\n    var latestState = latest.current.state;\n    setGetterPropCallInfo('getMenuProps', suppressRefError, refKey, menuRef);\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends2 = {}, _extends2[refKey] = handleRefs(ref, function (menuNode) {\n      menuRef.current = menuNode;\n    }), _extends2.id = elementIdsRef.current.menuId, _extends2.role = 'listbox', _extends2['aria-labelledby'] = elementIdsRef.current.labelId, _extends2.tabIndex = -1, _extends2), latestState.isOpen && latestState.highlightedIndex > -1 && {\n      'aria-activedescendant': elementIdsRef.current.getItemId(latestState.highlightedIndex)\n    }, {\n      onMouseLeave: callAllEventHandlers(onMouseLeave, function menuHandleMouseLeave() {\n        dispatch({\n          type: MenuMouseLeave\n        });\n      }),\n      onKeyDown: callAllEventHandlers(onKeyDown, function menuHandleKeyDown(event) {\n        var key = normalizeArrowKey(event);\n\n        if (key && menuKeyDownHandlers[key]) {\n          menuKeyDownHandlers[key](event);\n        } else if (isAcceptedCharacterKey(key)) {\n          dispatch({\n            type: MenuKeyDownCharacter,\n            key: key,\n            getItemNodeFromIndex: getItemNodeFromIndex\n          });\n        }\n      }),\n      onBlur: callAllEventHandlers(onBlur, function menuHandleBlur() {\n        // if the blur was a result of selection, we don't trigger this action.\n        if (shouldBlurRef.current === false) {\n          shouldBlurRef.current = true;\n          return;\n        }\n\n        var shouldBlur = !mouseAndTouchTrackersRef.current.isMouseDown;\n        /* istanbul ignore else */\n\n        if (shouldBlur) {\n          dispatch({\n            type: MenuBlur\n          });\n        }\n      })\n    }, rest);\n  }, [dispatch, latest, menuKeyDownHandlers, mouseAndTouchTrackersRef, setGetterPropCallInfo]);\n  var getToggleButtonProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp3, _temp4) {\n    var _extends3;\n\n    var _ref3 = _temp3 === void 0 ? {} : _temp3,\n        onClick = _ref3.onClick,\n        onKeyDown = _ref3.onKeyDown,\n        _ref3$refKey = _ref3.refKey,\n        refKey = _ref3$refKey === void 0 ? 'ref' : _ref3$refKey,\n        ref = _ref3.ref,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref3, [\"onClick\", \"onKeyDown\", \"refKey\", \"ref\"]);\n\n    var _ref4 = _temp4 === void 0 ? {} : _temp4,\n        _ref4$suppressRefErro = _ref4.suppressRefError,\n        suppressRefError = _ref4$suppressRefErro === void 0 ? false : _ref4$suppressRefErro;\n\n    var toggleButtonHandleClick = function () {\n      dispatch({\n        type: ToggleButtonClick\n      });\n    };\n\n    var toggleButtonHandleKeyDown = function (event) {\n      var key = normalizeArrowKey(event);\n\n      if (key && toggleButtonKeyDownHandlers[key]) {\n        toggleButtonKeyDownHandlers[key](event);\n      } else if (isAcceptedCharacterKey(key)) {\n        dispatch({\n          type: ToggleButtonKeyDownCharacter,\n          key: key,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      }\n    };\n\n    var toggleProps = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends3 = {}, _extends3[refKey] = handleRefs(ref, function (toggleButtonNode) {\n      toggleButtonRef.current = toggleButtonNode;\n    }), _extends3.id = elementIdsRef.current.toggleButtonId, _extends3['aria-haspopup'] = 'listbox', _extends3['aria-expanded'] = latest.current.state.isOpen, _extends3['aria-labelledby'] = elementIdsRef.current.labelId + \" \" + elementIdsRef.current.toggleButtonId, _extends3), rest);\n\n    if (!rest.disabled) {\n      toggleProps.onClick = callAllEventHandlers(onClick, toggleButtonHandleClick);\n      toggleProps.onKeyDown = callAllEventHandlers(onKeyDown, toggleButtonHandleKeyDown);\n    }\n\n    setGetterPropCallInfo('getToggleButtonProps', suppressRefError, refKey, toggleButtonRef);\n    return toggleProps;\n  }, [dispatch, latest, toggleButtonKeyDownHandlers, setGetterPropCallInfo]);\n  var getItemProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp5) {\n    var _extends4;\n\n    var _ref5 = _temp5 === void 0 ? {} : _temp5,\n        item = _ref5.item,\n        index = _ref5.index,\n        onMouseMove = _ref5.onMouseMove,\n        onClick = _ref5.onClick,\n        _ref5$refKey = _ref5.refKey,\n        refKey = _ref5$refKey === void 0 ? 'ref' : _ref5$refKey,\n        ref = _ref5.ref,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref5, [\"item\", \"index\", \"onMouseMove\", \"onClick\", \"refKey\", \"ref\"]);\n\n    var _latest$current = latest.current,\n        latestState = _latest$current.state,\n        latestProps = _latest$current.props;\n\n    var itemHandleMouseMove = function () {\n      if (index === latestState.highlightedIndex) {\n        return;\n      }\n\n      shouldScrollRef.current = false;\n      dispatch({\n        type: ItemMouseMove,\n        index: index\n      });\n    };\n\n    var itemHandleClick = function () {\n      dispatch({\n        type: ItemClick,\n        index: index\n      });\n    };\n\n    var itemIndex = getItemIndex(index, item, latestProps.items);\n\n    if (itemIndex < 0) {\n      throw new Error('Pass either item or item index in getItemProps!');\n    }\n\n    var itemProps = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends4 = {\n      role: 'option',\n      'aria-selected': \"\" + (itemIndex === latestState.highlightedIndex),\n      id: elementIdsRef.current.getItemId(itemIndex)\n    }, _extends4[refKey] = handleRefs(ref, function (itemNode) {\n      if (itemNode) {\n        itemRefs.current[elementIdsRef.current.getItemId(itemIndex)] = itemNode;\n      }\n    }), _extends4), rest);\n\n    if (!rest.disabled) {\n      itemProps.onMouseMove = callAllEventHandlers(onMouseMove, itemHandleMouseMove);\n      itemProps.onClick = callAllEventHandlers(onClick, itemHandleClick);\n    }\n\n    return itemProps;\n  }, [dispatch, latest, shouldScrollRef]);\n  return {\n    // prop getters.\n    getToggleButtonProps: getToggleButtonProps,\n    getLabelProps: getLabelProps,\n    getMenuProps: getMenuProps,\n    getItemProps: getItemProps,\n    // actions.\n    toggleMenu: toggleMenu,\n    openMenu: openMenu,\n    closeMenu: closeMenu,\n    setHighlightedIndex: setHighlightedIndex,\n    selectItem: selectItem,\n    reset: reset,\n    setInputValue: setInputValue,\n    // state.\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    selectedItem: selectedItem,\n    inputValue: inputValue\n  };\n}\n\nvar InputKeyDownArrowDown =  true ? '__input_keydown_arrow_down__' : undefined;\nvar InputKeyDownArrowUp =  true ? '__input_keydown_arrow_up__' : undefined;\nvar InputKeyDownEscape =  true ? '__input_keydown_escape__' : undefined;\nvar InputKeyDownHome =  true ? '__input_keydown_home__' : undefined;\nvar InputKeyDownEnd =  true ? '__input_keydown_end__' : undefined;\nvar InputKeyDownEnter =  true ? '__input_keydown_enter__' : undefined;\nvar InputChange =  true ? '__input_change__' : undefined;\nvar InputBlur =  true ? '__input_blur__' : undefined;\nvar MenuMouseLeave$1 =  true ? '__menu_mouse_leave__' : undefined;\nvar ItemMouseMove$1 =  true ? '__item_mouse_move__' : undefined;\nvar ItemClick$1 =  true ? '__item_click__' : undefined;\nvar ToggleButtonClick$1 =  true ? '__togglebutton_click__' : undefined;\nvar FunctionToggleMenu$1 =  true ? '__function_toggle_menu__' : undefined;\nvar FunctionOpenMenu$1 =  true ? '__function_open_menu__' : undefined;\nvar FunctionCloseMenu$1 =  true ? '__function_close_menu__' : undefined;\nvar FunctionSetHighlightedIndex$1 =  true ? '__function_set_highlighted_index__' : undefined;\nvar FunctionSelectItem$1 =  true ? '__function_select_item__' : undefined;\nvar FunctionSetInputValue$1 =  true ? '__function_set_input_value__' : undefined;\nvar FunctionReset$1 =  true ? '__function_reset__' : undefined;\nvar ControlledPropUpdatedSelectedItem =  true ? '__controlled_prop_updated_selected_item__' : undefined;\n\nvar stateChangeTypes$2 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  InputKeyDownArrowDown: InputKeyDownArrowDown,\n  InputKeyDownArrowUp: InputKeyDownArrowUp,\n  InputKeyDownEscape: InputKeyDownEscape,\n  InputKeyDownHome: InputKeyDownHome,\n  InputKeyDownEnd: InputKeyDownEnd,\n  InputKeyDownEnter: InputKeyDownEnter,\n  InputChange: InputChange,\n  InputBlur: InputBlur,\n  MenuMouseLeave: MenuMouseLeave$1,\n  ItemMouseMove: ItemMouseMove$1,\n  ItemClick: ItemClick$1,\n  ToggleButtonClick: ToggleButtonClick$1,\n  FunctionToggleMenu: FunctionToggleMenu$1,\n  FunctionOpenMenu: FunctionOpenMenu$1,\n  FunctionCloseMenu: FunctionCloseMenu$1,\n  FunctionSetHighlightedIndex: FunctionSetHighlightedIndex$1,\n  FunctionSelectItem: FunctionSelectItem$1,\n  FunctionSetInputValue: FunctionSetInputValue$1,\n  FunctionReset: FunctionReset$1,\n  ControlledPropUpdatedSelectedItem: ControlledPropUpdatedSelectedItem\n});\n\nfunction getElementIds$1(_ref) {\n  var id = _ref.id,\n      inputId = _ref.inputId,\n      rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref, [\"id\", \"inputId\"]);\n\n  var uniqueId = id === undefined ? \"downshift-\" + generateId() : id;\n  return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n    inputId: inputId || uniqueId + \"-input\"\n  }, getElementIds(Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n    id: id\n  }, rest)));\n}\nfunction getInitialState$1(props) {\n  var initialState = getInitialState(props);\n  var selectedItem = initialState.selectedItem;\n  var inputValue = initialState.inputValue;\n\n  if (inputValue === '' && selectedItem && props.defaultInputValue === undefined && props.initialInputValue === undefined && props.inputValue === undefined) {\n    inputValue = props.itemToString(selectedItem);\n  }\n\n  return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, initialState, {\n    inputValue: inputValue\n  });\n}\nvar propTypes$1 = {\n  items: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.array.isRequired,\n  itemToString: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  getA11yStatusMessage: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  getA11ySelectionMessage: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  circularNavigation: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  highlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  defaultHighlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  initialHighlightedIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  isOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  defaultIsOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  initialIsOpen: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.bool,\n  selectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  initialSelectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  defaultSelectedItem: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n  inputValue: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  defaultInputValue: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  initialInputValue: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  id: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  labelId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  menuId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  getItemId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  inputId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  toggleButtonId: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  stateReducer: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onSelectedItemChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onHighlightedIndexChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onStateChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onIsOpenChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onInputValueChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  environment: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n    addEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    removeEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    document: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n      getElementById: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n      activeElement: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n      body: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any\n    })\n  })\n};\n/**\n * The useCombobox version of useControlledReducer, which also\n * checks if the controlled prop selectedItem changed between\n * renders. If so, it will also update inputValue with its\n * string equivalent. It uses the common useEnhancedReducer to\n * compute the rest of the state.\n *\n * @param {Function} reducer Reducer function from downshift.\n * @param {Object} initialState Initial state of the hook.\n * @param {Object} props The hook props.\n * @returns {Array} An array with the state and an action dispatcher.\n */\n\nfunction useControlledReducer$1(reducer, initialState, props) {\n  var previousSelectedItemRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])();\n\n  var _useEnhancedReducer = useEnhancedReducer(reducer, initialState, props),\n      state = _useEnhancedReducer[0],\n      dispatch = _useEnhancedReducer[1]; // ToDo: if needed, make same approach as selectedItemChanged from Downshift.\n\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (isControlledProp(props, 'selectedItem')) {\n      if (previousSelectedItemRef.current !== props.selectedItem) {\n        dispatch({\n          type: ControlledPropUpdatedSelectedItem,\n          inputValue: props.itemToString(props.selectedItem)\n        });\n      }\n\n      previousSelectedItemRef.current = state.selectedItem === previousSelectedItemRef.current ? props.selectedItem : state.selectedItem;\n    }\n  });\n  return [getState(state, props), dispatch];\n}\nvar defaultProps$2 = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, defaultProps, {\n  getA11yStatusMessage: getA11yStatusMessage,\n  circularNavigation: true\n});\n\n/* eslint-disable complexity */\n\nfunction downshiftUseComboboxReducer(state, action) {\n  var type = action.type,\n      props = action.props,\n      shiftKey = action.shiftKey;\n  var changes;\n\n  switch (type) {\n    case ItemMouseMove$1:\n      changes = {\n        highlightedIndex: action.index\n      };\n      break;\n\n    case ItemClick$1:\n      changes = {\n        isOpen: getDefaultValue(props, 'isOpen'),\n        highlightedIndex: getDefaultValue(props, 'highlightedIndex'),\n        selectedItem: props.items[action.index],\n        inputValue: props.itemToString(props.items[action.index])\n      };\n      break;\n\n    case InputKeyDownArrowDown:\n      if (state.isOpen) {\n        changes = {\n          highlightedIndex: getNextWrappingIndex(shiftKey ? 5 : 1, state.highlightedIndex, props.items.length, action.getItemNodeFromIndex, props.circularNavigation)\n        };\n      } else {\n        changes = {\n          highlightedIndex: getHighlightedIndexOnOpen(props, state, 1, action.getItemNodeFromIndex),\n          isOpen: true\n        };\n      }\n\n      break;\n\n    case InputKeyDownArrowUp:\n      if (state.isOpen) {\n        changes = {\n          highlightedIndex: getNextWrappingIndex(shiftKey ? -5 : -1, state.highlightedIndex, props.items.length, action.getItemNodeFromIndex, props.circularNavigation)\n        };\n      } else {\n        changes = {\n          highlightedIndex: getHighlightedIndexOnOpen(props, state, -1, action.getItemNodeFromIndex),\n          isOpen: true\n        };\n      }\n\n      break;\n\n    case InputKeyDownEnter:\n      changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state.isOpen && state.highlightedIndex >= 0 && {\n        selectedItem: props.items[state.highlightedIndex],\n        isOpen: getDefaultValue(props, 'isOpen'),\n        highlightedIndex: getDefaultValue(props, 'highlightedIndex'),\n        inputValue: props.itemToString(props.items[state.highlightedIndex])\n      });\n      break;\n\n    case InputKeyDownEscape:\n      changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n        isOpen: false,\n        highlightedIndex: -1\n      }, !state.isOpen && {\n        selectedItem: null,\n        inputValue: ''\n      });\n      break;\n\n    case InputKeyDownHome:\n      changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state.isOpen && {\n        highlightedIndex: getNextNonDisabledIndex(1, 0, props.items.length, action.getItemNodeFromIndex, false)\n      });\n      break;\n\n    case InputKeyDownEnd:\n      changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state.isOpen && {\n        highlightedIndex: getNextNonDisabledIndex(-1, props.items.length - 1, props.items.length, action.getItemNodeFromIndex, false)\n      });\n      break;\n\n    case InputBlur:\n      if (state.isOpen) {\n        changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          isOpen: false,\n          highlightedIndex: -1\n        }, state.highlightedIndex >= 0 && action.selectItem && {\n          selectedItem: props.items[state.highlightedIndex],\n          inputValue: props.itemToString(props.items[state.highlightedIndex])\n        });\n      }\n\n      break;\n\n    case InputChange:\n      changes = {\n        isOpen: true,\n        highlightedIndex: getDefaultValue(props, 'highlightedIndex'),\n        inputValue: action.inputValue\n      };\n      break;\n\n    case MenuMouseLeave$1:\n      changes = {\n        highlightedIndex: -1\n      };\n      break;\n\n    case ToggleButtonClick$1:\n    case FunctionToggleMenu$1:\n      changes = {\n        isOpen: !state.isOpen,\n        highlightedIndex: state.isOpen ? -1 : getHighlightedIndexOnOpen(props, state, 0)\n      };\n      break;\n\n    case FunctionOpenMenu$1:\n      changes = {\n        isOpen: true,\n        highlightedIndex: getHighlightedIndexOnOpen(props, state, 0)\n      };\n      break;\n\n    case FunctionCloseMenu$1:\n      changes = {\n        isOpen: false\n      };\n      break;\n\n    case FunctionSetHighlightedIndex$1:\n      changes = {\n        highlightedIndex: action.highlightedIndex\n      };\n      break;\n\n    case FunctionSelectItem$1:\n      changes = {\n        selectedItem: action.selectedItem,\n        inputValue: props.itemToString(action.selectedItem)\n      };\n      break;\n\n    case ControlledPropUpdatedSelectedItem:\n    case FunctionSetInputValue$1:\n      changes = {\n        inputValue: action.inputValue\n      };\n      break;\n\n    case FunctionReset$1:\n      changes = {\n        highlightedIndex: getDefaultValue(props, 'highlightedIndex'),\n        isOpen: getDefaultValue(props, 'isOpen'),\n        selectedItem: getDefaultValue(props, 'selectedItem'),\n        inputValue: getDefaultValue(props, 'inputValue')\n      };\n      break;\n\n    default:\n      throw new Error('Reducer called without proper action type.');\n  }\n\n  return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state, changes);\n}\n/* eslint-enable complexity */\n\nvar validatePropTypes$1 =  false ?\n/* istanbul ignore next */\nundefined : getPropTypesValidator(useCombobox, propTypes$1);\nuseCombobox.stateChangeTypes = stateChangeTypes$2;\n\nfunction useCombobox(userProps) {\n  if (userProps === void 0) {\n    userProps = {};\n  }\n\n  /* istanbul ignore else */\n  if (true) {\n    validatePropTypes$1(userProps);\n  } // Props defaults and destructuring.\n\n\n  var props = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, defaultProps$2, userProps);\n\n  var initialIsOpen = props.initialIsOpen,\n      defaultIsOpen = props.defaultIsOpen,\n      items = props.items,\n      scrollIntoView = props.scrollIntoView,\n      environment = props.environment,\n      getA11yStatusMessage = props.getA11yStatusMessage,\n      getA11ySelectionMessage = props.getA11ySelectionMessage,\n      itemToString = props.itemToString; // Initial state depending on controlled props.\n\n  var initialState = getInitialState$1(props);\n\n  var _useControlledReducer = useControlledReducer$1(downshiftUseComboboxReducer, initialState, props),\n      state = _useControlledReducer[0],\n      dispatch = _useControlledReducer[1];\n\n  var isOpen = state.isOpen,\n      highlightedIndex = state.highlightedIndex,\n      selectedItem = state.selectedItem,\n      inputValue = state.inputValue; // Element refs.\n\n  var menuRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null);\n  var itemRefs = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])();\n  var inputRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null);\n  var toggleButtonRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null);\n  var comboboxRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null);\n  itemRefs.current = {};\n  var isInitialMountRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(true); // prevent id re-generation between renders.\n\n  var elementIdsRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(getElementIds$1(props)); // used to keep track of how many items we had on previous cycle.\n\n  var previousResultCountRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(); // utility callback to get item element.\n\n  var latest = useLatestRef({\n    state: state,\n    props: props\n  });\n\n  var getItemNodeFromIndex = function (index) {\n    return itemRefs.current[elementIdsRef.current.getItemId(index)];\n  }; // Effects.\n  // Sets a11y status message on changes in state.\n\n\n  useA11yMessageSetter(getA11yStatusMessage, [isOpen, highlightedIndex, inputValue, items], Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n    isInitialMount: isInitialMountRef.current,\n    previousResultCount: previousResultCountRef.current,\n    items: items,\n    environment: environment,\n    itemToString: itemToString\n  }, state)); // Sets a11y status message on changes in selectedItem.\n\n  useA11yMessageSetter(getA11ySelectionMessage, [selectedItem], Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n    isInitialMount: isInitialMountRef.current,\n    previousResultCount: previousResultCountRef.current,\n    items: items,\n    environment: environment,\n    itemToString: itemToString\n  }, state)); // Scroll on highlighted item if change comes from keyboard.\n\n  var shouldScrollRef = useScrollIntoView({\n    menuElement: menuRef.current,\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    itemRefs: itemRefs,\n    scrollIntoView: scrollIntoView,\n    getItemNodeFromIndex: getItemNodeFromIndex\n  });\n  useControlPropsValidator({\n    isInitialMount: isInitialMountRef.current,\n    props: props,\n    state: state\n  }); // Controls the focus on the input on open.\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    // Don't focus menu on first render.\n    if (isInitialMountRef.current) {\n      // Unless it was initialised as open.\n      if (initialIsOpen || defaultIsOpen || isOpen) {\n        if (inputRef.current) {\n          inputRef.current.focus();\n        }\n      }\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [isOpen]);\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (isInitialMountRef.current) {\n      return;\n    }\n\n    previousResultCountRef.current = items.length;\n  }); // Add mouse/touch events to document.\n\n  var mouseAndTouchTrackersRef = useMouseAndTouchTracker(isOpen, [comboboxRef, menuRef, toggleButtonRef], environment, function () {\n    dispatch({\n      type: InputBlur,\n      selectItem: false\n    });\n  });\n  var setGetterPropCallInfo = useGetterPropsCalledChecker('getInputProps', 'getComboboxProps', 'getMenuProps'); // Make initial ref false.\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    isInitialMountRef.current = false;\n  }, []);\n  /* Event handler functions */\n\n  var inputKeyDownHandlers = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useMemo\"])(function () {\n    return {\n      ArrowDown: function ArrowDown(event) {\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownArrowDown,\n          shiftKey: event.shiftKey,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      },\n      ArrowUp: function ArrowUp(event) {\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownArrowUp,\n          shiftKey: event.shiftKey,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      },\n      Home: function Home(event) {\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownHome,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      },\n      End: function End(event) {\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownEnd,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      },\n      Escape: function Escape() {\n        dispatch({\n          type: InputKeyDownEscape\n        });\n      },\n      Enter: function Enter(event) {\n        // if IME composing, wait for next Enter keydown event.\n        if (event.which === 229) {\n          return;\n        }\n\n        var latestState = latest.current.state;\n\n        if (latestState.isOpen) {\n          event.preventDefault();\n        }\n\n        dispatch({\n          type: InputKeyDownEnter,\n          getItemNodeFromIndex: getItemNodeFromIndex\n        });\n      }\n    };\n  }, [dispatch, latest]); // Getter props.\n\n  var getLabelProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (labelProps) {\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n      id: elementIdsRef.current.labelId,\n      htmlFor: elementIdsRef.current.inputId\n    }, labelProps);\n  }, []);\n  var getMenuProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp, _temp2) {\n    var _extends2;\n\n    var _ref = _temp === void 0 ? {} : _temp,\n        onMouseLeave = _ref.onMouseLeave,\n        _ref$refKey = _ref.refKey,\n        refKey = _ref$refKey === void 0 ? 'ref' : _ref$refKey,\n        ref = _ref.ref,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref, [\"onMouseLeave\", \"refKey\", \"ref\"]);\n\n    var _ref2 = _temp2 === void 0 ? {} : _temp2,\n        _ref2$suppressRefErro = _ref2.suppressRefError,\n        suppressRefError = _ref2$suppressRefErro === void 0 ? false : _ref2$suppressRefErro;\n\n    setGetterPropCallInfo('getMenuProps', suppressRefError, refKey, menuRef);\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends2 = {}, _extends2[refKey] = handleRefs(ref, function (menuNode) {\n      menuRef.current = menuNode;\n    }), _extends2.id = elementIdsRef.current.menuId, _extends2.role = 'listbox', _extends2['aria-labelledby'] = elementIdsRef.current.labelId, _extends2.onMouseLeave = callAllEventHandlers(onMouseLeave, function () {\n      dispatch({\n        type: MenuMouseLeave$1\n      });\n    }), _extends2), rest);\n  }, [dispatch, setGetterPropCallInfo]);\n  var getItemProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp3) {\n    var _extends3, _ref4;\n\n    var _ref3 = _temp3 === void 0 ? {} : _temp3,\n        item = _ref3.item,\n        index = _ref3.index,\n        _ref3$refKey = _ref3.refKey,\n        refKey = _ref3$refKey === void 0 ? 'ref' : _ref3$refKey,\n        ref = _ref3.ref,\n        onMouseMove = _ref3.onMouseMove,\n        onClick = _ref3.onClick,\n        onPress = _ref3.onPress,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref3, [\"item\", \"index\", \"refKey\", \"ref\", \"onMouseMove\", \"onClick\", \"onPress\"]);\n\n    var _latest$current = latest.current,\n        latestProps = _latest$current.props,\n        latestState = _latest$current.state;\n    var itemIndex = getItemIndex(index, item, latestProps.items);\n\n    if (itemIndex < 0) {\n      throw new Error('Pass either item or item index in getItemProps!');\n    }\n\n    var onSelectKey = 'onClick';\n    var customClickHandler = onClick;\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends3 = {}, _extends3[refKey] = handleRefs(ref, function (itemNode) {\n      if (itemNode) {\n        itemRefs.current[elementIdsRef.current.getItemId(itemIndex)] = itemNode;\n      }\n    }), _extends3.role = 'option', _extends3['aria-selected'] = \"\" + (itemIndex === latestState.highlightedIndex), _extends3.id = elementIdsRef.current.getItemId(itemIndex), _extends3), !rest.disabled && (_ref4 = {\n      onMouseMove: callAllEventHandlers(onMouseMove, function itemHandleMouseMove() {\n        if (index === latestState.highlightedIndex) {\n          return;\n        }\n\n        shouldScrollRef.current = false;\n        dispatch({\n          type: ItemMouseMove$1,\n          index: index\n        });\n      })\n    }, _ref4[onSelectKey] = callAllEventHandlers(customClickHandler, function itemHandleClick() {\n      dispatch({\n        type: ItemClick$1,\n        index: index\n      });\n\n      if (inputRef.current) {\n        inputRef.current.focus();\n      }\n    }), _ref4), rest);\n  }, [dispatch, latest, shouldScrollRef]);\n  var getToggleButtonProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp4) {\n    var _extends4;\n\n    var _ref5 = _temp4 === void 0 ? {} : _temp4,\n        onClick = _ref5.onClick,\n        onPress = _ref5.onPress,\n        _ref5$refKey = _ref5.refKey,\n        refKey = _ref5$refKey === void 0 ? 'ref' : _ref5$refKey,\n        ref = _ref5.ref,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref5, [\"onClick\", \"onPress\", \"refKey\", \"ref\"]);\n\n    var toggleButtonHandleClick = function () {\n      dispatch({\n        type: ToggleButtonClick$1\n      });\n\n      if (!latest.current.state.isOpen && inputRef.current) {\n        inputRef.current.focus();\n      }\n    };\n\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends4 = {}, _extends4[refKey] = handleRefs(ref, function (toggleButtonNode) {\n      toggleButtonRef.current = toggleButtonNode;\n    }), _extends4.id = elementIdsRef.current.toggleButtonId, _extends4.tabIndex = -1, _extends4), !rest.disabled && Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, {\n      onClick: callAllEventHandlers(onClick, toggleButtonHandleClick)\n    }), rest);\n  }, [dispatch, latest]);\n  var getInputProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp5, _temp6) {\n    var _extends5;\n\n    var _ref6 = _temp5 === void 0 ? {} : _temp5,\n        onKeyDown = _ref6.onKeyDown,\n        onChange = _ref6.onChange,\n        onInput = _ref6.onInput,\n        onBlur = _ref6.onBlur,\n        onChangeText = _ref6.onChangeText,\n        _ref6$refKey = _ref6.refKey,\n        refKey = _ref6$refKey === void 0 ? 'ref' : _ref6$refKey,\n        ref = _ref6.ref,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref6, [\"onKeyDown\", \"onChange\", \"onInput\", \"onBlur\", \"onChangeText\", \"refKey\", \"ref\"]);\n\n    var _ref7 = _temp6 === void 0 ? {} : _temp6,\n        _ref7$suppressRefErro = _ref7.suppressRefError,\n        suppressRefError = _ref7$suppressRefErro === void 0 ? false : _ref7$suppressRefErro;\n\n    setGetterPropCallInfo('getInputProps', suppressRefError, refKey, inputRef);\n    var latestState = latest.current.state;\n\n    var inputHandleKeyDown = function (event) {\n      var key = normalizeArrowKey(event);\n\n      if (key && inputKeyDownHandlers[key]) {\n        inputKeyDownHandlers[key](event);\n      }\n    };\n\n    var inputHandleChange = function (event) {\n      dispatch({\n        type: InputChange,\n        inputValue: event.target.value\n      });\n    };\n\n    var inputHandleBlur = function () {\n      /* istanbul ignore else */\n      if (!mouseAndTouchTrackersRef.current.isMouseDown) {\n        dispatch({\n          type: InputBlur,\n          selectItem: true\n        });\n      }\n    };\n    /* istanbul ignore next (preact) */\n\n\n    var onChangeKey = 'onChange';\n    var eventHandlers = {};\n\n    if (!rest.disabled) {\n      var _eventHandlers;\n\n      eventHandlers = (_eventHandlers = {}, _eventHandlers[onChangeKey] = callAllEventHandlers(onChange, onInput, inputHandleChange), _eventHandlers.onKeyDown = callAllEventHandlers(onKeyDown, inputHandleKeyDown), _eventHandlers.onBlur = callAllEventHandlers(onBlur, inputHandleBlur), _eventHandlers);\n    }\n    /* istanbul ignore if (react-native) */\n\n\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends5 = {}, _extends5[refKey] = handleRefs(ref, function (inputNode) {\n      inputRef.current = inputNode;\n    }), _extends5.id = elementIdsRef.current.inputId, _extends5['aria-autocomplete'] = 'list', _extends5['aria-controls'] = elementIdsRef.current.menuId, _extends5), latestState.isOpen && latestState.highlightedIndex > -1 && {\n      'aria-activedescendant': elementIdsRef.current.getItemId(latestState.highlightedIndex)\n    }, {\n      'aria-labelledby': elementIdsRef.current.labelId,\n      // https://developer.mozilla.org/en-US/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion\n      // revert back since autocomplete=\"nope\" is ignored on latest Chrome and Opera\n      autoComplete: 'off',\n      value: latestState.inputValue\n    }, eventHandlers, rest);\n  }, [dispatch, inputKeyDownHandlers, latest, mouseAndTouchTrackersRef, setGetterPropCallInfo]);\n  var getComboboxProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp7, _temp8) {\n    var _extends6;\n\n    var _ref8 = _temp7 === void 0 ? {} : _temp7,\n        _ref8$refKey = _ref8.refKey,\n        refKey = _ref8$refKey === void 0 ? 'ref' : _ref8$refKey,\n        ref = _ref8.ref,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref8, [\"refKey\", \"ref\"]);\n\n    var _ref9 = _temp8 === void 0 ? {} : _temp8,\n        _ref9$suppressRefErro = _ref9.suppressRefError,\n        suppressRefError = _ref9$suppressRefErro === void 0 ? false : _ref9$suppressRefErro;\n\n    setGetterPropCallInfo('getComboboxProps', suppressRefError, refKey, comboboxRef);\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends6 = {}, _extends6[refKey] = handleRefs(ref, function (comboboxNode) {\n      comboboxRef.current = comboboxNode;\n    }), _extends6.role = 'combobox', _extends6['aria-haspopup'] = 'listbox', _extends6['aria-owns'] = elementIdsRef.current.menuId, _extends6['aria-expanded'] = latest.current.state.isOpen, _extends6), rest);\n  }, [latest, setGetterPropCallInfo]); // returns\n\n  var toggleMenu = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionToggleMenu$1\n    });\n  }, [dispatch]);\n  var closeMenu = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionCloseMenu$1\n    });\n  }, [dispatch]);\n  var openMenu = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionOpenMenu$1\n    });\n  }, [dispatch]);\n  var setHighlightedIndex = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newHighlightedIndex) {\n    dispatch({\n      type: FunctionSetHighlightedIndex$1,\n      highlightedIndex: newHighlightedIndex\n    });\n  }, [dispatch]);\n  var selectItem = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newSelectedItem) {\n    dispatch({\n      type: FunctionSelectItem$1,\n      selectedItem: newSelectedItem\n    });\n  }, [dispatch]);\n  var setInputValue = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newInputValue) {\n    dispatch({\n      type: FunctionSetInputValue$1,\n      inputValue: newInputValue\n    });\n  }, [dispatch]);\n  var reset = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionReset$1\n    });\n  }, [dispatch]);\n  return {\n    // prop getters.\n    getItemProps: getItemProps,\n    getLabelProps: getLabelProps,\n    getMenuProps: getMenuProps,\n    getInputProps: getInputProps,\n    getComboboxProps: getComboboxProps,\n    getToggleButtonProps: getToggleButtonProps,\n    // actions.\n    toggleMenu: toggleMenu,\n    openMenu: openMenu,\n    closeMenu: closeMenu,\n    setHighlightedIndex: setHighlightedIndex,\n    setInputValue: setInputValue,\n    selectItem: selectItem,\n    reset: reset,\n    // state.\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    selectedItem: selectedItem,\n    inputValue: inputValue\n  };\n}\n\nvar defaultStateValues = {\n  activeIndex: -1,\n  selectedItems: []\n};\n/**\n * Returns the initial value for a state key in the following order:\n * 1. controlled prop, 2. initial prop, 3. default prop, 4. default\n * value from Downshift.\n *\n * @param {Object} props Props passed to the hook.\n * @param {string} propKey Props key to generate the value for.\n * @returns {any} The initial value for that prop.\n */\n\nfunction getInitialValue$1(props, propKey) {\n  return getInitialValue(props, propKey, defaultStateValues);\n}\n/**\n * Returns the default value for a state key in the following order:\n * 1. controlled prop, 2. default prop, 3. default value from Downshift.\n *\n * @param {Object} props Props passed to the hook.\n * @param {string} propKey Props key to generate the value for.\n * @returns {any} The initial value for that prop.\n */\n\n\nfunction getDefaultValue$1(props, propKey) {\n  return getDefaultValue(props, propKey, defaultStateValues);\n}\n/**\n * Gets the initial state based on the provided props. It uses initial, default\n * and controlled props related to state in order to compute the initial value.\n *\n * @param {Object} props Props passed to the hook.\n * @returns {Object} The initial state.\n */\n\nfunction getInitialState$2(props) {\n  var activeIndex = getInitialValue$1(props, 'activeIndex');\n  var selectedItems = getInitialValue$1(props, 'selectedItems');\n  return {\n    activeIndex: activeIndex,\n    selectedItems: selectedItems\n  };\n}\n/**\n * Returns true if dropdown keydown operation is permitted. Should not be\n * allowed on keydown with modifier keys (ctrl, alt, shift, meta), on\n * input element with text content that is either highlighted or selection\n * cursor is not at the starting position.\n *\n * @param {KeyboardEvent} event The event from keydown.\n * @returns {boolean} Whether the operation is allowed.\n */\n\nfunction isKeyDownOperationPermitted(event) {\n  if (event.shiftKey || event.metaKey || event.ctrlKey || event.altKey) {\n    return false;\n  }\n\n  var element = event.target;\n\n  if (element instanceof HTMLInputElement && // if element is a text input\n  element.value !== '' && ( // and we have text in it\n  // and cursor is either not at the start or is currently highlighting text.\n  element.selectionStart !== 0 || element.selectionEnd !== 0)) {\n    return false;\n  }\n\n  return true;\n}\n/**\n * Returns a message to be added to aria-live region when item is removed.\n *\n * @param {Object} selectionParameters Parameters required to build the message.\n * @returns {string} The a11y message.\n */\n\nfunction getA11yRemovalMessage(selectionParameters) {\n  var removedSelectedItem = selectionParameters.removedSelectedItem,\n      itemToStringLocal = selectionParameters.itemToString;\n  return itemToStringLocal(removedSelectedItem) + \" has been removed.\";\n}\n\nvar propTypes$2 = {\n  selectedItems: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.array,\n  initialSelectedItems: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.array,\n  defaultSelectedItems: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.array,\n  itemToString: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  getA11yRemovalMessage: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  stateReducer: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  activeIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  initialActiveIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  defaultActiveIndex: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.number,\n  onActiveIndexChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  onSelectedItemsChange: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n  keyNavigationNext: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  keyNavigationPrevious: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.string,\n  environment: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n    addEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    removeEventListener: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n    document: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.shape({\n      getElementById: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.func,\n      activeElement: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any,\n      body: prop_types__WEBPACK_IMPORTED_MODULE_4___default.a.any\n    })\n  })\n};\nvar defaultProps$3 = {\n  itemToString: defaultProps.itemToString,\n  stateReducer: defaultProps.stateReducer,\n  environment: defaultProps.environment,\n  getA11yRemovalMessage: getA11yRemovalMessage,\n  keyNavigationNext: 'ArrowRight',\n  keyNavigationPrevious: 'ArrowLeft'\n};\n\nvar SelectedItemClick =  true ? '__selected_item_click__' : undefined;\nvar SelectedItemKeyDownDelete =  true ? '__selected_item_keydown_delete__' : undefined;\nvar SelectedItemKeyDownBackspace =  true ? '__selected_item_keydown_backspace__' : undefined;\nvar SelectedItemKeyDownNavigationNext =  true ? '__selected_item_keydown_navigation_next__' : undefined;\nvar SelectedItemKeyDownNavigationPrevious =  true ? '__selected_item_keydown_navigation_previous__' : undefined;\nvar DropdownKeyDownNavigationPrevious =  true ? '__dropdown_keydown_navigation_previous__' : undefined;\nvar DropdownKeyDownBackspace =  true ? '__dropdown_keydown_backspace__' : undefined;\nvar DropdownClick =  true ? '__dropdown_click__' : undefined;\nvar FunctionAddSelectedItem =  true ? '__function_add_selected_item__' : undefined;\nvar FunctionRemoveSelectedItem =  true ? '__function_remove_selected_item__' : undefined;\nvar FunctionSetSelectedItems =  true ? '__function_set_selected_items__' : undefined;\nvar FunctionSetActiveIndex =  true ? '__function_set_active_index__' : undefined;\nvar FunctionReset$2 =  true ? '__function_reset__' : undefined;\n\nvar stateChangeTypes$3 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  SelectedItemClick: SelectedItemClick,\n  SelectedItemKeyDownDelete: SelectedItemKeyDownDelete,\n  SelectedItemKeyDownBackspace: SelectedItemKeyDownBackspace,\n  SelectedItemKeyDownNavigationNext: SelectedItemKeyDownNavigationNext,\n  SelectedItemKeyDownNavigationPrevious: SelectedItemKeyDownNavigationPrevious,\n  DropdownKeyDownNavigationPrevious: DropdownKeyDownNavigationPrevious,\n  DropdownKeyDownBackspace: DropdownKeyDownBackspace,\n  DropdownClick: DropdownClick,\n  FunctionAddSelectedItem: FunctionAddSelectedItem,\n  FunctionRemoveSelectedItem: FunctionRemoveSelectedItem,\n  FunctionSetSelectedItems: FunctionSetSelectedItems,\n  FunctionSetActiveIndex: FunctionSetActiveIndex,\n  FunctionReset: FunctionReset$2\n});\n\n/* eslint-disable complexity */\n\nfunction downshiftMultipleSelectionReducer(state, action) {\n  var type = action.type,\n      index = action.index,\n      props = action.props,\n      selectedItem = action.selectedItem;\n  var activeIndex = state.activeIndex,\n      selectedItems = state.selectedItems;\n  var changes;\n\n  switch (type) {\n    case SelectedItemClick:\n      changes = {\n        activeIndex: index\n      };\n      break;\n\n    case SelectedItemKeyDownNavigationPrevious:\n      changes = {\n        activeIndex: activeIndex - 1 < 0 ? 0 : activeIndex - 1\n      };\n      break;\n\n    case SelectedItemKeyDownNavigationNext:\n      changes = {\n        activeIndex: activeIndex + 1 >= selectedItems.length ? -1 : activeIndex + 1\n      };\n      break;\n\n    case SelectedItemKeyDownBackspace:\n    case SelectedItemKeyDownDelete:\n      {\n        var newActiveIndex = activeIndex;\n\n        if (selectedItems.length === 1) {\n          newActiveIndex = -1;\n        } else if (activeIndex === selectedItems.length - 1) {\n          newActiveIndex = selectedItems.length - 2;\n        }\n\n        changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          selectedItems: [].concat(selectedItems.slice(0, activeIndex), selectedItems.slice(activeIndex + 1))\n        }, {\n          activeIndex: newActiveIndex\n        });\n        break;\n      }\n\n    case DropdownKeyDownNavigationPrevious:\n      changes = {\n        activeIndex: selectedItems.length - 1\n      };\n      break;\n\n    case DropdownKeyDownBackspace:\n      changes = {\n        selectedItems: selectedItems.slice(0, selectedItems.length - 1)\n      };\n      break;\n\n    case FunctionAddSelectedItem:\n      changes = {\n        selectedItems: [].concat(selectedItems, [selectedItem])\n      };\n      break;\n\n    case DropdownClick:\n      changes = {\n        activeIndex: -1\n      };\n      break;\n\n    case FunctionRemoveSelectedItem:\n      {\n        var _newActiveIndex = activeIndex;\n        var selectedItemIndex = selectedItems.indexOf(selectedItem);\n\n        if (selectedItems.length === 1) {\n          _newActiveIndex = -1;\n        } else if (selectedItemIndex === selectedItems.length - 1) {\n          _newActiveIndex = selectedItems.length - 2;\n        }\n\n        changes = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n          selectedItems: [].concat(selectedItems.slice(0, selectedItemIndex), selectedItems.slice(selectedItemIndex + 1))\n        }, {\n          activeIndex: _newActiveIndex\n        });\n        break;\n      }\n\n    case FunctionSetSelectedItems:\n      {\n        var newSelectedItems = action.selectedItems;\n        changes = {\n          selectedItems: newSelectedItems\n        };\n        break;\n      }\n\n    case FunctionSetActiveIndex:\n      {\n        var _newActiveIndex2 = action.activeIndex;\n        changes = {\n          activeIndex: _newActiveIndex2\n        };\n        break;\n      }\n\n    case FunctionReset$2:\n      changes = {\n        activeIndex: getDefaultValue$1(props, 'activeIndex'),\n        selectedItems: getDefaultValue$1(props, 'selectedItems')\n      };\n      break;\n\n    default:\n      throw new Error('Reducer called without proper action type.');\n  }\n\n  return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state, changes);\n}\n\nuseMultipleSelection.stateChangeTypes = stateChangeTypes$3;\n\nfunction useMultipleSelection(userProps) {\n  if (userProps === void 0) {\n    userProps = {};\n  }\n\n  // Props defaults and destructuring.\n  var props = Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, defaultProps$3, userProps);\n\n  var getA11yRemovalMessage = props.getA11yRemovalMessage,\n      itemToString = props.itemToString,\n      environment = props.environment,\n      keyNavigationNext = props.keyNavigationNext,\n      keyNavigationPrevious = props.keyNavigationPrevious; // Reducer init.\n\n  var _useControlledReducer = useControlledReducer(downshiftMultipleSelectionReducer, getInitialState$2(props), props),\n      state = _useControlledReducer[0],\n      dispatch = _useControlledReducer[1];\n\n  var activeIndex = state.activeIndex,\n      selectedItems = state.selectedItems; // Refs.\n\n  var isInitialMountRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(true);\n  var dropdownRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(null);\n  var previousSelectedItemsRef = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])(selectedItems);\n  var selectedItemRefs = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useRef\"])();\n  selectedItemRefs.current = [];\n  var latest = useLatestRef({\n    state: state,\n    props: props\n  }); // Effects.\n\n  /* Sets a11y status message on changes in selectedItem. */\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (isInitialMountRef.current) {\n      return;\n    }\n\n    if (selectedItems.length < previousSelectedItemsRef.current.length) {\n      var removedSelectedItem = previousSelectedItemsRef.current.find(function (item) {\n        return selectedItems.indexOf(item) < 0;\n      });\n      setStatus(getA11yRemovalMessage({\n        itemToString: itemToString,\n        resultCount: selectedItems.length,\n        removedSelectedItem: removedSelectedItem,\n        activeIndex: activeIndex,\n        activeSelectedItem: selectedItems[activeIndex]\n      }), environment.document);\n    }\n\n    previousSelectedItemsRef.current = selectedItems; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedItems.length]); // Sets focus on active item.\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    if (isInitialMountRef.current) {\n      return;\n    }\n\n    if (activeIndex === -1 && dropdownRef.current) {\n      dropdownRef.current.focus();\n    } else if (selectedItemRefs.current[activeIndex]) {\n      selectedItemRefs.current[activeIndex].focus();\n    }\n  }, [activeIndex]);\n  useControlPropsValidator({\n    isInitialMount: isInitialMountRef.current,\n    props: props,\n    state: state\n  });\n  var setGetterPropCallInfo = useGetterPropsCalledChecker('getDropdownProps'); // Make initial ref false.\n\n  Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useEffect\"])(function () {\n    isInitialMountRef.current = false;\n  }, []); // Event handler functions.\n\n  var selectedItemKeyDownHandlers = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useMemo\"])(function () {\n    var _ref;\n\n    return _ref = {}, _ref[keyNavigationPrevious] = function () {\n      dispatch({\n        type: SelectedItemKeyDownNavigationPrevious\n      });\n    }, _ref[keyNavigationNext] = function () {\n      dispatch({\n        type: SelectedItemKeyDownNavigationNext\n      });\n    }, _ref.Delete = function Delete() {\n      dispatch({\n        type: SelectedItemKeyDownDelete\n      });\n    }, _ref.Backspace = function Backspace() {\n      dispatch({\n        type: SelectedItemKeyDownBackspace\n      });\n    }, _ref;\n  }, [dispatch, keyNavigationNext, keyNavigationPrevious]);\n  var dropdownKeyDownHandlers = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useMemo\"])(function () {\n    var _ref2;\n\n    return _ref2 = {}, _ref2[keyNavigationPrevious] = function (event) {\n      if (isKeyDownOperationPermitted(event)) {\n        dispatch({\n          type: DropdownKeyDownNavigationPrevious\n        });\n      }\n    }, _ref2.Backspace = function Backspace(event) {\n      if (isKeyDownOperationPermitted(event)) {\n        dispatch({\n          type: DropdownKeyDownBackspace\n        });\n      }\n    }, _ref2;\n  }, [dispatch, keyNavigationPrevious]); // Getter props.\n\n  var getSelectedItemProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp) {\n    var _extends2;\n\n    var _ref3 = _temp === void 0 ? {} : _temp,\n        _ref3$refKey = _ref3.refKey,\n        refKey = _ref3$refKey === void 0 ? 'ref' : _ref3$refKey,\n        ref = _ref3.ref,\n        onClick = _ref3.onClick,\n        onKeyDown = _ref3.onKeyDown,\n        selectedItem = _ref3.selectedItem,\n        index = _ref3.index,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref3, [\"refKey\", \"ref\", \"onClick\", \"onKeyDown\", \"selectedItem\", \"index\"]);\n\n    var latestState = latest.current.state;\n    var itemIndex = getItemIndex(index, selectedItem, latestState.selectedItems);\n\n    if (itemIndex < 0) {\n      throw new Error('Pass either selectedItem or index in getSelectedItemProps!');\n    }\n\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends2 = {}, _extends2[refKey] = handleRefs(ref, function (selectedItemNode) {\n      if (selectedItemNode) {\n        selectedItemRefs.current.push(selectedItemNode);\n      }\n    }), _extends2.tabIndex = index === latestState.activeIndex ? 0 : -1, _extends2.onClick = callAllEventHandlers(onClick, function selectedItemHandleClick() {\n      dispatch({\n        type: SelectedItemClick,\n        index: index\n      });\n    }), _extends2.onKeyDown = callAllEventHandlers(onKeyDown, function selectedItemHandleKeyDown(event) {\n      var key = normalizeArrowKey(event);\n\n      if (key && selectedItemKeyDownHandlers[key]) {\n        selectedItemKeyDownHandlers[key](event);\n      }\n    }), _extends2), rest);\n  }, [dispatch, latest, selectedItemKeyDownHandlers]);\n  var getDropdownProps = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (_temp2, _temp3) {\n    var _extends3;\n\n    var _ref4 = _temp2 === void 0 ? {} : _temp2,\n        _ref4$refKey = _ref4.refKey,\n        refKey = _ref4$refKey === void 0 ? 'ref' : _ref4$refKey,\n        ref = _ref4.ref,\n        onKeyDown = _ref4.onKeyDown,\n        onClick = _ref4.onClick,\n        _ref4$preventKeyActio = _ref4.preventKeyAction,\n        preventKeyAction = _ref4$preventKeyActio === void 0 ? false : _ref4$preventKeyActio,\n        rest = Object(_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref4, [\"refKey\", \"ref\", \"onKeyDown\", \"onClick\", \"preventKeyAction\"]);\n\n    var _ref5 = _temp3 === void 0 ? {} : _temp3,\n        _ref5$suppressRefErro = _ref5.suppressRefError,\n        suppressRefError = _ref5$suppressRefErro === void 0 ? false : _ref5$suppressRefErro;\n\n    setGetterPropCallInfo('getDropdownProps', suppressRefError, refKey, dropdownRef);\n    return Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])((_extends3 = {}, _extends3[refKey] = handleRefs(ref, function (dropdownNode) {\n      if (dropdownNode) {\n        dropdownRef.current = dropdownNode;\n      }\n    }), _extends3), !preventKeyAction && {\n      onKeyDown: callAllEventHandlers(onKeyDown, function dropdownHandleKeyDown(event) {\n        var key = normalizeArrowKey(event);\n\n        if (key && dropdownKeyDownHandlers[key]) {\n          dropdownKeyDownHandlers[key](event);\n        }\n      }),\n      onClick: callAllEventHandlers(onClick, function dropdownHandleClick() {\n        dispatch({\n          type: DropdownClick\n        });\n      })\n    }, rest);\n  }, [dispatch, dropdownKeyDownHandlers, setGetterPropCallInfo]); // returns\n\n  var addSelectedItem = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (selectedItem) {\n    dispatch({\n      type: FunctionAddSelectedItem,\n      selectedItem: selectedItem\n    });\n  }, [dispatch]);\n  var removeSelectedItem = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (selectedItem) {\n    dispatch({\n      type: FunctionRemoveSelectedItem,\n      selectedItem: selectedItem\n    });\n  }, [dispatch]);\n  var setSelectedItems = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newSelectedItems) {\n    dispatch({\n      type: FunctionSetSelectedItems,\n      selectedItems: newSelectedItems\n    });\n  }, [dispatch]);\n  var setActiveIndex = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function (newActiveIndex) {\n    dispatch({\n      type: FunctionSetActiveIndex,\n      activeIndex: newActiveIndex\n    });\n  }, [dispatch]);\n  var reset = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useCallback\"])(function () {\n    dispatch({\n      type: FunctionReset$2\n    });\n  }, [dispatch]);\n  return {\n    getSelectedItemProps: getSelectedItemProps,\n    getDropdownProps: getDropdownProps,\n    addSelectedItem: addSelectedItem,\n    removeSelectedItem: removeSelectedItem,\n    setSelectedItems: setSelectedItems,\n    setActiveIndex: setActiveIndex,\n    reset: reset,\n    selectedItems: selectedItems,\n    activeIndex: activeIndex\n  };\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Downshift);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL2Rvd25zaGlmdC9kaXN0L2Rvd25zaGlmdC5lc20uanM/MzNjZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFvRztBQUMxQztBQUM0QjtBQUNoQjtBQUNuQztBQUNrRTtBQUM3RDtBQUNxQjs7QUFFN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCLFlBQVksU0FBUztBQUNyQjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxZQUFZO0FBQ3ZCLFdBQVcsWUFBWTtBQUN2Qjs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZ0JBQWdCLHdFQUFxQjtBQUNyQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxXQUFXLFlBQVk7QUFDdkIsV0FBVyxZQUFZO0FBQ3ZCLFlBQVksUUFBUTtBQUNwQjs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEIsV0FBVyxPQUFPO0FBQ2xCLFlBQVksU0FBUztBQUNyQjs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUVBQXVFLGFBQWE7QUFDcEY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsWUFBWTtBQUN2QixZQUFZLFNBQVM7QUFDckI7OztBQUdBO0FBQ0EsdUVBQXVFLGVBQWU7QUFDdEY7QUFDQTs7QUFFQTtBQUNBLDhGQUE4RixlQUFlO0FBQzdHO0FBQ0E7O0FBRUE7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QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFVBQVUsS0FBK0M7QUFDekQ7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxxQ0FBcUM7QUFDckM7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVUsSUFBcUM7QUFDL0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FB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O0FBRUEsV0FBVyxrRkFBUSxnQkFBZ0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCx5QkFBeUIseURBQVc7QUFDcEM7O0FBRUEsc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx1R0FBNkI7O0FBRTVDLHNDQUFzQztBQUN0QztBQUNBOztBQUVBO0FBQ0EsV0FBVyxrRkFBUSxnQkFBZ0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUcsOERBQThEOztBQUVqRSx3QkFBd0IseURBQVc7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCwyQkFBMkIseURBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCx5QkFBeUIseURBQVc7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCx1QkFBdUIseURBQVc7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCxjQUFjLHlEQUFXO0FBQ3pCO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFZSx3RUFBUyxFQUFDO0FBQytDIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2Rvd25zaGlmdC9kaXN0L2Rvd25zaGlmdC5lc20uanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZSc7XG5pbXBvcnQgX2V4dGVuZHMgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZXh0ZW5kcyc7XG5pbXBvcnQgX2Fzc2VydFRoaXNJbml0aWFsaXplZCBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQnO1xuaW1wb3J0IF9pbmhlcml0c0xvb3NlIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzTG9vc2UnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7IGNsb25lRWxlbWVudCwgQ29tcG9uZW50LCB1c2VSZWYsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2ssIHVzZVJlZHVjZXIsIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBpc0ZvcndhcmRSZWYgfSBmcm9tICdyZWFjdC1pcyc7XG5pbXBvcnQgY29tcHV0ZVNjcm9sbEludG9WaWV3IGZyb20gJ2NvbXB1dGUtc2Nyb2xsLWludG8tdmlldyc7XG5cbnZhciBpZENvdW50ZXIgPSAwO1xuLyoqXG4gKiBBY2NlcHRzIGEgcGFyYW1ldGVyIGFuZCByZXR1cm5zIGl0IGlmIGl0J3MgYSBmdW5jdGlvblxuICogb3IgYSBub29wIGZ1bmN0aW9uIGlmIGl0J3Mgbm90LiBUaGlzIGFsbG93cyB1cyB0b1xuICogYWNjZXB0IGEgY2FsbGJhY2ssIGJ1dCBub3Qgd29ycnkgYWJvdXQgaXQgaWYgaXQncyBub3RcbiAqIHBhc3NlZC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIHRoZSBjYWxsYmFja1xuICogQHJldHVybiB7RnVuY3Rpb259IGEgZnVuY3Rpb25cbiAqL1xuXG5mdW5jdGlvbiBjYlRvQ2IoY2IpIHtcbiAgcmV0dXJuIHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJyA/IGNiIDogbm9vcDtcbn1cblxuZnVuY3Rpb24gbm9vcCgpIHt9XG4vKipcbiAqIFNjcm9sbCBub2RlIGludG8gdmlldyBpZiBuZWNlc3NhcnlcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG5vZGUgdGhlIGVsZW1lbnQgdGhhdCBzaG91bGQgc2Nyb2xsIGludG8gdmlld1xuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gbWVudU5vZGUgdGhlIG1lbnUgZWxlbWVudCBvZiB0aGUgY29tcG9uZW50XG4gKi9cblxuXG5mdW5jdGlvbiBzY3JvbGxJbnRvVmlldyhub2RlLCBtZW51Tm9kZSkge1xuICBpZiAoIW5vZGUpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgYWN0aW9ucyA9IGNvbXB1dGVTY3JvbGxJbnRvVmlldyhub2RlLCB7XG4gICAgYm91bmRhcnk6IG1lbnVOb2RlLFxuICAgIGJsb2NrOiAnbmVhcmVzdCcsXG4gICAgc2Nyb2xsTW9kZTogJ2lmLW5lZWRlZCdcbiAgfSk7XG4gIGFjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoX3JlZikge1xuICAgIHZhciBlbCA9IF9yZWYuZWwsXG4gICAgICAgIHRvcCA9IF9yZWYudG9wLFxuICAgICAgICBsZWZ0ID0gX3JlZi5sZWZ0O1xuICAgIGVsLnNjcm9sbFRvcCA9IHRvcDtcbiAgICBlbC5zY3JvbGxMZWZ0ID0gbGVmdDtcbiAgfSk7XG59XG4vKipcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHBhcmVudCB0aGUgcGFyZW50IG5vZGVcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGNoaWxkIHRoZSBjaGlsZCBub2RlXG4gKiBAcmV0dXJuIHtCb29sZWFufSB3aGV0aGVyIHRoZSBwYXJlbnQgaXMgdGhlIGNoaWxkIG9yIHRoZSBjaGlsZCBpcyBpbiB0aGUgcGFyZW50XG4gKi9cblxuXG5mdW5jdGlvbiBpc09yQ29udGFpbnNOb2RlKHBhcmVudCwgY2hpbGQpIHtcbiAgcmV0dXJuIHBhcmVudCA9PT0gY2hpbGQgfHwgcGFyZW50LmNvbnRhaW5zICYmIHBhcmVudC5jb250YWlucyhjaGlsZCk7XG59XG4vKipcbiAqIFNpbXBsZSBkZWJvdW5jZSBpbXBsZW1lbnRhdGlvbi4gV2lsbCBjYWxsIHRoZSBnaXZlblxuICogZnVuY3Rpb24gb25jZSBhZnRlciB0aGUgdGltZSBnaXZlbiBoYXMgcGFzc2VkIHNpbmNlXG4gKiBpdCB3YXMgbGFzdCBjYWxsZWQuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiB0aGUgZnVuY3Rpb24gdG8gY2FsbCBhZnRlciB0aGUgdGltZVxuICogQHBhcmFtIHtOdW1iZXJ9IHRpbWUgdGhlIHRpbWUgdG8gd2FpdFxuICogQHJldHVybiB7RnVuY3Rpb259IHRoZSBkZWJvdW5jZWQgZnVuY3Rpb25cbiAqL1xuXG5cbmZ1bmN0aW9uIGRlYm91bmNlKGZuLCB0aW1lKSB7XG4gIHZhciB0aW1lb3V0SWQ7XG5cbiAgZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgIGlmICh0aW1lb3V0SWQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHdyYXBwZXIoKSB7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIGNhbmNlbCgpO1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgdGltZW91dElkID0gbnVsbDtcbiAgICAgIGZuLmFwcGx5KHZvaWQgMCwgYXJncyk7XG4gICAgfSwgdGltZSk7XG4gIH1cblxuICB3cmFwcGVyLmNhbmNlbCA9IGNhbmNlbDtcbiAgcmV0dXJuIHdyYXBwZXI7XG59XG4vKipcbiAqIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCB0byBjb21wb3NlIGV2ZW50IGhhbmRsZXJzLlxuICogVGhleSBhcmUgZXhlY3V0ZWQgaW4gb3JkZXIgdW50aWwgb25lIG9mIHRoZW0gc2V0c1xuICogYGV2ZW50LnByZXZlbnREb3duc2hpZnREZWZhdWx0ID0gdHJ1ZWAuXG4gKiBAcGFyYW0gey4uLkZ1bmN0aW9ufSBmbnMgdGhlIGV2ZW50IGhhbmRsZXIgZnVuY3Rpb25zXG4gKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGV2ZW50IGhhbmRsZXIgdG8gYWRkIHRvIGFuIGVsZW1lbnRcbiAqL1xuXG5cbmZ1bmN0aW9uIGNhbGxBbGxFdmVudEhhbmRsZXJzKCkge1xuICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGZucyA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuICAgIGZuc1tfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMyA+IDEgPyBfbGVuMyAtIDEgOiAwKSwgX2tleTMgPSAxOyBfa2V5MyA8IF9sZW4zOyBfa2V5MysrKSB7XG4gICAgICBhcmdzW19rZXkzIC0gMV0gPSBhcmd1bWVudHNbX2tleTNdO1xuICAgIH1cblxuICAgIHJldHVybiBmbnMuc29tZShmdW5jdGlvbiAoZm4pIHtcbiAgICAgIGlmIChmbikge1xuICAgICAgICBmbi5hcHBseSh2b2lkIDAsIFtldmVudF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGV2ZW50LnByZXZlbnREb3duc2hpZnREZWZhdWx0IHx8IGV2ZW50Lmhhc093blByb3BlcnR5KCduYXRpdmVFdmVudCcpICYmIGV2ZW50Lm5hdGl2ZUV2ZW50LnByZXZlbnREb3duc2hpZnREZWZhdWx0O1xuICAgIH0pO1xuICB9O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVSZWZzKCkge1xuICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlZnMgPSBuZXcgQXJyYXkoX2xlbjQpLCBfa2V5NCA9IDA7IF9rZXk0IDwgX2xlbjQ7IF9rZXk0KyspIHtcbiAgICByZWZzW19rZXk0XSA9IGFyZ3VtZW50c1tfa2V5NF07XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICByZWZzLmZvckVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgaWYgKHR5cGVvZiByZWYgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmVmKG5vZGUpO1xuICAgICAgfSBlbHNlIGlmIChyZWYpIHtcbiAgICAgICAgcmVmLmN1cnJlbnQgPSBub2RlO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xufVxuLyoqXG4gKiBUaGlzIGdlbmVyYXRlcyBhIHVuaXF1ZSBJRCBmb3IgYW4gaW5zdGFuY2Ugb2YgRG93bnNoaWZ0XG4gKiBAcmV0dXJuIHtTdHJpbmd9IHRoZSB1bmlxdWUgSURcbiAqL1xuXG5cbmZ1bmN0aW9uIGdlbmVyYXRlSWQoKSB7XG4gIHJldHVybiBTdHJpbmcoaWRDb3VudGVyKyspO1xufVxuLyoqXG4gKiBSZXNldHMgaWRDb3VudGVyIHRvIDAuIFVzZWQgZm9yIFNTUi5cbiAqL1xuXG5cbmZ1bmN0aW9uIHJlc2V0SWRDb3VudGVyKCkge1xuICBpZENvdW50ZXIgPSAwO1xufVxuLyoqXG4gKiBEZWZhdWx0IGltcGxlbWVudGF0aW9uIGZvciBzdGF0dXMgbWVzc2FnZS4gT25seSBhZGRlZCB3aGVuIG1lbnUgaXMgb3Blbi5cbiAqIFdpbGwgc3BlY2lmdCBpZiB0aGVyZSBhcmUgcmVzdWx0cyBpbiB0aGUgbGlzdCwgYW5kIGlmIHNvLCBob3cgbWFueSxcbiAqIGFuZCB3aGF0IGtleXMgYXJlIHJlbGV2YW50LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbSB0aGUgZG93bnNoaWZ0IHN0YXRlIGFuZCBvdGhlciByZWxldmFudCBwcm9wZXJ0aWVzXG4gKiBAcmV0dXJuIHtTdHJpbmd9IHRoZSBhMTF5IHN0YXR1cyBtZXNzYWdlXG4gKi9cblxuXG5mdW5jdGlvbiBnZXRBMTF5U3RhdHVzTWVzc2FnZShfcmVmMikge1xuICB2YXIgaXNPcGVuID0gX3JlZjIuaXNPcGVuLFxuICAgICAgcmVzdWx0Q291bnQgPSBfcmVmMi5yZXN1bHRDb3VudCxcbiAgICAgIHByZXZpb3VzUmVzdWx0Q291bnQgPSBfcmVmMi5wcmV2aW91c1Jlc3VsdENvdW50O1xuXG4gIGlmICghaXNPcGVuKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgaWYgKCFyZXN1bHRDb3VudCkge1xuICAgIHJldHVybiAnTm8gcmVzdWx0cyBhcmUgYXZhaWxhYmxlLic7XG4gIH1cblxuICBpZiAocmVzdWx0Q291bnQgIT09IHByZXZpb3VzUmVzdWx0Q291bnQpIHtcbiAgICByZXR1cm4gcmVzdWx0Q291bnQgKyBcIiByZXN1bHRcIiArIChyZXN1bHRDb3VudCA9PT0gMSA/ICcgaXMnIDogJ3MgYXJlJykgKyBcIiBhdmFpbGFibGUsIHVzZSB1cCBhbmQgZG93biBhcnJvdyBrZXlzIHRvIG5hdmlnYXRlLiBQcmVzcyBFbnRlciBrZXkgdG8gc2VsZWN0LlwiO1xuICB9XG5cbiAgcmV0dXJuICcnO1xufVxuLyoqXG4gKiBUYWtlcyBhbiBhcmd1bWVudCBhbmQgaWYgaXQncyBhbiBhcnJheSwgcmV0dXJucyB0aGUgZmlyc3QgaXRlbSBpbiB0aGUgYXJyYXlcbiAqIG90aGVyd2lzZSByZXR1cm5zIHRoZSBhcmd1bWVudFxuICogQHBhcmFtIHsqfSBhcmcgdGhlIG1heWJlLWFycmF5XG4gKiBAcGFyYW0geyp9IGRlZmF1bHRWYWx1ZSB0aGUgdmFsdWUgaWYgYXJnIGlzIGZhbHNleSBub3QgZGVmaW5lZFxuICogQHJldHVybiB7Kn0gdGhlIGFyZyBvciBpdCdzIGZpcnN0IGl0ZW1cbiAqL1xuXG5cbmZ1bmN0aW9uIHVud3JhcEFycmF5KGFyZywgZGVmYXVsdFZhbHVlKSB7XG4gIGFyZyA9IEFycmF5LmlzQXJyYXkoYXJnKSA/XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0IChwcmVhY3QpICovXG4gIGFyZ1swXSA6IGFyZztcblxuICBpZiAoIWFyZyAmJiBkZWZhdWx0VmFsdWUpIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBhcmc7XG4gIH1cbn1cbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQgKFApcmVhY3QgZWxlbWVudFxuICogQHJldHVybiB7Qm9vbGVhbn0gd2hldGhlciBpdCdzIGEgRE9NIGVsZW1lbnRcbiAqL1xuXG5cbmZ1bmN0aW9uIGlzRE9NRWxlbWVudChlbGVtZW50KSB7XG4gIC8vIHRoZW4gd2UgYXNzdW1lIHRoaXMgaXMgcmVhY3RcbiAgcmV0dXJuIHR5cGVvZiBlbGVtZW50LnR5cGUgPT09ICdzdHJpbmcnO1xufVxuLyoqXG4gKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudCAoUClyZWFjdCBlbGVtZW50XG4gKiBAcmV0dXJuIHtPYmplY3R9IHRoZSBwcm9wc1xuICovXG5cblxuZnVuY3Rpb24gZ2V0RWxlbWVudFByb3BzKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQucHJvcHM7XG59XG4vKipcbiAqIFRocm93cyBhIGhlbHBmdWwgZXJyb3IgbWVzc2FnZSBmb3IgcmVxdWlyZWQgcHJvcGVydGllcy4gVXNlZnVsXG4gKiB0byBiZSB1c2VkIGFzIGEgZGVmYXVsdCBpbiBkZXN0cnVjdHVyaW5nIG9yIG9iamVjdCBwYXJhbXMuXG4gKiBAcGFyYW0ge1N0cmluZ30gZm5OYW1lIHRoZSBmdW5jdGlvbiBuYW1lXG4gKiBAcGFyYW0ge1N0cmluZ30gcHJvcE5hbWUgdGhlIHByb3AgbmFtZVxuICovXG5cblxuZnVuY3Rpb24gcmVxdWlyZWRQcm9wKGZuTmFtZSwgcHJvcE5hbWUpIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgY29uc29sZS5lcnJvcihcIlRoZSBwcm9wZXJ0eSBcXFwiXCIgKyBwcm9wTmFtZSArIFwiXFxcIiBpcyByZXF1aXJlZCBpbiBcXFwiXCIgKyBmbk5hbWUgKyBcIlxcXCJcIik7XG59XG5cbnZhciBzdGF0ZUtleXMgPSBbJ2hpZ2hsaWdodGVkSW5kZXgnLCAnaW5wdXRWYWx1ZScsICdpc09wZW4nLCAnc2VsZWN0ZWRJdGVtJywgJ3R5cGUnXTtcbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IHN0YXRlIHRoZSBzdGF0ZSBvYmplY3RcbiAqIEByZXR1cm4ge09iamVjdH0gc3RhdGUgdGhhdCBpcyByZWxldmFudCB0byBkb3duc2hpZnRcbiAqL1xuXG5mdW5jdGlvbiBwaWNrU3RhdGUoc3RhdGUpIHtcbiAgaWYgKHN0YXRlID09PSB2b2lkIDApIHtcbiAgICBzdGF0ZSA9IHt9O1xuICB9XG5cbiAgdmFyIHJlc3VsdCA9IHt9O1xuICBzdGF0ZUtleXMuZm9yRWFjaChmdW5jdGlvbiAoaykge1xuICAgIGlmIChzdGF0ZS5oYXNPd25Qcm9wZXJ0eShrKSkge1xuICAgICAgcmVzdWx0W2tdID0gc3RhdGVba107XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbi8qKlxuICogVGhpcyB3aWxsIHBlcmZvcm0gYSBzaGFsbG93IG1lcmdlIG9mIHRoZSBnaXZlbiBzdGF0ZSBvYmplY3RcbiAqIHdpdGggdGhlIHN0YXRlIGNvbWluZyBmcm9tIHByb3BzXG4gKiAoZm9yIHRoZSBjb250cm9sbGVkIGNvbXBvbmVudCBzY2VuYXJpbylcbiAqIFRoaXMgaXMgdXNlZCBpbiBzdGF0ZSB1cGRhdGVyIGZ1bmN0aW9ucyBzbyB0aGV5J3JlIHJlZmVyZW5jaW5nXG4gKiB0aGUgcmlnaHQgc3RhdGUgcmVnYXJkbGVzcyBvZiB3aGVyZSBpdCBjb21lcyBmcm9tLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBzdGF0ZSBUaGUgc3RhdGUgb2YgdGhlIGNvbXBvbmVudC9ob29rLlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzIFRoZSBwcm9wcyB0aGF0IG1heSBjb250YWluIGNvbnRyb2xsZWQgdmFsdWVzLlxuICogQHJldHVybnMge09iamVjdH0gVGhlIG1lcmdlZCBjb250cm9sbGVkIHN0YXRlLlxuICovXG5cblxuZnVuY3Rpb24gZ2V0U3RhdGUoc3RhdGUsIHByb3BzKSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhzdGF0ZSkucmVkdWNlKGZ1bmN0aW9uIChwcmV2U3RhdGUsIGtleSkge1xuICAgIHByZXZTdGF0ZVtrZXldID0gaXNDb250cm9sbGVkUHJvcChwcm9wcywga2V5KSA/IHByb3BzW2tleV0gOiBzdGF0ZVtrZXldO1xuICAgIHJldHVybiBwcmV2U3RhdGU7XG4gIH0sIHt9KTtcbn1cbi8qKlxuICogVGhpcyBkZXRlcm1pbmVzIHdoZXRoZXIgYSBwcm9wIGlzIGEgXCJjb250cm9sbGVkIHByb3BcIiBtZWFuaW5nIGl0IGlzXG4gKiBzdGF0ZSB3aGljaCBpcyBjb250cm9sbGVkIGJ5IHRoZSBvdXRzaWRlIG9mIHRoaXMgY29tcG9uZW50IHJhdGhlclxuICogdGhhbiB3aXRoaW4gdGhpcyBjb21wb25lbnQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzIFRoZSBwcm9wcyB0aGF0IG1heSBjb250YWluIGNvbnRyb2xsZWQgdmFsdWVzLlxuICogQHBhcmFtIHtTdHJpbmd9IGtleSB0aGUga2V5IHRvIGNoZWNrXG4gKiBAcmV0dXJuIHtCb29sZWFufSB3aGV0aGVyIGl0IGlzIGEgY29udHJvbGxlZCBjb250cm9sbGVkIHByb3BcbiAqL1xuXG5cbmZ1bmN0aW9uIGlzQ29udHJvbGxlZFByb3AocHJvcHMsIGtleSkge1xuICByZXR1cm4gcHJvcHNba2V5XSAhPT0gdW5kZWZpbmVkO1xufVxuLyoqXG4gKiBOb3JtYWxpemVzIHRoZSAna2V5JyBwcm9wZXJ0eSBvZiBhIEtleWJvYXJkRXZlbnQgaW4gSUUvRWRnZVxuICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IGEga2V5Ym9hcmRFdmVudCBvYmplY3RcbiAqIEByZXR1cm4ge1N0cmluZ30ga2V5Ym9hcmQga2V5XG4gKi9cblxuXG5mdW5jdGlvbiBub3JtYWxpemVBcnJvd0tleShldmVudCkge1xuICB2YXIga2V5ID0gZXZlbnQua2V5LFxuICAgICAga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0IChpZSkgKi9cblxuICBpZiAoa2V5Q29kZSA+PSAzNyAmJiBrZXlDb2RlIDw9IDQwICYmIGtleS5pbmRleE9mKCdBcnJvdycpICE9PSAwKSB7XG4gICAgcmV0dXJuIFwiQXJyb3dcIiArIGtleTtcbiAgfVxuXG4gIHJldHVybiBrZXk7XG59XG4vKipcbiAqIFNpbXBsZSBjaGVjayBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG9iamVjdCBsaXRlcmFsXG4gKiBAcGFyYW0geyp9IG9iaiBhbnkgdGhpbmdzXG4gKiBAcmV0dXJuIHtCb29sZWFufSB3aGV0aGVyIGl0J3Mgb2JqZWN0IGxpdGVyYWxcbiAqL1xuXG5cbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3Qob2JqKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7XG59XG4vKipcbiAqIFJldHVybnMgdGhlIG5ldyBpbmRleCBpbiB0aGUgbGlzdCwgaW4gYSBjaXJjdWxhciB3YXkuIElmIG5leHQgdmFsdWUgaXMgb3V0IG9mIGJvbmRzIGZyb20gdGhlIHRvdGFsLFxuICogaXQgd2lsbCB3cmFwIHRvIGVpdGhlciAwIG9yIGl0ZW1Db3VudCAtIDEuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IG1vdmVBbW91bnQgTnVtYmVyIG9mIHBvc2l0aW9ucyB0byBtb3ZlLiBOZWdhdGl2ZSB0byBtb3ZlIGJhY2t3YXJkcywgcG9zaXRpdmUgZm9yd2FyZHMuXG4gKiBAcGFyYW0ge251bWJlcn0gYmFzZUluZGV4IFRoZSBpbml0aWFsIHBvc2l0aW9uIHRvIG1vdmUgZnJvbS5cbiAqIEBwYXJhbSB7bnVtYmVyfSBpdGVtQ291bnQgVGhlIHRvdGFsIG51bWJlciBvZiBpdGVtcy5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGdldEl0ZW1Ob2RlRnJvbUluZGV4IFVzZWQgdG8gY2hlY2sgaWYgaXRlbSBpcyBkaXNhYmxlZC5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gY2lyY3VsYXIgU3BlY2lmeSBpZiBuYXZpZ2F0aW9uIGlzIGNpcmN1bGFyLiBEZWZhdWx0IGlzIHRydWUuXG4gKiBAcmV0dXJucyB7bnVtYmVyfSBUaGUgbmV3IGluZGV4IGFmdGVyIHRoZSBtb3ZlLlxuICovXG5cblxuZnVuY3Rpb24gZ2V0TmV4dFdyYXBwaW5nSW5kZXgobW92ZUFtb3VudCwgYmFzZUluZGV4LCBpdGVtQ291bnQsIGdldEl0ZW1Ob2RlRnJvbUluZGV4LCBjaXJjdWxhcikge1xuICBpZiAoY2lyY3VsYXIgPT09IHZvaWQgMCkge1xuICAgIGNpcmN1bGFyID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChpdGVtQ291bnQgPT09IDApIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICB2YXIgaXRlbXNMYXN0SW5kZXggPSBpdGVtQ291bnQgLSAxO1xuXG4gIGlmICh0eXBlb2YgYmFzZUluZGV4ICE9PSAnbnVtYmVyJyB8fCBiYXNlSW5kZXggPCAwIHx8IGJhc2VJbmRleCA+PSBpdGVtQ291bnQpIHtcbiAgICBiYXNlSW5kZXggPSBtb3ZlQW1vdW50ID4gMCA/IC0xIDogaXRlbXNMYXN0SW5kZXggKyAxO1xuICB9XG5cbiAgdmFyIG5ld0luZGV4ID0gYmFzZUluZGV4ICsgbW92ZUFtb3VudDtcblxuICBpZiAobmV3SW5kZXggPCAwKSB7XG4gICAgbmV3SW5kZXggPSBjaXJjdWxhciA/IGl0ZW1zTGFzdEluZGV4IDogMDtcbiAgfSBlbHNlIGlmIChuZXdJbmRleCA+IGl0ZW1zTGFzdEluZGV4KSB7XG4gICAgbmV3SW5kZXggPSBjaXJjdWxhciA/IDAgOiBpdGVtc0xhc3RJbmRleDtcbiAgfVxuXG4gIHZhciBub25EaXNhYmxlZE5ld0luZGV4ID0gZ2V0TmV4dE5vbkRpc2FibGVkSW5kZXgobW92ZUFtb3VudCwgbmV3SW5kZXgsIGl0ZW1Db3VudCwgZ2V0SXRlbU5vZGVGcm9tSW5kZXgsIGNpcmN1bGFyKTtcblxuICBpZiAobm9uRGlzYWJsZWROZXdJbmRleCA9PT0gLTEpIHtcbiAgICByZXR1cm4gYmFzZUluZGV4ID49IGl0ZW1Db3VudCA/IC0xIDogYmFzZUluZGV4O1xuICB9XG5cbiAgcmV0dXJuIG5vbkRpc2FibGVkTmV3SW5kZXg7XG59XG4vKipcbiAqIFJldHVybnMgdGhlIG5leHQgaW5kZXggaW4gdGhlIGxpc3Qgb2YgYW4gaXRlbSB0aGF0IGlzIG5vdCBkaXNhYmxlZC5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gbW92ZUFtb3VudCBOdW1iZXIgb2YgcG9zaXRpb25zIHRvIG1vdmUuIE5lZ2F0aXZlIHRvIG1vdmUgYmFja3dhcmRzLCBwb3NpdGl2ZSBmb3J3YXJkcy5cbiAqIEBwYXJhbSB7bnVtYmVyfSBiYXNlSW5kZXggVGhlIGluaXRpYWwgcG9zaXRpb24gdG8gbW92ZSBmcm9tLlxuICogQHBhcmFtIHtudW1iZXJ9IGl0ZW1Db3VudCBUaGUgdG90YWwgbnVtYmVyIG9mIGl0ZW1zLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZ2V0SXRlbU5vZGVGcm9tSW5kZXggVXNlZCB0byBjaGVjayBpZiBpdGVtIGlzIGRpc2FibGVkLlxuICogQHBhcmFtIHtib29sZWFufSBjaXJjdWxhciBTcGVjaWZ5IGlmIG5hdmlnYXRpb24gaXMgY2lyY3VsYXIuIERlZmF1bHQgaXMgdHJ1ZS5cbiAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSBuZXcgaW5kZXguIFJldHVybnMgYmFzZUluZGV4IGlmIGl0ZW0gaXMgbm90IGRpc2FibGVkLiBSZXR1cm5zIG5leHQgbm9uLWRpc2FibGVkIGl0ZW0gb3RoZXJ3aXNlLiBJZiBubyBub24tZGlzYWJsZWQgZm91bmQgaXQgd2lsbCByZXR1cm4gLTEuXG4gKi9cblxuXG5mdW5jdGlvbiBnZXROZXh0Tm9uRGlzYWJsZWRJbmRleChtb3ZlQW1vdW50LCBiYXNlSW5kZXgsIGl0ZW1Db3VudCwgZ2V0SXRlbU5vZGVGcm9tSW5kZXgsIGNpcmN1bGFyKSB7XG4gIHZhciBjdXJyZW50RWxlbWVudE5vZGUgPSBnZXRJdGVtTm9kZUZyb21JbmRleChiYXNlSW5kZXgpO1xuXG4gIGlmICghY3VycmVudEVsZW1lbnROb2RlIHx8ICFjdXJyZW50RWxlbWVudE5vZGUuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgcmV0dXJuIGJhc2VJbmRleDtcbiAgfVxuXG4gIGlmIChtb3ZlQW1vdW50ID4gMCkge1xuICAgIGZvciAodmFyIGluZGV4ID0gYmFzZUluZGV4ICsgMTsgaW5kZXggPCBpdGVtQ291bnQ7IGluZGV4KyspIHtcbiAgICAgIGlmICghZ2V0SXRlbU5vZGVGcm9tSW5kZXgoaW5kZXgpLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIF9pbmRleCA9IGJhc2VJbmRleCAtIDE7IF9pbmRleCA+PSAwOyBfaW5kZXgtLSkge1xuICAgICAgaWYgKCFnZXRJdGVtTm9kZUZyb21JbmRleChfaW5kZXgpLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICByZXR1cm4gX2luZGV4O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChjaXJjdWxhcikge1xuICAgIHJldHVybiBtb3ZlQW1vdW50ID4gMCA/IGdldE5leHROb25EaXNhYmxlZEluZGV4KDEsIDAsIGl0ZW1Db3VudCwgZ2V0SXRlbU5vZGVGcm9tSW5kZXgsIGZhbHNlKSA6IGdldE5leHROb25EaXNhYmxlZEluZGV4KC0xLCBpdGVtQ291bnQgLSAxLCBpdGVtQ291bnQsIGdldEl0ZW1Ob2RlRnJvbUluZGV4LCBmYWxzZSk7XG4gIH1cblxuICByZXR1cm4gLTE7XG59XG4vKipcbiAqIENoZWNrcyBpZiBldmVudCB0YXJnZXQgaXMgd2l0aGluIHRoZSBkb3duc2hpZnQgZWxlbWVudHMuXG4gKlxuICogQHBhcmFtIHtFdmVudFRhcmdldH0gdGFyZ2V0IFRhcmdldCB0byBjaGVjay5cbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnRbXX0gZG93bnNoaWZ0RWxlbWVudHMgVGhlIGVsZW1lbnRzIHRoYXQgZm9ybSBkb3duc2hpZnQgKGxpc3QsIHRvZ2dsZSBidXR0b24gZXRjKS5cbiAqIEBwYXJhbSB7RG9jdW1lbnR9IGRvY3VtZW50IFRoZSBkb2N1bWVudC5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gY2hlY2tBY3RpdmVFbGVtZW50IFdoZXRoZXIgdG8gYWxzbyBjaGVjayBhY3RpdmVFbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufSBXaGV0aGVyIG9yIG5vdCB0aGUgdGFyZ2V0IGlzIHdpdGhpbiBkb3duc2hpZnQgZWxlbWVudHMuXG4gKi9cblxuXG5mdW5jdGlvbiB0YXJnZXRXaXRoaW5Eb3duc2hpZnQodGFyZ2V0LCBkb3duc2hpZnRFbGVtZW50cywgZG9jdW1lbnQsIGNoZWNrQWN0aXZlRWxlbWVudCkge1xuICBpZiAoY2hlY2tBY3RpdmVFbGVtZW50ID09PSB2b2lkIDApIHtcbiAgICBjaGVja0FjdGl2ZUVsZW1lbnQgPSB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGRvd25zaGlmdEVsZW1lbnRzLnNvbWUoZnVuY3Rpb24gKGNvbnRleHROb2RlKSB7XG4gICAgcmV0dXJuIGNvbnRleHROb2RlICYmIChpc09yQ29udGFpbnNOb2RlKGNvbnRleHROb2RlLCB0YXJnZXQpIHx8IGNoZWNrQWN0aXZlRWxlbWVudCAmJiBpc09yQ29udGFpbnNOb2RlKGNvbnRleHROb2RlLCBkb2N1bWVudC5hY3RpdmVFbGVtZW50KSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZUNvbnRyb2xsZWRVbmNoYW5nZWQoc3RhdGUsIHByZXZQcm9wcywgbmV4dFByb3BzKSB7XG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHdhcm5pbmdEZXNjcmlwdGlvbiA9IFwiVGhpcyBwcm9wIHNob3VsZCBub3Qgc3dpdGNoIGZyb20gY29udHJvbGxlZCB0byB1bmNvbnRyb2xsZWQgKG9yIHZpY2UgdmVyc2EpLiBEZWNpZGUgYmV0d2VlbiB1c2luZyBhIGNvbnRyb2xsZWQgb3IgdW5jb250cm9sbGVkIERvd25zaGlmdCBlbGVtZW50IGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIGNvbXBvbmVudC4gTW9yZSBpbmZvOiBodHRwczovL2dpdGh1Yi5jb20vZG93bnNoaWZ0LWpzL2Rvd25zaGlmdCNjb250cm9sLXByb3BzXCI7XG4gIE9iamVjdC5rZXlzKHN0YXRlKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wS2V5KSB7XG4gICAgaWYgKHByZXZQcm9wc1twcm9wS2V5XSAhPT0gdW5kZWZpbmVkICYmIG5leHRQcm9wc1twcm9wS2V5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS5lcnJvcihcImRvd25zaGlmdDogQSBjb21wb25lbnQgaGFzIGNoYW5nZWQgdGhlIGNvbnRyb2xsZWQgcHJvcCBcXFwiXCIgKyBwcm9wS2V5ICsgXCJcXFwiIHRvIGJlIHVuY29udHJvbGxlZC4gXCIgKyB3YXJuaW5nRGVzY3JpcHRpb24pO1xuICAgIH0gZWxzZSBpZiAocHJldlByb3BzW3Byb3BLZXldID09PSB1bmRlZmluZWQgJiYgbmV4dFByb3BzW3Byb3BLZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLmVycm9yKFwiZG93bnNoaWZ0OiBBIGNvbXBvbmVudCBoYXMgY2hhbmdlZCB0aGUgdW5jb250cm9sbGVkIHByb3AgXFxcIlwiICsgcHJvcEtleSArIFwiXFxcIiB0byBiZSBjb250cm9sbGVkLiBcIiArIHdhcm5pbmdEZXNjcmlwdGlvbik7XG4gICAgfVxuICB9KTtcbn1cblxudmFyIGNsZWFudXBTdGF0dXMgPSBkZWJvdW5jZShmdW5jdGlvbiAoKSB7XG4gIGdldFN0YXR1c0RpdigpLnRleHRDb250ZW50ID0gJyc7XG59LCA1MDApO1xuLyoqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RhdHVzIHRoZSBzdGF0dXMgbWVzc2FnZVxuICogQHBhcmFtIHtPYmplY3R9IGRvY3VtZW50UHJvcCBkb2N1bWVudCBwYXNzZWQgYnkgdGhlIHVzZXIuXG4gKi9cblxuZnVuY3Rpb24gc2V0U3RhdHVzKHN0YXR1cywgZG9jdW1lbnRQcm9wKSB7XG4gIHZhciBkaXYgPSBnZXRTdGF0dXNEaXYoZG9jdW1lbnRQcm9wKTtcblxuICBpZiAoIXN0YXR1cykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGRpdi50ZXh0Q29udGVudCA9IHN0YXR1cztcbiAgY2xlYW51cFN0YXR1cygpO1xufVxuLyoqXG4gKiBHZXQgdGhlIHN0YXR1cyBub2RlIG9yIGNyZWF0ZSBpdCBpZiBpdCBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0LlxuICogQHBhcmFtIHtPYmplY3R9IGRvY3VtZW50UHJvcCBkb2N1bWVudCBwYXNzZWQgYnkgdGhlIHVzZXIuXG4gKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gdGhlIHN0YXR1cyBub2RlLlxuICovXG5cblxuZnVuY3Rpb24gZ2V0U3RhdHVzRGl2KGRvY3VtZW50UHJvcCkge1xuICBpZiAoZG9jdW1lbnRQcm9wID09PSB2b2lkIDApIHtcbiAgICBkb2N1bWVudFByb3AgPSBkb2N1bWVudDtcbiAgfVxuXG4gIHZhciBzdGF0dXNEaXYgPSBkb2N1bWVudFByb3AuZ2V0RWxlbWVudEJ5SWQoJ2ExMXktc3RhdHVzLW1lc3NhZ2UnKTtcblxuICBpZiAoc3RhdHVzRGl2KSB7XG4gICAgcmV0dXJuIHN0YXR1c0RpdjtcbiAgfVxuXG4gIHN0YXR1c0RpdiA9IGRvY3VtZW50UHJvcC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgc3RhdHVzRGl2LnNldEF0dHJpYnV0ZSgnaWQnLCAnYTExeS1zdGF0dXMtbWVzc2FnZScpO1xuICBzdGF0dXNEaXYuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3N0YXR1cycpO1xuICBzdGF0dXNEaXYuc2V0QXR0cmlidXRlKCdhcmlhLWxpdmUnLCAncG9saXRlJyk7XG4gIHN0YXR1c0Rpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtcmVsZXZhbnQnLCAnYWRkaXRpb25zIHRleHQnKTtcbiAgT2JqZWN0LmFzc2lnbihzdGF0dXNEaXYuc3R5bGUsIHtcbiAgICBib3JkZXI6ICcwJyxcbiAgICBjbGlwOiAncmVjdCgwIDAgMCAwKScsXG4gICAgaGVpZ2h0OiAnMXB4JyxcbiAgICBtYXJnaW46ICctMXB4JyxcbiAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgcGFkZGluZzogJzAnLFxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHdpZHRoOiAnMXB4J1xuICB9KTtcbiAgZG9jdW1lbnRQcm9wLmJvZHkuYXBwZW5kQ2hpbGQoc3RhdHVzRGl2KTtcbiAgcmV0dXJuIHN0YXR1c0Rpdjtcbn1cblxudmFyIHVua25vd24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfdW5rbm93bl9fJyA6IDA7XG52YXIgbW91c2VVcCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9tb3VzZXVwX18nIDogMTtcbnZhciBpdGVtTW91c2VFbnRlciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9pdGVtX21vdXNlZW50ZXJfXycgOiAyO1xudmFyIGtleURvd25BcnJvd1VwID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2tleWRvd25fYXJyb3dfdXBfXycgOiAzO1xudmFyIGtleURvd25BcnJvd0Rvd24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfa2V5ZG93bl9hcnJvd19kb3duX18nIDogNDtcbnZhciBrZXlEb3duRXNjYXBlID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2tleWRvd25fZXNjYXBlX18nIDogNTtcbnZhciBrZXlEb3duRW50ZXIgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfa2V5ZG93bl9lbnRlcl9fJyA6IDY7XG52YXIga2V5RG93bkhvbWUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfa2V5ZG93bl9ob21lX18nIDogNztcbnZhciBrZXlEb3duRW5kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2tleWRvd25fZW5kX18nIDogODtcbnZhciBjbGlja0l0ZW0gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfY2xpY2tfaXRlbV9fJyA6IDk7XG52YXIgYmx1cklucHV0ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2JsdXJfaW5wdXRfXycgOiAxMDtcbnZhciBjaGFuZ2VJbnB1dCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9jaGFuZ2VfaW5wdXRfXycgOiAxMTtcbnZhciBrZXlEb3duU3BhY2VCdXR0b24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfa2V5ZG93bl9zcGFjZV9idXR0b25fXycgOiAxMjtcbnZhciBjbGlja0J1dHRvbiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9jbGlja19idXR0b25fXycgOiAxMztcbnZhciBibHVyQnV0dG9uID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2JsdXJfYnV0dG9uX18nIDogMTQ7XG52YXIgY29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2NvbnRyb2xsZWRfcHJvcF91cGRhdGVkX3NlbGVjdGVkX2l0ZW1fXycgOiAxNTtcbnZhciB0b3VjaEVuZCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV90b3VjaGVuZF9fJyA6IDE2O1xuXG52YXIgc3RhdGVDaGFuZ2VUeXBlcyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICB1bmtub3duOiB1bmtub3duLFxuICBtb3VzZVVwOiBtb3VzZVVwLFxuICBpdGVtTW91c2VFbnRlcjogaXRlbU1vdXNlRW50ZXIsXG4gIGtleURvd25BcnJvd1VwOiBrZXlEb3duQXJyb3dVcCxcbiAga2V5RG93bkFycm93RG93bjoga2V5RG93bkFycm93RG93bixcbiAga2V5RG93bkVzY2FwZToga2V5RG93bkVzY2FwZSxcbiAga2V5RG93bkVudGVyOiBrZXlEb3duRW50ZXIsXG4gIGtleURvd25Ib21lOiBrZXlEb3duSG9tZSxcbiAga2V5RG93bkVuZDoga2V5RG93bkVuZCxcbiAgY2xpY2tJdGVtOiBjbGlja0l0ZW0sXG4gIGJsdXJJbnB1dDogYmx1cklucHV0LFxuICBjaGFuZ2VJbnB1dDogY2hhbmdlSW5wdXQsXG4gIGtleURvd25TcGFjZUJ1dHRvbjoga2V5RG93blNwYWNlQnV0dG9uLFxuICBjbGlja0J1dHRvbjogY2xpY2tCdXR0b24sXG4gIGJsdXJCdXR0b246IGJsdXJCdXR0b24sXG4gIGNvbnRyb2xsZWRQcm9wVXBkYXRlZFNlbGVjdGVkSXRlbTogY29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtLFxuICB0b3VjaEVuZDogdG91Y2hFbmRcbn0pO1xuXG52YXIgRG93bnNoaWZ0ID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgdmFyIERvd25zaGlmdCA9XG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKF9Db21wb25lbnQpIHtcbiAgICBfaW5oZXJpdHNMb29zZShEb3duc2hpZnQsIF9Db21wb25lbnQpO1xuXG4gICAgZnVuY3Rpb24gRG93bnNoaWZ0KF9wcm9wcykge1xuICAgICAgdmFyIF90aGlzID0gX0NvbXBvbmVudC5jYWxsKHRoaXMsIF9wcm9wcykgfHwgdGhpcztcblxuICAgICAgX3RoaXMuaWQgPSBfdGhpcy5wcm9wcy5pZCB8fCBcImRvd25zaGlmdC1cIiArIGdlbmVyYXRlSWQoKTtcbiAgICAgIF90aGlzLm1lbnVJZCA9IF90aGlzLnByb3BzLm1lbnVJZCB8fCBfdGhpcy5pZCArIFwiLW1lbnVcIjtcbiAgICAgIF90aGlzLmxhYmVsSWQgPSBfdGhpcy5wcm9wcy5sYWJlbElkIHx8IF90aGlzLmlkICsgXCItbGFiZWxcIjtcbiAgICAgIF90aGlzLmlucHV0SWQgPSBfdGhpcy5wcm9wcy5pbnB1dElkIHx8IF90aGlzLmlkICsgXCItaW5wdXRcIjtcblxuICAgICAgX3RoaXMuZ2V0SXRlbUlkID0gX3RoaXMucHJvcHMuZ2V0SXRlbUlkIHx8IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gX3RoaXMuaWQgKyBcIi1pdGVtLVwiICsgaW5kZXg7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5pbnB1dCA9IG51bGw7XG4gICAgICBfdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgX3RoaXMuaXRlbUNvdW50ID0gbnVsbDtcbiAgICAgIF90aGlzLnByZXZpb3VzUmVzdWx0Q291bnQgPSAwO1xuICAgICAgX3RoaXMudGltZW91dElkcyA9IFtdO1xuXG4gICAgICBfdGhpcy5pbnRlcm5hbFNldFRpbWVvdXQgPSBmdW5jdGlvbiAoZm4sIHRpbWUpIHtcbiAgICAgICAgdmFyIGlkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMudGltZW91dElkcyA9IF90aGlzLnRpbWVvdXRJZHMuZmlsdGVyKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICByZXR1cm4gaSAhPT0gaWQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZm4oKTtcbiAgICAgICAgfSwgdGltZSk7XG5cbiAgICAgICAgX3RoaXMudGltZW91dElkcy5wdXNoKGlkKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLnNldEl0ZW1Db3VudCA9IGZ1bmN0aW9uIChjb3VudCkge1xuICAgICAgICBfdGhpcy5pdGVtQ291bnQgPSBjb3VudDtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLnVuc2V0SXRlbUNvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5pdGVtQ291bnQgPSBudWxsO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuc2V0SGlnaGxpZ2h0ZWRJbmRleCA9IGZ1bmN0aW9uIChoaWdobGlnaHRlZEluZGV4LCBvdGhlclN0YXRlVG9TZXQpIHtcbiAgICAgICAgaWYgKGhpZ2hsaWdodGVkSW5kZXggPT09IHZvaWQgMCkge1xuICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcy5wcm9wcy5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvdGhlclN0YXRlVG9TZXQgPT09IHZvaWQgMCkge1xuICAgICAgICAgIG90aGVyU3RhdGVUb1NldCA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0gcGlja1N0YXRlKG90aGVyU3RhdGVUb1NldCk7XG5cbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZShfZXh0ZW5kcyh7XG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleFxuICAgICAgICB9LCBvdGhlclN0YXRlVG9TZXQpKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uID0gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgIF90aGlzLmludGVybmFsU2V0U3RhdGUoe1xuICAgICAgICAgIHNlbGVjdGVkSXRlbTogbnVsbCxcbiAgICAgICAgICBpbnB1dFZhbHVlOiAnJyxcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBfdGhpcy5wcm9wcy5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBpc09wZW46IF90aGlzLnByb3BzLmRlZmF1bHRJc09wZW5cbiAgICAgICAgfSwgY2IpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuc2VsZWN0SXRlbSA9IGZ1bmN0aW9uIChpdGVtLCBvdGhlclN0YXRlVG9TZXQsIGNiKSB7XG4gICAgICAgIG90aGVyU3RhdGVUb1NldCA9IHBpY2tTdGF0ZShvdGhlclN0YXRlVG9TZXQpO1xuXG4gICAgICAgIF90aGlzLmludGVybmFsU2V0U3RhdGUoX2V4dGVuZHMoe1xuICAgICAgICAgIGlzT3BlbjogX3RoaXMucHJvcHMuZGVmYXVsdElzT3BlbixcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBfdGhpcy5wcm9wcy5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBzZWxlY3RlZEl0ZW06IGl0ZW0sXG4gICAgICAgICAgaW5wdXRWYWx1ZTogX3RoaXMucHJvcHMuaXRlbVRvU3RyaW5nKGl0ZW0pXG4gICAgICAgIH0sIG90aGVyU3RhdGVUb1NldCksIGNiKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLnNlbGVjdEl0ZW1BdEluZGV4ID0gZnVuY3Rpb24gKGl0ZW1JbmRleCwgb3RoZXJTdGF0ZVRvU2V0LCBjYikge1xuICAgICAgICB2YXIgaXRlbSA9IF90aGlzLml0ZW1zW2l0ZW1JbmRleF07XG5cbiAgICAgICAgaWYgKGl0ZW0gPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzLnNlbGVjdEl0ZW0oaXRlbSwgb3RoZXJTdGF0ZVRvU2V0LCBjYik7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5zZWxlY3RIaWdobGlnaHRlZEl0ZW0gPSBmdW5jdGlvbiAob3RoZXJTdGF0ZVRvU2V0LCBjYikge1xuICAgICAgICByZXR1cm4gX3RoaXMuc2VsZWN0SXRlbUF0SW5kZXgoX3RoaXMuZ2V0U3RhdGUoKS5oaWdobGlnaHRlZEluZGV4LCBvdGhlclN0YXRlVG9TZXQsIGNiKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmludGVybmFsU2V0U3RhdGUgPSBmdW5jdGlvbiAoc3RhdGVUb1NldCwgY2IpIHtcbiAgICAgICAgdmFyIGlzSXRlbVNlbGVjdGVkLCBvbkNoYW5nZUFyZztcbiAgICAgICAgdmFyIG9uU3RhdGVDaGFuZ2VBcmcgPSB7fTtcbiAgICAgICAgdmFyIGlzU3RhdGVUb1NldEZ1bmN0aW9uID0gdHlwZW9mIHN0YXRlVG9TZXQgPT09ICdmdW5jdGlvbic7IC8vIHdlIHdhbnQgdG8gY2FsbCBgb25JbnB1dFZhbHVlQ2hhbmdlYCBiZWZvcmUgdGhlIGBzZXRTdGF0ZWAgY2FsbFxuICAgICAgICAvLyBzbyBzb21lb25lIGNvbnRyb2xsaW5nIHRoZSBgaW5wdXRWYWx1ZWAgc3RhdGUgZ2V0cyBub3RpZmllZCBvZlxuICAgICAgICAvLyB0aGUgaW5wdXQgY2hhbmdlIGFzIHNvb24gYXMgcG9zc2libGUuIFRoaXMgYXZvaWRzIGlzc3VlcyB3aXRoXG4gICAgICAgIC8vIHByZXNlcnZpbmcgdGhlIGN1cnNvciBwb3NpdGlvbi5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9kb3duc2hpZnQtanMvZG93bnNoaWZ0L2lzc3Vlcy8yMTcgZm9yIG1vcmUgaW5mby5cblxuICAgICAgICBpZiAoIWlzU3RhdGVUb1NldEZ1bmN0aW9uICYmIHN0YXRlVG9TZXQuaGFzT3duUHJvcGVydHkoJ2lucHV0VmFsdWUnKSkge1xuICAgICAgICAgIF90aGlzLnByb3BzLm9uSW5wdXRWYWx1ZUNoYW5nZShzdGF0ZVRvU2V0LmlucHV0VmFsdWUsIF9leHRlbmRzKHt9LCBfdGhpcy5nZXRTdGF0ZUFuZEhlbHBlcnMoKSwgc3RhdGVUb1NldCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgIHN0YXRlID0gX3RoaXMuZ2V0U3RhdGUoc3RhdGUpO1xuICAgICAgICAgIHZhciBuZXdTdGF0ZVRvU2V0ID0gaXNTdGF0ZVRvU2V0RnVuY3Rpb24gPyBzdGF0ZVRvU2V0KHN0YXRlKSA6IHN0YXRlVG9TZXQ7IC8vIFlvdXIgb3duIGZ1bmN0aW9uIHRoYXQgY291bGQgbW9kaWZ5IHRoZSBzdGF0ZSB0aGF0IHdpbGwgYmUgc2V0LlxuXG4gICAgICAgICAgbmV3U3RhdGVUb1NldCA9IF90aGlzLnByb3BzLnN0YXRlUmVkdWNlcihzdGF0ZSwgbmV3U3RhdGVUb1NldCk7IC8vIGNoZWNrcyBpZiBhbiBpdGVtIGlzIHNlbGVjdGVkLCByZWdhcmRsZXNzIG9mIGlmIGl0J3MgZGlmZmVyZW50IGZyb21cbiAgICAgICAgICAvLyB3aGF0IHdhcyBzZWxlY3RlZCBiZWZvcmVcbiAgICAgICAgICAvLyB1c2VkIHRvIGRldGVybWluZSBpZiBvblNlbGVjdCBhbmQgb25DaGFuZ2UgY2FsbGJhY2tzIHNob3VsZCBiZSBjYWxsZWRcblxuICAgICAgICAgIGlzSXRlbVNlbGVjdGVkID0gbmV3U3RhdGVUb1NldC5oYXNPd25Qcm9wZXJ0eSgnc2VsZWN0ZWRJdGVtJyk7IC8vIHRoaXMga2VlcHMgdHJhY2sgb2YgdGhlIG9iamVjdCB3ZSB3YW50IHRvIGNhbGwgd2l0aCBzZXRTdGF0ZVxuXG4gICAgICAgICAgdmFyIG5leHRTdGF0ZSA9IHt9OyAvLyB0aGlzIGlzIGp1c3QgdXNlZCB0byB0ZWxsIHdoZXRoZXIgdGhlIHN0YXRlIGNoYW5nZWRcblxuICAgICAgICAgIHZhciBuZXh0RnVsbFN0YXRlID0ge307IC8vIHdlIG5lZWQgdG8gY2FsbCBvbiBjaGFuZ2UgaWYgdGhlIG91dHNpZGUgd29ybGQgaXMgY29udHJvbGxpbmcgYW55IG9mIG91ciBzdGF0ZVxuICAgICAgICAgIC8vIGFuZCB3ZSdyZSB0cnlpbmcgdG8gdXBkYXRlIHRoYXQgc3RhdGUuIE9SIGlmIHRoZSBzZWxlY3Rpb24gaGFzIGNoYW5nZWQgYW5kIHdlJ3JlXG4gICAgICAgICAgLy8gdHJ5aW5nIHRvIHVwZGF0ZSB0aGUgc2VsZWN0aW9uXG5cbiAgICAgICAgICBpZiAoaXNJdGVtU2VsZWN0ZWQgJiYgbmV3U3RhdGVUb1NldC5zZWxlY3RlZEl0ZW0gIT09IHN0YXRlLnNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgb25DaGFuZ2VBcmcgPSBuZXdTdGF0ZVRvU2V0LnNlbGVjdGVkSXRlbTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXdTdGF0ZVRvU2V0LnR5cGUgPSBuZXdTdGF0ZVRvU2V0LnR5cGUgfHwgdW5rbm93bjtcbiAgICAgICAgICBPYmplY3Qua2V5cyhuZXdTdGF0ZVRvU2V0KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgIC8vIG9uU3RhdGVDaGFuZ2VBcmcgc2hvdWxkIG9ubHkgaGF2ZSB0aGUgc3RhdGUgdGhhdCBpc1xuICAgICAgICAgICAgLy8gYWN0dWFsbHkgY2hhbmdpbmdcbiAgICAgICAgICAgIGlmIChzdGF0ZVtrZXldICE9PSBuZXdTdGF0ZVRvU2V0W2tleV0pIHtcbiAgICAgICAgICAgICAgb25TdGF0ZUNoYW5nZUFyZ1trZXldID0gbmV3U3RhdGVUb1NldFtrZXldO1xuICAgICAgICAgICAgfSAvLyB0aGUgdHlwZSBpcyB1c2VmdWwgZm9yIHRoZSBvblN0YXRlQ2hhbmdlQXJnXG4gICAgICAgICAgICAvLyBidXQgd2UgZG9uJ3QgYWN0dWFsbHkgd2FudCB0byBzZXQgaXQgaW4gaW50ZXJuYWwgc3RhdGUuXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGFuIHVuZG9jdW1lbnRlZCBmZWF0dXJlIGZvciBub3cuLi4gTm90IGFsbCBpbnRlcm5hbFNldFN0YXRlXG4gICAgICAgICAgICAvLyBjYWxscyBzdXBwb3J0IGl0IGFuZCBJJ20gbm90IGNlcnRhaW4gd2Ugd2FudCB0aGVtIHRvIHlldC5cbiAgICAgICAgICAgIC8vIEJ1dCBpdCBlbmFibGVzIHVzZXJzIGNvbnRyb2xsaW5nIHRoZSBpc09wZW4gc3RhdGUgdG8ga25vdyB3aGVuXG4gICAgICAgICAgICAvLyB0aGUgaXNPcGVuIHN0YXRlIGNoYW5nZXMgZHVlIHRvIG1vdXNldXAgZXZlbnRzIHdoaWNoIGlzIHF1aXRlIGhhbmR5LlxuXG5cbiAgICAgICAgICAgIGlmIChrZXkgPT09ICd0eXBlJykge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5leHRGdWxsU3RhdGVba2V5XSA9IG5ld1N0YXRlVG9TZXRba2V5XTsgLy8gaWYgaXQncyBjb21pbmcgZnJvbSBwcm9wcywgdGhlbiB3ZSBkb24ndCBjYXJlIHRvIHNldCBpdCBpbnRlcm5hbGx5XG5cbiAgICAgICAgICAgIGlmICghaXNDb250cm9sbGVkUHJvcChfdGhpcy5wcm9wcywga2V5KSkge1xuICAgICAgICAgICAgICBuZXh0U3RhdGVba2V5XSA9IG5ld1N0YXRlVG9TZXRba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTsgLy8gaWYgc3RhdGVUb1NldCBpcyBhIGZ1bmN0aW9uLCB0aGVuIHdlIHdlcmVuJ3QgYWJsZSB0byBjYWxsIG9uSW5wdXRWYWx1ZUNoYW5nZVxuICAgICAgICAgIC8vIGVhcmxpZXIsIHNvIHdlJ2xsIGNhbGwgaXQgbm93IHRoYXQgd2Uga25vdyB3aGF0IHRoZSBpbnB1dFZhbHVlIHN0YXRlIHdpbGwgYmUuXG5cbiAgICAgICAgICBpZiAoaXNTdGF0ZVRvU2V0RnVuY3Rpb24gJiYgbmV3U3RhdGVUb1NldC5oYXNPd25Qcm9wZXJ0eSgnaW5wdXRWYWx1ZScpKSB7XG4gICAgICAgICAgICBfdGhpcy5wcm9wcy5vbklucHV0VmFsdWVDaGFuZ2UobmV3U3RhdGVUb1NldC5pbnB1dFZhbHVlLCBfZXh0ZW5kcyh7fSwgX3RoaXMuZ2V0U3RhdGVBbmRIZWxwZXJzKCksIG5ld1N0YXRlVG9TZXQpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gbmV4dFN0YXRlO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gY2FsbCB0aGUgcHJvdmlkZWQgY2FsbGJhY2sgaWYgaXQncyBhIGZ1bmN0aW9uXG4gICAgICAgICAgY2JUb0NiKGNiKSgpOyAvLyBvbmx5IGNhbGwgdGhlIG9uU3RhdGVDaGFuZ2UgYW5kIG9uQ2hhbmdlIGNhbGxiYWNrcyBpZlxuICAgICAgICAgIC8vIHdlIGhhdmUgcmVsZXZhbnQgaW5mb3JtYXRpb24gdG8gcGFzcyB0aGVtLlxuXG4gICAgICAgICAgdmFyIGhhc01vcmVTdGF0ZVRoYW5UeXBlID0gT2JqZWN0LmtleXMob25TdGF0ZUNoYW5nZUFyZykubGVuZ3RoID4gMTtcblxuICAgICAgICAgIGlmIChoYXNNb3JlU3RhdGVUaGFuVHlwZSkge1xuICAgICAgICAgICAgX3RoaXMucHJvcHMub25TdGF0ZUNoYW5nZShvblN0YXRlQ2hhbmdlQXJnLCBfdGhpcy5nZXRTdGF0ZUFuZEhlbHBlcnMoKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGlzSXRlbVNlbGVjdGVkKSB7XG4gICAgICAgICAgICBfdGhpcy5wcm9wcy5vblNlbGVjdChzdGF0ZVRvU2V0LnNlbGVjdGVkSXRlbSwgX3RoaXMuZ2V0U3RhdGVBbmRIZWxwZXJzKCkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChvbkNoYW5nZUFyZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBfdGhpcy5wcm9wcy5vbkNoYW5nZShvbkNoYW5nZUFyZywgX3RoaXMuZ2V0U3RhdGVBbmRIZWxwZXJzKCkpO1xuICAgICAgICAgIH0gLy8gdGhpcyBpcyBjdXJyZW50bHkgdW5kb2N1bWVudGVkIGFuZCB0aGVyZWZvcmUgc3ViamVjdCB0byBjaGFuZ2VcbiAgICAgICAgICAvLyBXZSdsbCB0cnkgdG8gbm90IGJyZWFrIGl0LCBidXQganVzdCBiZSB3YXJuZWQuXG5cblxuICAgICAgICAgIF90aGlzLnByb3BzLm9uVXNlckFjdGlvbihvblN0YXRlQ2hhbmdlQXJnLCBfdGhpcy5nZXRTdGF0ZUFuZEhlbHBlcnMoKSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMucm9vdFJlZiA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiBfdGhpcy5fcm9vdE5vZGUgPSBub2RlO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuZ2V0Um9vdFByb3BzID0gZnVuY3Rpb24gKF90ZW1wLCBfdGVtcDIpIHtcbiAgICAgICAgdmFyIF9leHRlbmRzMjtcblxuICAgICAgICB2YXIgX3JlZiA9IF90ZW1wID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wLFxuICAgICAgICAgICAgX3JlZiRyZWZLZXkgPSBfcmVmLnJlZktleSxcbiAgICAgICAgICAgIHJlZktleSA9IF9yZWYkcmVmS2V5ID09PSB2b2lkIDAgPyAncmVmJyA6IF9yZWYkcmVmS2V5LFxuICAgICAgICAgICAgcmVmID0gX3JlZi5yZWYsXG4gICAgICAgICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZiwgW1wicmVmS2V5XCIsIFwicmVmXCJdKTtcblxuICAgICAgICB2YXIgX3JlZjIgPSBfdGVtcDIgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAyLFxuICAgICAgICAgICAgX3JlZjIkc3VwcHJlc3NSZWZFcnJvID0gX3JlZjIuc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgICAgICAgIHN1cHByZXNzUmVmRXJyb3IgPSBfcmVmMiRzdXBwcmVzc1JlZkVycm8gPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjIkc3VwcHJlc3NSZWZFcnJvO1xuXG4gICAgICAgIC8vIHRoaXMgaXMgdXNlZCBpbiB0aGUgcmVuZGVyIHRvIGtub3cgd2hldGhlciB0aGUgdXNlciBoYXMgY2FsbGVkIGdldFJvb3RQcm9wcy5cbiAgICAgICAgLy8gSXQgdXNlcyB0aGF0IHRvIGtub3cgd2hldGhlciB0byBhcHBseSB0aGUgcHJvcHMgYXV0b21hdGljYWxseVxuICAgICAgICBfdGhpcy5nZXRSb290UHJvcHMuY2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMuZ2V0Um9vdFByb3BzLnJlZktleSA9IHJlZktleTtcbiAgICAgICAgX3RoaXMuZ2V0Um9vdFByb3BzLnN1cHByZXNzUmVmRXJyb3IgPSBzdXBwcmVzc1JlZkVycm9yO1xuXG4gICAgICAgIHZhciBfdGhpcyRnZXRTdGF0ZSA9IF90aGlzLmdldFN0YXRlKCksXG4gICAgICAgICAgICBpc09wZW4gPSBfdGhpcyRnZXRTdGF0ZS5pc09wZW47XG5cbiAgICAgICAgcmV0dXJuIF9leHRlbmRzKChfZXh0ZW5kczIgPSB7fSwgX2V4dGVuZHMyW3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgX3RoaXMucm9vdFJlZiksIF9leHRlbmRzMi5yb2xlID0gJ2NvbWJvYm94JywgX2V4dGVuZHMyWydhcmlhLWV4cGFuZGVkJ10gPSBpc09wZW4sIF9leHRlbmRzMlsnYXJpYS1oYXNwb3B1cCddID0gJ2xpc3Rib3gnLCBfZXh0ZW5kczJbJ2FyaWEtb3ducyddID0gaXNPcGVuID8gX3RoaXMubWVudUlkIDogbnVsbCwgX2V4dGVuZHMyWydhcmlhLWxhYmVsbGVkYnknXSA9IF90aGlzLmxhYmVsSWQsIF9leHRlbmRzMiksIHJlc3QpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMua2V5RG93bkhhbmRsZXJzID0ge1xuICAgICAgICBBcnJvd0Rvd246IGZ1bmN0aW9uIEFycm93RG93bihldmVudCkge1xuICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgIGlmICh0aGlzLmdldFN0YXRlKCkuaXNPcGVuKSB7XG4gICAgICAgICAgICB2YXIgYW1vdW50ID0gZXZlbnQuc2hpZnRLZXkgPyA1IDogMTtcbiAgICAgICAgICAgIHRoaXMubW92ZUhpZ2hsaWdodGVkSW5kZXgoYW1vdW50LCB7XG4gICAgICAgICAgICAgIHR5cGU6IGtleURvd25BcnJvd0Rvd25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmludGVybmFsU2V0U3RhdGUoe1xuICAgICAgICAgICAgICBpc09wZW46IHRydWUsXG4gICAgICAgICAgICAgIHR5cGU6IGtleURvd25BcnJvd0Rvd25cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdmFyIGl0ZW1Db3VudCA9IF90aGlzMi5nZXRJdGVtQ291bnQoKTtcblxuICAgICAgICAgICAgICBpZiAoaXRlbUNvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczIkZ2V0U3RhdGUgPSBfdGhpczIuZ2V0U3RhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzMiRnZXRTdGF0ZS5oaWdobGlnaHRlZEluZGV4O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5leHRIaWdobGlnaHRlZEluZGV4ID0gZ2V0TmV4dFdyYXBwaW5nSW5kZXgoMSwgaGlnaGxpZ2h0ZWRJbmRleCwgaXRlbUNvdW50LCBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuZ2V0SXRlbU5vZGVGcm9tSW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMyLnNldEhpZ2hsaWdodGVkSW5kZXgobmV4dEhpZ2hsaWdodGVkSW5kZXgsIHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IGtleURvd25BcnJvd0Rvd25cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBBcnJvd1VwOiBmdW5jdGlvbiBBcnJvd1VwKGV2ZW50KSB7XG4gICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgaWYgKHRoaXMuZ2V0U3RhdGUoKS5pc09wZW4pIHtcbiAgICAgICAgICAgIHZhciBhbW91bnQgPSBldmVudC5zaGlmdEtleSA/IC01IDogLTE7XG4gICAgICAgICAgICB0aGlzLm1vdmVIaWdobGlnaHRlZEluZGV4KGFtb3VudCwge1xuICAgICAgICAgICAgICB0eXBlOiBrZXlEb3duQXJyb3dVcFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxTZXRTdGF0ZSh7XG4gICAgICAgICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgICAgICAgdHlwZToga2V5RG93bkFycm93VXBcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdmFyIGl0ZW1Db3VudCA9IF90aGlzMy5nZXRJdGVtQ291bnQoKTtcblxuICAgICAgICAgICAgICBpZiAoaXRlbUNvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczMkZ2V0U3RhdGUgPSBfdGhpczMuZ2V0U3RhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzMyRnZXRTdGF0ZS5oaWdobGlnaHRlZEluZGV4O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5leHRIaWdobGlnaHRlZEluZGV4ID0gZ2V0TmV4dFdyYXBwaW5nSW5kZXgoLTEsIGhpZ2hsaWdodGVkSW5kZXgsIGl0ZW1Db3VudCwgZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLmdldEl0ZW1Ob2RlRnJvbUluZGV4KGluZGV4KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIF90aGlzMy5zZXRIaWdobGlnaHRlZEluZGV4KG5leHRIaWdobGlnaHRlZEluZGV4LCB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBrZXlEb3duQXJyb3dVcFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIEVudGVyOiBmdW5jdGlvbiBFbnRlcihldmVudCkge1xuICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMjI5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIF90aGlzJGdldFN0YXRlMiA9IHRoaXMuZ2V0U3RhdGUoKSxcbiAgICAgICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGUyLmlzT3BlbixcbiAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzJGdldFN0YXRlMi5oaWdobGlnaHRlZEluZGV4O1xuXG4gICAgICAgICAgaWYgKGlzT3BlbiAmJiBoaWdobGlnaHRlZEluZGV4ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMuaXRlbXNbaGlnaGxpZ2h0ZWRJbmRleF07XG4gICAgICAgICAgICB2YXIgaXRlbU5vZGUgPSB0aGlzLmdldEl0ZW1Ob2RlRnJvbUluZGV4KGhpZ2hsaWdodGVkSW5kZXgpO1xuXG4gICAgICAgICAgICBpZiAoaXRlbSA9PSBudWxsIHx8IGl0ZW1Ob2RlICYmIGl0ZW1Ob2RlLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWRJdGVtKHtcbiAgICAgICAgICAgICAgdHlwZToga2V5RG93bkVudGVyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIEVzY2FwZTogZnVuY3Rpb24gRXNjYXBlKGV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0aGlzLnJlc2V0KF9leHRlbmRzKHtcbiAgICAgICAgICAgIHR5cGU6IGtleURvd25Fc2NhcGVcbiAgICAgICAgICB9LCAhdGhpcy5zdGF0ZS5pc09wZW4gJiYge1xuICAgICAgICAgICAgc2VsZWN0ZWRJdGVtOiBudWxsLFxuICAgICAgICAgICAgaW5wdXRWYWx1ZTogJydcbiAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBfdGhpcy5idXR0b25LZXlEb3duSGFuZGxlcnMgPSBfZXh0ZW5kcyh7fSwgX3RoaXMua2V5RG93bkhhbmRsZXJzLCB7XG4gICAgICAgICcgJzogZnVuY3Rpb24gXyhldmVudCkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdGhpcy50b2dnbGVNZW51KHtcbiAgICAgICAgICAgIHR5cGU6IGtleURvd25TcGFjZUJ1dHRvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIF90aGlzLmlucHV0S2V5RG93bkhhbmRsZXJzID0gX2V4dGVuZHMoe30sIF90aGlzLmtleURvd25IYW5kbGVycywge1xuICAgICAgICBIb21lOiBmdW5jdGlvbiBIb21lKGV2ZW50KSB7XG4gICAgICAgICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHZhciBpdGVtQ291bnQgPSB0aGlzLmdldEl0ZW1Db3VudCgpO1xuXG4gICAgICAgICAgdmFyIF90aGlzJGdldFN0YXRlMyA9IHRoaXMuZ2V0U3RhdGUoKSxcbiAgICAgICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGUzLmlzT3BlbjtcblxuICAgICAgICAgIGlmIChpdGVtQ291bnQgPD0gMCB8fCAhaXNPcGVuKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBnZXQgbmV4dCBub24tZGlzYWJsZWQgc3RhcnRpbmcgZG93bndhcmRzIGZyb20gMCBpZiB0aGF0J3MgZGlzYWJsZWQuXG5cblxuICAgICAgICAgIHZhciBuZXdIaWdobGlnaHRlZEluZGV4ID0gZ2V0TmV4dE5vbkRpc2FibGVkSW5kZXgoMSwgMCwgaXRlbUNvdW50LCBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpczQuZ2V0SXRlbU5vZGVGcm9tSW5kZXgoaW5kZXgpO1xuICAgICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgICB0aGlzLnNldEhpZ2hsaWdodGVkSW5kZXgobmV3SGlnaGxpZ2h0ZWRJbmRleCwge1xuICAgICAgICAgICAgdHlwZToga2V5RG93bkhvbWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgRW5kOiBmdW5jdGlvbiBFbmQoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdmFyIGl0ZW1Db3VudCA9IHRoaXMuZ2V0SXRlbUNvdW50KCk7XG5cbiAgICAgICAgICB2YXIgX3RoaXMkZ2V0U3RhdGU0ID0gdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgICAgICBpc09wZW4gPSBfdGhpcyRnZXRTdGF0ZTQuaXNPcGVuO1xuXG4gICAgICAgICAgaWYgKGl0ZW1Db3VudCA8PSAwIHx8ICFpc09wZW4pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIGdldCBuZXh0IG5vbi1kaXNhYmxlZCBzdGFydGluZyB1cHdhcmRzIGZyb20gbGFzdCBpbmRleCBpZiB0aGF0J3MgZGlzYWJsZWQuXG5cblxuICAgICAgICAgIHZhciBuZXdIaWdobGlnaHRlZEluZGV4ID0gZ2V0TmV4dE5vbkRpc2FibGVkSW5kZXgoLTEsIGl0ZW1Db3VudCAtIDEsIGl0ZW1Db3VudCwgZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM1LmdldEl0ZW1Ob2RlRnJvbUluZGV4KGluZGV4KTtcbiAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgICAgdGhpcy5zZXRIaWdobGlnaHRlZEluZGV4KG5ld0hpZ2hsaWdodGVkSW5kZXgsIHtcbiAgICAgICAgICAgIHR5cGU6IGtleURvd25FbmRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF90aGlzLmdldFRvZ2dsZUJ1dHRvblByb3BzID0gZnVuY3Rpb24gKF90ZW1wMykge1xuICAgICAgICB2YXIgX3JlZjMgPSBfdGVtcDMgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAzLFxuICAgICAgICAgICAgb25DbGljayA9IF9yZWYzLm9uQ2xpY2ssXG4gICAgICAgICAgICBvblByZXNzID0gX3JlZjMub25QcmVzcyxcbiAgICAgICAgICAgIG9uS2V5RG93biA9IF9yZWYzLm9uS2V5RG93bixcbiAgICAgICAgICAgIG9uS2V5VXAgPSBfcmVmMy5vbktleVVwLFxuICAgICAgICAgICAgb25CbHVyID0gX3JlZjMub25CbHVyLFxuICAgICAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYzLCBbXCJvbkNsaWNrXCIsIFwib25QcmVzc1wiLCBcIm9uS2V5RG93blwiLCBcIm9uS2V5VXBcIiwgXCJvbkJsdXJcIl0pO1xuXG4gICAgICAgIHZhciBfdGhpcyRnZXRTdGF0ZTUgPSBfdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGU1LmlzT3BlbjtcblxuICAgICAgICB2YXIgZW5hYmxlZEV2ZW50SGFuZGxlcnMgPSB7XG4gICAgICAgICAgb25DbGljazogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DbGljaywgX3RoaXMuYnV0dG9uSGFuZGxlQ2xpY2spLFxuICAgICAgICAgIG9uS2V5RG93bjogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCBfdGhpcy5idXR0b25IYW5kbGVLZXlEb3duKSxcbiAgICAgICAgICBvbktleVVwOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbktleVVwLCBfdGhpcy5idXR0b25IYW5kbGVLZXlVcCksXG4gICAgICAgICAgb25CbHVyOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkJsdXIsIF90aGlzLmJ1dHRvbkhhbmRsZUJsdXIpXG4gICAgICAgIH07XG4gICAgICAgIHZhciBldmVudEhhbmRsZXJzID0gcmVzdC5kaXNhYmxlZCA/IHt9IDogZW5hYmxlZEV2ZW50SGFuZGxlcnM7XG4gICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgcm9sZTogJ2J1dHRvbicsXG4gICAgICAgICAgJ2FyaWEtbGFiZWwnOiBpc09wZW4gPyAnY2xvc2UgbWVudScgOiAnb3BlbiBtZW51JyxcbiAgICAgICAgICAnYXJpYS1oYXNwb3B1cCc6IHRydWUsXG4gICAgICAgICAgJ2RhdGEtdG9nZ2xlJzogdHJ1ZVxuICAgICAgICB9LCBldmVudEhhbmRsZXJzLCByZXN0KTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmJ1dHRvbkhhbmRsZUtleVVwID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIFByZXZlbnQgY2xpY2sgZXZlbnQgZnJvbSBlbWl0dGluZyBpbiBGaXJlZm94XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5idXR0b25IYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBrZXkgPSBub3JtYWxpemVBcnJvd0tleShldmVudCk7XG5cbiAgICAgICAgaWYgKF90aGlzLmJ1dHRvbktleURvd25IYW5kbGVyc1trZXldKSB7XG4gICAgICAgICAgX3RoaXMuYnV0dG9uS2V5RG93bkhhbmRsZXJzW2tleV0uY2FsbChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5idXR0b25IYW5kbGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBoYW5kbGUgb2RkIGNhc2UgZm9yIFNhZmFyaSBhbmQgRmlyZWZveCB3aGljaFxuICAgICAgICAvLyBkb24ndCBnaXZlIHRoZSBidXR0b24gdGhlIGZvY3VzIHByb3Blcmx5LlxuXG4gICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAoY2FuJ3QgcmVhc29uYWJseSB0ZXN0IHRoaXMpICovXG5cbiAgICAgICAgaWYgKCBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgZXZlbnQudGFyZ2V0LmZvY3VzKCk7XG4gICAgICAgIH0gLy8gdG8gc2ltcGxpZnkgdGVzdGluZyBjb21wb25lbnRzIHRoYXQgdXNlIGRvd25zaGlmdCwgd2UnbGwgbm90IHdyYXAgdGhpcyBpbiBhIHNldFRpbWVvdXRcbiAgICAgICAgLy8gaWYgdGhlIE5PREVfRU5WIGlzIHRlc3QuIFdpdGggdGhlIHByb3BlciBidWlsZCBzeXN0ZW0sIHRoaXMgc2hvdWxkIGJlIGRlYWQgY29kZSBlbGltaW5hdGVkXG4gICAgICAgIC8vIHdoZW4gYnVpbGRpbmcgZm9yIHByb2R1Y3Rpb24gYW5kIHNob3VsZCB0aGVyZWZvcmUgaGF2ZSBubyBpbXBhY3Qgb24gcHJvZHVjdGlvbiBjb2RlLlxuXG5cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAndGVzdCcpIHtcbiAgICAgICAgICBfdGhpcy50b2dnbGVNZW51KHtcbiAgICAgICAgICAgIHR5cGU6IGNsaWNrQnV0dG9uXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRW5zdXJlIHRoYXQgdG9nZ2xlIG9mIG1lbnUgb2NjdXJzIGFmdGVyIHRoZSBwb3RlbnRpYWwgYmx1ciBldmVudCBpbiBpT1NcbiAgICAgICAgICBfdGhpcy5pbnRlcm5hbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnRvZ2dsZU1lbnUoe1xuICAgICAgICAgICAgICB0eXBlOiBjbGlja0J1dHRvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmJ1dHRvbkhhbmRsZUJsdXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGJsdXJUYXJnZXQgPSBldmVudC50YXJnZXQ7IC8vIFNhdmUgYmx1ciB0YXJnZXQgZm9yIGNvbXBhcmlzb24gd2l0aCBhY3RpdmVFbGVtZW50IGxhdGVyXG4gICAgICAgIC8vIE5lZWQgc2V0VGltZW91dCwgc28gdGhhdCB3aGVuIHRoZSB1c2VyIHByZXNzZXMgVGFiLCB0aGUgYWN0aXZlRWxlbWVudCBpcyB0aGUgbmV4dCBmb2N1c2VkIGVsZW1lbnQsIG5vdCBib2R5IGVsZW1lbnRcblxuICAgICAgICBfdGhpcy5pbnRlcm5hbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICghX3RoaXMuaXNNb3VzZURvd24gJiYgKF90aGlzLnByb3BzLmVudmlyb25tZW50LmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT0gbnVsbCB8fCBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5hY3RpdmVFbGVtZW50LmlkICE9PSBfdGhpcy5pbnB1dElkKSAmJiBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9PSBibHVyVGFyZ2V0IC8vIERvIG5vdGhpbmcgaWYgd2UgcmVmb2N1cyB0aGUgc2FtZSBlbGVtZW50IGFnYWluICh0byBzb2x2ZSBpc3N1ZSBpbiBTYWZhcmkgb24gaU9TKVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgICBfdGhpcy5yZXNldCh7XG4gICAgICAgICAgICAgICAgdHlwZTogYmx1ckJ1dHRvblxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5nZXRMYWJlbFByb3BzID0gZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgaHRtbEZvcjogX3RoaXMuaW5wdXRJZCxcbiAgICAgICAgICBpZDogX3RoaXMubGFiZWxJZFxuICAgICAgICB9LCBwcm9wcyk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5nZXRJbnB1dFByb3BzID0gZnVuY3Rpb24gKF90ZW1wNCkge1xuICAgICAgICB2YXIgX3JlZjQgPSBfdGVtcDQgPT09IHZvaWQgMCA/IHt9IDogX3RlbXA0LFxuICAgICAgICAgICAgb25LZXlEb3duID0gX3JlZjQub25LZXlEb3duLFxuICAgICAgICAgICAgb25CbHVyID0gX3JlZjQub25CbHVyLFxuICAgICAgICAgICAgb25DaGFuZ2UgPSBfcmVmNC5vbkNoYW5nZSxcbiAgICAgICAgICAgIG9uSW5wdXQgPSBfcmVmNC5vbklucHV0LFxuICAgICAgICAgICAgb25DaGFuZ2VUZXh0ID0gX3JlZjQub25DaGFuZ2VUZXh0LFxuICAgICAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY0LCBbXCJvbktleURvd25cIiwgXCJvbkJsdXJcIiwgXCJvbkNoYW5nZVwiLCBcIm9uSW5wdXRcIiwgXCJvbkNoYW5nZVRleHRcIl0pO1xuXG4gICAgICAgIHZhciBvbkNoYW5nZUtleTtcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlcnMgPSB7fTtcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKHByZWFjdCkgKi9cblxuICAgICAgICBvbkNoYW5nZUtleSA9ICdvbkNoYW5nZSc7XG5cbiAgICAgICAgdmFyIF90aGlzJGdldFN0YXRlNiA9IF90aGlzLmdldFN0YXRlKCksXG4gICAgICAgICAgICBpbnB1dFZhbHVlID0gX3RoaXMkZ2V0U3RhdGU2LmlucHV0VmFsdWUsXG4gICAgICAgICAgICBpc09wZW4gPSBfdGhpcyRnZXRTdGF0ZTYuaXNPcGVuLFxuICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzJGdldFN0YXRlNi5oaWdobGlnaHRlZEluZGV4O1xuXG4gICAgICAgIGlmICghcmVzdC5kaXNhYmxlZCkge1xuICAgICAgICAgIHZhciBfZXZlbnRIYW5kbGVycztcblxuICAgICAgICAgIGV2ZW50SGFuZGxlcnMgPSAoX2V2ZW50SGFuZGxlcnMgPSB7fSwgX2V2ZW50SGFuZGxlcnNbb25DaGFuZ2VLZXldID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DaGFuZ2UsIG9uSW5wdXQsIF90aGlzLmlucHV0SGFuZGxlQ2hhbmdlKSwgX2V2ZW50SGFuZGxlcnMub25LZXlEb3duID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCBfdGhpcy5pbnB1dEhhbmRsZUtleURvd24pLCBfZXZlbnRIYW5kbGVycy5vbkJsdXIgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkJsdXIsIF90aGlzLmlucHV0SGFuZGxlQmx1ciksIF9ldmVudEhhbmRsZXJzKTtcbiAgICAgICAgfVxuICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKHJlYWN0LW5hdGl2ZSkgKi9cblxuXG4gICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgJ2FyaWEtYXV0b2NvbXBsZXRlJzogJ2xpc3QnLFxuICAgICAgICAgICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiBpc09wZW4gJiYgdHlwZW9mIGhpZ2hsaWdodGVkSW5kZXggPT09ICdudW1iZXInICYmIGhpZ2hsaWdodGVkSW5kZXggPj0gMCA/IF90aGlzLmdldEl0ZW1JZChoaWdobGlnaHRlZEluZGV4KSA6IG51bGwsXG4gICAgICAgICAgJ2FyaWEtY29udHJvbHMnOiBpc09wZW4gPyBfdGhpcy5tZW51SWQgOiBudWxsLFxuICAgICAgICAgICdhcmlhLWxhYmVsbGVkYnknOiBfdGhpcy5sYWJlbElkLFxuICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL1NlY3VyaXR5L1NlY3VyaW5nX3lvdXJfc2l0ZS9UdXJuaW5nX29mZl9mb3JtX2F1dG9jb21wbGV0aW9uXG4gICAgICAgICAgLy8gcmV2ZXJ0IGJhY2sgc2luY2UgYXV0b2NvbXBsZXRlPVwibm9wZVwiIGlzIGlnbm9yZWQgb24gbGF0ZXN0IENocm9tZSBhbmQgT3BlcmFcbiAgICAgICAgICBhdXRvQ29tcGxldGU6ICdvZmYnLFxuICAgICAgICAgIHZhbHVlOiBpbnB1dFZhbHVlLFxuICAgICAgICAgIGlkOiBfdGhpcy5pbnB1dElkXG4gICAgICAgIH0sIGV2ZW50SGFuZGxlcnMsIHJlc3QpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuaW5wdXRIYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBrZXkgPSBub3JtYWxpemVBcnJvd0tleShldmVudCk7XG5cbiAgICAgICAgaWYgKGtleSAmJiBfdGhpcy5pbnB1dEtleURvd25IYW5kbGVyc1trZXldKSB7XG4gICAgICAgICAgX3RoaXMuaW5wdXRLZXlEb3duSGFuZGxlcnNba2V5XS5jYWxsKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCBldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmlucHV0SGFuZGxlQ2hhbmdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIF90aGlzLmludGVybmFsU2V0U3RhdGUoe1xuICAgICAgICAgIHR5cGU6IGNoYW5nZUlucHV0LFxuICAgICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgICBpbnB1dFZhbHVlOiBldmVudC50YXJnZXQudmFsdWUsXG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogX3RoaXMucHJvcHMuZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXhcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5pbnB1dEhhbmRsZUJsdXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIE5lZWQgc2V0VGltZW91dCwgc28gdGhhdCB3aGVuIHRoZSB1c2VyIHByZXNzZXMgVGFiLCB0aGUgYWN0aXZlRWxlbWVudCBpcyB0aGUgbmV4dCBmb2N1c2VkIGVsZW1lbnQsIG5vdCB0aGUgYm9keSBlbGVtZW50XG4gICAgICAgIF90aGlzLmludGVybmFsU2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIGRvd25zaGlmdEJ1dHRvbklzQWN0aXZlID0gX3RoaXMucHJvcHMuZW52aXJvbm1lbnQuZG9jdW1lbnQgJiYgISFfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmICEhX3RoaXMucHJvcHMuZW52aXJvbm1lbnQuZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5kYXRhc2V0ICYmIF90aGlzLnByb3BzLmVudmlyb25tZW50LmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuZGF0YXNldC50b2dnbGUgJiYgX3RoaXMuX3Jvb3ROb2RlICYmIF90aGlzLl9yb290Tm9kZS5jb250YWlucyhfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcblxuICAgICAgICAgIGlmICghX3RoaXMuaXNNb3VzZURvd24gJiYgIWRvd25zaGlmdEJ1dHRvbklzQWN0aXZlKSB7XG4gICAgICAgICAgICBfdGhpcy5yZXNldCh7XG4gICAgICAgICAgICAgIHR5cGU6IGJsdXJJbnB1dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLm1lbnVSZWYgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICBfdGhpcy5fbWVudU5vZGUgPSBub2RlO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuZ2V0TWVudVByb3BzID0gZnVuY3Rpb24gKF90ZW1wNSwgX3RlbXA2KSB7XG4gICAgICAgIHZhciBfZXh0ZW5kczM7XG5cbiAgICAgICAgdmFyIF9yZWY1ID0gX3RlbXA1ID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wNSxcbiAgICAgICAgICAgIF9yZWY1JHJlZktleSA9IF9yZWY1LnJlZktleSxcbiAgICAgICAgICAgIHJlZktleSA9IF9yZWY1JHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmNSRyZWZLZXksXG4gICAgICAgICAgICByZWYgPSBfcmVmNS5yZWYsXG4gICAgICAgICAgICBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY1LCBbXCJyZWZLZXlcIiwgXCJyZWZcIl0pO1xuXG4gICAgICAgIHZhciBfcmVmNiA9IF90ZW1wNiA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDYsXG4gICAgICAgICAgICBfcmVmNiRzdXBwcmVzc1JlZkVycm8gPSBfcmVmNi5zdXBwcmVzc1JlZkVycm9yLFxuICAgICAgICAgICAgc3VwcHJlc3NSZWZFcnJvciA9IF9yZWY2JHN1cHByZXNzUmVmRXJybyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmNiRzdXBwcmVzc1JlZkVycm87XG5cbiAgICAgICAgX3RoaXMuZ2V0TWVudVByb3BzLmNhbGxlZCA9IHRydWU7XG4gICAgICAgIF90aGlzLmdldE1lbnVQcm9wcy5yZWZLZXkgPSByZWZLZXk7XG4gICAgICAgIF90aGlzLmdldE1lbnVQcm9wcy5zdXBwcmVzc1JlZkVycm9yID0gc3VwcHJlc3NSZWZFcnJvcjtcbiAgICAgICAgcmV0dXJuIF9leHRlbmRzKChfZXh0ZW5kczMgPSB7fSwgX2V4dGVuZHMzW3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgX3RoaXMubWVudVJlZiksIF9leHRlbmRzMy5yb2xlID0gJ2xpc3Rib3gnLCBfZXh0ZW5kczNbJ2FyaWEtbGFiZWxsZWRieSddID0gcHJvcHMgJiYgcHJvcHNbJ2FyaWEtbGFiZWwnXSA/IG51bGwgOiBfdGhpcy5sYWJlbElkLCBfZXh0ZW5kczMuaWQgPSBfdGhpcy5tZW51SWQsIF9leHRlbmRzMyksIHByb3BzKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmdldEl0ZW1Qcm9wcyA9IGZ1bmN0aW9uIChfdGVtcDcpIHtcbiAgICAgICAgdmFyIF9lbmFibGVkRXZlbnRIYW5kbGVycztcblxuICAgICAgICB2YXIgX3JlZjcgPSBfdGVtcDcgPT09IHZvaWQgMCA/IHt9IDogX3RlbXA3LFxuICAgICAgICAgICAgb25Nb3VzZU1vdmUgPSBfcmVmNy5vbk1vdXNlTW92ZSxcbiAgICAgICAgICAgIG9uTW91c2VEb3duID0gX3JlZjcub25Nb3VzZURvd24sXG4gICAgICAgICAgICBvbkNsaWNrID0gX3JlZjcub25DbGljayxcbiAgICAgICAgICAgIG9uUHJlc3MgPSBfcmVmNy5vblByZXNzLFxuICAgICAgICAgICAgaW5kZXggPSBfcmVmNy5pbmRleCxcbiAgICAgICAgICAgIF9yZWY3JGl0ZW0gPSBfcmVmNy5pdGVtLFxuICAgICAgICAgICAgaXRlbSA9IF9yZWY3JGl0ZW0gPT09IHZvaWQgMCA/IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgP1xuICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICB1bmRlZmluZWQgOiByZXF1aXJlZFByb3AoJ2dldEl0ZW1Qcm9wcycsICdpdGVtJykgOiBfcmVmNyRpdGVtLFxuICAgICAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY3LCBbXCJvbk1vdXNlTW92ZVwiLCBcIm9uTW91c2VEb3duXCIsIFwib25DbGlja1wiLCBcIm9uUHJlc3NcIiwgXCJpbmRleFwiLCBcIml0ZW1cIl0pO1xuXG4gICAgICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgX3RoaXMuaXRlbXMucHVzaChpdGVtKTtcblxuICAgICAgICAgIGluZGV4ID0gX3RoaXMuaXRlbXMuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5pdGVtc1tpbmRleF0gPSBpdGVtO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG9uU2VsZWN0S2V5ID0gJ29uQ2xpY2snO1xuICAgICAgICB2YXIgY3VzdG9tQ2xpY2tIYW5kbGVyID0gb25DbGljaztcbiAgICAgICAgdmFyIGVuYWJsZWRFdmVudEhhbmRsZXJzID0gKF9lbmFibGVkRXZlbnRIYW5kbGVycyA9IHtcbiAgICAgICAgICAvLyBvbk1vdXNlTW92ZSBpcyB1c2VkIG92ZXIgb25Nb3VzZUVudGVyIGhlcmUuIG9uTW91c2VNb3ZlXG4gICAgICAgICAgLy8gaXMgb25seSB0cmlnZ2VyZWQgb24gYWN0dWFsIG1vdXNlIG1vdmVtZW50IHdoaWxlIG9uTW91c2VFbnRlclxuICAgICAgICAgIC8vIGNhbiBmaXJlIG9uIERPTSBjaGFuZ2VzLCBpbnRlcnJ1cHRpbmcga2V5Ym9hcmQgbmF2aWdhdGlvblxuICAgICAgICAgIG9uTW91c2VNb3ZlOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbk1vdXNlTW92ZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSBfdGhpcy5nZXRTdGF0ZSgpLmhpZ2hsaWdodGVkSW5kZXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfdGhpcy5zZXRIaWdobGlnaHRlZEluZGV4KGluZGV4LCB7XG4gICAgICAgICAgICAgIHR5cGU6IGl0ZW1Nb3VzZUVudGVyXG4gICAgICAgICAgICB9KTsgLy8gV2UgbmV2ZXIgd2FudCB0byBtYW51YWxseSBzY3JvbGwgd2hlbiBjaGFuZ2luZyBzdGF0ZSBiYXNlZFxuICAgICAgICAgICAgLy8gb24gYG9uTW91c2VNb3ZlYCBiZWNhdXNlIHdlIHdpbGwgYmUgbW92aW5nIHRoZSBlbGVtZW50IG91dFxuICAgICAgICAgICAgLy8gZnJvbSB1bmRlciB0aGUgdXNlciB3aGljaCBpcyBjdXJyZW50bHkgc2Nyb2xsaW5nL21vdmluZyB0aGVcbiAgICAgICAgICAgIC8vIGN1cnNvclxuXG5cbiAgICAgICAgICAgIF90aGlzLmF2b2lkU2Nyb2xsaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmF2b2lkU2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9LCAyNTApO1xuICAgICAgICAgIH0pLFxuICAgICAgICAgIG9uTW91c2VEb3duOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbk1vdXNlRG93biwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAvLyBUaGlzIHByZXZlbnRzIHRoZSBhY3RpdmVFbGVtZW50IGZyb20gYmVpbmcgY2hhbmdlZFxuICAgICAgICAgICAgLy8gdG8gdGhlIGl0ZW0gc28gaXQgY2FuIHJlbWFpbiB3aXRoIHRoZSBjdXJyZW50IGFjdGl2ZUVsZW1lbnRcbiAgICAgICAgICAgIC8vIHdoaWNoIGlzIGEgbW9yZSBjb21tb24gdXNlIGNhc2UuXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIH0pXG4gICAgICAgIH0sIF9lbmFibGVkRXZlbnRIYW5kbGVyc1tvblNlbGVjdEtleV0gPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhjdXN0b21DbGlja0hhbmRsZXIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpcy5zZWxlY3RJdGVtQXRJbmRleChpbmRleCwge1xuICAgICAgICAgICAgdHlwZTogY2xpY2tJdGVtXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pLCBfZW5hYmxlZEV2ZW50SGFuZGxlcnMpOyAvLyBQYXNzaW5nIGRvd24gdGhlIG9uTW91c2VEb3duIGhhbmRsZXIgdG8gcHJldmVudCByZWRpcmVjdFxuICAgICAgICAvLyBvZiB0aGUgYWN0aXZlRWxlbWVudCBpZiBjbGlja2luZyBvbiBkaXNhYmxlZCBpdGVtc1xuXG4gICAgICAgIHZhciBldmVudEhhbmRsZXJzID0gcmVzdC5kaXNhYmxlZCA/IHtcbiAgICAgICAgICBvbk1vdXNlRG93bjogZW5hYmxlZEV2ZW50SGFuZGxlcnMub25Nb3VzZURvd25cbiAgICAgICAgfSA6IGVuYWJsZWRFdmVudEhhbmRsZXJzO1xuICAgICAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgICAgIGlkOiBfdGhpcy5nZXRJdGVtSWQoaW5kZXgpLFxuICAgICAgICAgIHJvbGU6ICdvcHRpb24nLFxuICAgICAgICAgICdhcmlhLXNlbGVjdGVkJzogX3RoaXMuZ2V0U3RhdGUoKS5oaWdobGlnaHRlZEluZGV4ID09PSBpbmRleFxuICAgICAgICB9LCBldmVudEhhbmRsZXJzLCByZXN0KTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmNsZWFySXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLml0ZW1zID0gW107XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5yZXNldCA9IGZ1bmN0aW9uIChvdGhlclN0YXRlVG9TZXQsIGNiKSB7XG4gICAgICAgIGlmIChvdGhlclN0YXRlVG9TZXQgPT09IHZvaWQgMCkge1xuICAgICAgICAgIG90aGVyU3RhdGVUb1NldCA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0gcGlja1N0YXRlKG90aGVyU3RhdGVUb1NldCk7XG5cbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZShmdW5jdGlvbiAoX3JlZjgpIHtcbiAgICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtID0gX3JlZjguc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgICBpc09wZW46IF90aGlzLnByb3BzLmRlZmF1bHRJc09wZW4sXG4gICAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBfdGhpcy5wcm9wcy5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICAgIGlucHV0VmFsdWU6IF90aGlzLnByb3BzLml0ZW1Ub1N0cmluZyhzZWxlY3RlZEl0ZW0pXG4gICAgICAgICAgfSwgb3RoZXJTdGF0ZVRvU2V0KTtcbiAgICAgICAgfSwgY2IpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMudG9nZ2xlTWVudSA9IGZ1bmN0aW9uIChvdGhlclN0YXRlVG9TZXQsIGNiKSB7XG4gICAgICAgIGlmIChvdGhlclN0YXRlVG9TZXQgPT09IHZvaWQgMCkge1xuICAgICAgICAgIG90aGVyU3RhdGVUb1NldCA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0gcGlja1N0YXRlKG90aGVyU3RhdGVUb1NldCk7XG5cbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZShmdW5jdGlvbiAoX3JlZjkpIHtcbiAgICAgICAgICB2YXIgaXNPcGVuID0gX3JlZjkuaXNPcGVuO1xuICAgICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgICBpc09wZW46ICFpc09wZW5cbiAgICAgICAgICB9LCBpc09wZW4gJiYge1xuICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogX3RoaXMucHJvcHMuZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXhcbiAgICAgICAgICB9LCBvdGhlclN0YXRlVG9TZXQpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIF90aGlzJGdldFN0YXRlNyA9IF90aGlzLmdldFN0YXRlKCksXG4gICAgICAgICAgICAgIGlzT3BlbiA9IF90aGlzJGdldFN0YXRlNy5pc09wZW4sXG4gICAgICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcyRnZXRTdGF0ZTcuaGlnaGxpZ2h0ZWRJbmRleDtcblxuICAgICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5nZXRJdGVtQ291bnQoKSA+IDAgJiYgdHlwZW9mIGhpZ2hsaWdodGVkSW5kZXggPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgIF90aGlzLnNldEhpZ2hsaWdodGVkSW5kZXgoaGlnaGxpZ2h0ZWRJbmRleCwgb3RoZXJTdGF0ZVRvU2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjYlRvQ2IoY2IpKCk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMub3Blbk1lbnUgPSBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZSh7XG4gICAgICAgICAgaXNPcGVuOiB0cnVlXG4gICAgICAgIH0sIGNiKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmNsb3NlTWVudSA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICBfdGhpcy5pbnRlcm5hbFNldFN0YXRlKHtcbiAgICAgICAgICBpc09wZW46IGZhbHNlXG4gICAgICAgIH0sIGNiKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLnVwZGF0ZVN0YXR1cyA9IGRlYm91bmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXRlID0gX3RoaXMuZ2V0U3RhdGUoKTtcblxuICAgICAgICB2YXIgaXRlbSA9IF90aGlzLml0ZW1zW3N0YXRlLmhpZ2hsaWdodGVkSW5kZXhdO1xuXG4gICAgICAgIHZhciByZXN1bHRDb3VudCA9IF90aGlzLmdldEl0ZW1Db3VudCgpO1xuXG4gICAgICAgIHZhciBzdGF0dXMgPSBfdGhpcy5wcm9wcy5nZXRBMTF5U3RhdHVzTWVzc2FnZShfZXh0ZW5kcyh7XG4gICAgICAgICAgaXRlbVRvU3RyaW5nOiBfdGhpcy5wcm9wcy5pdGVtVG9TdHJpbmcsXG4gICAgICAgICAgcHJldmlvdXNSZXN1bHRDb3VudDogX3RoaXMucHJldmlvdXNSZXN1bHRDb3VudCxcbiAgICAgICAgICByZXN1bHRDb3VudDogcmVzdWx0Q291bnQsXG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJdGVtOiBpdGVtXG4gICAgICAgIH0sIHN0YXRlKSk7XG5cbiAgICAgICAgX3RoaXMucHJldmlvdXNSZXN1bHRDb3VudCA9IHJlc3VsdENvdW50O1xuICAgICAgICBzZXRTdGF0dXMoc3RhdHVzLCBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudCk7XG4gICAgICB9LCAyMDApO1xuXG4gICAgICAvLyBmYW5jeSBkZXN0cnVjdHVyaW5nICsgZGVmYXVsdHMgKyBhbGlhc2VzXG4gICAgICAvLyB0aGlzIGJhc2ljYWxseSBzYXlzIGVhY2ggdmFsdWUgb2Ygc3RhdGUgc2hvdWxkIGVpdGhlciBiZSBzZXQgdG9cbiAgICAgIC8vIHRoZSBpbml0aWFsIHZhbHVlIG9yIHRoZSBkZWZhdWx0IHZhbHVlIGlmIHRoZSBpbml0aWFsIHZhbHVlIGlzIG5vdCBwcm92aWRlZFxuICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsXG4gICAgICAgICAgZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcyRwcm9wcy5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBfdGhpcyRwcm9wcyRpbml0aWFsSGkgPSBfdGhpcyRwcm9wcy5pbml0aWFsSGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBfaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzJHByb3BzJGluaXRpYWxIaSA9PT0gdm9pZCAwID8gZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXggOiBfdGhpcyRwcm9wcyRpbml0aWFsSGksXG4gICAgICAgICAgZGVmYXVsdElzT3BlbiA9IF90aGlzJHByb3BzLmRlZmF1bHRJc09wZW4sXG4gICAgICAgICAgX3RoaXMkcHJvcHMkaW5pdGlhbElzID0gX3RoaXMkcHJvcHMuaW5pdGlhbElzT3BlbixcbiAgICAgICAgICBfaXNPcGVuID0gX3RoaXMkcHJvcHMkaW5pdGlhbElzID09PSB2b2lkIDAgPyBkZWZhdWx0SXNPcGVuIDogX3RoaXMkcHJvcHMkaW5pdGlhbElzLFxuICAgICAgICAgIF90aGlzJHByb3BzJGluaXRpYWxJbiA9IF90aGlzJHByb3BzLmluaXRpYWxJbnB1dFZhbHVlLFxuICAgICAgICAgIF9pbnB1dFZhbHVlID0gX3RoaXMkcHJvcHMkaW5pdGlhbEluID09PSB2b2lkIDAgPyAnJyA6IF90aGlzJHByb3BzJGluaXRpYWxJbixcbiAgICAgICAgICBfdGhpcyRwcm9wcyRpbml0aWFsU2UgPSBfdGhpcyRwcm9wcy5pbml0aWFsU2VsZWN0ZWRJdGVtLFxuICAgICAgICAgIF9zZWxlY3RlZEl0ZW0gPSBfdGhpcyRwcm9wcyRpbml0aWFsU2UgPT09IHZvaWQgMCA/IG51bGwgOiBfdGhpcyRwcm9wcyRpbml0aWFsU2U7XG5cbiAgICAgIHZhciBfc3RhdGUgPSBfdGhpcy5nZXRTdGF0ZSh7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IF9oaWdobGlnaHRlZEluZGV4LFxuICAgICAgICBpc09wZW46IF9pc09wZW4sXG4gICAgICAgIGlucHV0VmFsdWU6IF9pbnB1dFZhbHVlLFxuICAgICAgICBzZWxlY3RlZEl0ZW06IF9zZWxlY3RlZEl0ZW1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoX3N0YXRlLnNlbGVjdGVkSXRlbSAhPSBudWxsICYmIF90aGlzLnByb3BzLmluaXRpYWxJbnB1dFZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgX3N0YXRlLmlucHV0VmFsdWUgPSBfdGhpcy5wcm9wcy5pdGVtVG9TdHJpbmcoX3N0YXRlLnNlbGVjdGVkSXRlbSk7XG4gICAgICB9XG5cbiAgICAgIF90aGlzLnN0YXRlID0gX3N0YXRlO1xuICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIHZhciBfcHJvdG8gPSBEb3duc2hpZnQucHJvdG90eXBlO1xuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgYWxsIHJ1bm5pbmcgdGltZW91dHNcbiAgICAgKi9cbiAgICBfcHJvdG8uaW50ZXJuYWxDbGVhclRpbWVvdXRzID0gZnVuY3Rpb24gaW50ZXJuYWxDbGVhclRpbWVvdXRzKCkge1xuICAgICAgdGhpcy50aW1lb3V0SWRzLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChpZCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMudGltZW91dElkcyA9IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBzdGF0ZSBiYXNlZCBvbiBpbnRlcm5hbCBzdGF0ZSBvciBwcm9wc1xuICAgICAqIElmIGEgc3RhdGUgdmFsdWUgaXMgcGFzc2VkIHZpYSBwcm9wcywgdGhlbiB0aGF0XG4gICAgICogaXMgdGhlIHZhbHVlIGdpdmVuLCBvdGhlcndpc2UgaXQncyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHN0YXRlVG9NZXJnZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHN0YXRlVG9NZXJnZSBkZWZhdWx0cyB0byB0aGlzLnN0YXRlXG4gICAgICogQHJldHVybiB7T2JqZWN0fSB0aGUgc3RhdGVcbiAgICAgKi9cbiAgICA7XG5cbiAgICBfcHJvdG8uZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSQxKHN0YXRlVG9NZXJnZSkge1xuICAgICAgaWYgKHN0YXRlVG9NZXJnZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHN0YXRlVG9NZXJnZSA9IHRoaXMuc3RhdGU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBnZXRTdGF0ZShzdGF0ZVRvTWVyZ2UsIHRoaXMucHJvcHMpO1xuICAgIH07XG5cbiAgICBfcHJvdG8uZ2V0SXRlbUNvdW50ID0gZnVuY3Rpb24gZ2V0SXRlbUNvdW50KCkge1xuICAgICAgLy8gdGhpbmdzIHJlYWQgYmV0dGVyIHRoaXMgd2F5LiBUaGV5J3JlIGluIHByaW9yaXR5IG9yZGVyOlxuICAgICAgLy8gMS4gYHRoaXMuaXRlbUNvdW50YFxuICAgICAgLy8gMi4gYHRoaXMucHJvcHMuaXRlbUNvdW50YFxuICAgICAgLy8gMy4gYHRoaXMuaXRlbXMubGVuZ3RoYFxuICAgICAgdmFyIGl0ZW1Db3VudCA9IHRoaXMuaXRlbXMubGVuZ3RoO1xuXG4gICAgICBpZiAodGhpcy5pdGVtQ291bnQgIT0gbnVsbCkge1xuICAgICAgICBpdGVtQ291bnQgPSB0aGlzLml0ZW1Db3VudDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5pdGVtQ291bnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpdGVtQ291bnQgPSB0aGlzLnByb3BzLml0ZW1Db3VudDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGl0ZW1Db3VudDtcbiAgICB9O1xuXG4gICAgX3Byb3RvLmdldEl0ZW1Ob2RlRnJvbUluZGV4ID0gZnVuY3Rpb24gZ2V0SXRlbU5vZGVGcm9tSW5kZXgoaW5kZXgpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb3BzLmVudmlyb25tZW50LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZ2V0SXRlbUlkKGluZGV4KSk7XG4gICAgfTtcblxuICAgIF9wcm90by5zY3JvbGxIaWdobGlnaHRlZEl0ZW1JbnRvVmlldyA9IGZ1bmN0aW9uIHNjcm9sbEhpZ2hsaWdodGVkSXRlbUludG9WaWV3KCkge1xuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKHJlYWN0LW5hdGl2ZSkgKi9cbiAgICAgIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmdldEl0ZW1Ob2RlRnJvbUluZGV4KHRoaXMuZ2V0U3RhdGUoKS5oaWdobGlnaHRlZEluZGV4KTtcbiAgICAgICAgdGhpcy5wcm9wcy5zY3JvbGxJbnRvVmlldyhub2RlLCB0aGlzLl9tZW51Tm9kZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF9wcm90by5tb3ZlSGlnaGxpZ2h0ZWRJbmRleCA9IGZ1bmN0aW9uIG1vdmVIaWdobGlnaHRlZEluZGV4KGFtb3VudCwgb3RoZXJTdGF0ZVRvU2V0KSB7XG4gICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgICAgdmFyIGl0ZW1Db3VudCA9IHRoaXMuZ2V0SXRlbUNvdW50KCk7XG5cbiAgICAgIHZhciBfdGhpcyRnZXRTdGF0ZTggPSB0aGlzLmdldFN0YXRlKCksXG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzJGdldFN0YXRlOC5oaWdobGlnaHRlZEluZGV4O1xuXG4gICAgICBpZiAoaXRlbUNvdW50ID4gMCkge1xuICAgICAgICB2YXIgbmV4dEhpZ2hsaWdodGVkSW5kZXggPSBnZXROZXh0V3JhcHBpbmdJbmRleChhbW91bnQsIGhpZ2hsaWdodGVkSW5kZXgsIGl0ZW1Db3VudCwgZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzNi5nZXRJdGVtTm9kZUZyb21JbmRleChpbmRleCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldEhpZ2hsaWdodGVkSW5kZXgobmV4dEhpZ2hsaWdodGVkSW5kZXgsIG90aGVyU3RhdGVUb1NldCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF9wcm90by5nZXRTdGF0ZUFuZEhlbHBlcnMgPSBmdW5jdGlvbiBnZXRTdGF0ZUFuZEhlbHBlcnMoKSB7XG4gICAgICB2YXIgX3RoaXMkZ2V0U3RhdGU5ID0gdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcyRnZXRTdGF0ZTkuaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBpbnB1dFZhbHVlID0gX3RoaXMkZ2V0U3RhdGU5LmlucHV0VmFsdWUsXG4gICAgICAgICAgc2VsZWN0ZWRJdGVtID0gX3RoaXMkZ2V0U3RhdGU5LnNlbGVjdGVkSXRlbSxcbiAgICAgICAgICBpc09wZW4gPSBfdGhpcyRnZXRTdGF0ZTkuaXNPcGVuO1xuXG4gICAgICB2YXIgaXRlbVRvU3RyaW5nID0gdGhpcy5wcm9wcy5pdGVtVG9TdHJpbmc7XG4gICAgICB2YXIgaWQgPSB0aGlzLmlkO1xuICAgICAgdmFyIGdldFJvb3RQcm9wcyA9IHRoaXMuZ2V0Um9vdFByb3BzLFxuICAgICAgICAgIGdldFRvZ2dsZUJ1dHRvblByb3BzID0gdGhpcy5nZXRUb2dnbGVCdXR0b25Qcm9wcyxcbiAgICAgICAgICBnZXRMYWJlbFByb3BzID0gdGhpcy5nZXRMYWJlbFByb3BzLFxuICAgICAgICAgIGdldE1lbnVQcm9wcyA9IHRoaXMuZ2V0TWVudVByb3BzLFxuICAgICAgICAgIGdldElucHV0UHJvcHMgPSB0aGlzLmdldElucHV0UHJvcHMsXG4gICAgICAgICAgZ2V0SXRlbVByb3BzID0gdGhpcy5nZXRJdGVtUHJvcHMsXG4gICAgICAgICAgb3Blbk1lbnUgPSB0aGlzLm9wZW5NZW51LFxuICAgICAgICAgIGNsb3NlTWVudSA9IHRoaXMuY2xvc2VNZW51LFxuICAgICAgICAgIHRvZ2dsZU1lbnUgPSB0aGlzLnRvZ2dsZU1lbnUsXG4gICAgICAgICAgc2VsZWN0SXRlbSA9IHRoaXMuc2VsZWN0SXRlbSxcbiAgICAgICAgICBzZWxlY3RJdGVtQXRJbmRleCA9IHRoaXMuc2VsZWN0SXRlbUF0SW5kZXgsXG4gICAgICAgICAgc2VsZWN0SGlnaGxpZ2h0ZWRJdGVtID0gdGhpcy5zZWxlY3RIaWdobGlnaHRlZEl0ZW0sXG4gICAgICAgICAgc2V0SGlnaGxpZ2h0ZWRJbmRleCA9IHRoaXMuc2V0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBjbGVhclNlbGVjdGlvbiA9IHRoaXMuY2xlYXJTZWxlY3Rpb24sXG4gICAgICAgICAgY2xlYXJJdGVtcyA9IHRoaXMuY2xlYXJJdGVtcyxcbiAgICAgICAgICByZXNldCA9IHRoaXMucmVzZXQsXG4gICAgICAgICAgc2V0SXRlbUNvdW50ID0gdGhpcy5zZXRJdGVtQ291bnQsXG4gICAgICAgICAgdW5zZXRJdGVtQ291bnQgPSB0aGlzLnVuc2V0SXRlbUNvdW50LFxuICAgICAgICAgIHNldFN0YXRlID0gdGhpcy5pbnRlcm5hbFNldFN0YXRlO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLy8gcHJvcCBnZXR0ZXJzXG4gICAgICAgIGdldFJvb3RQcm9wczogZ2V0Um9vdFByb3BzLFxuICAgICAgICBnZXRUb2dnbGVCdXR0b25Qcm9wczogZ2V0VG9nZ2xlQnV0dG9uUHJvcHMsXG4gICAgICAgIGdldExhYmVsUHJvcHM6IGdldExhYmVsUHJvcHMsXG4gICAgICAgIGdldE1lbnVQcm9wczogZ2V0TWVudVByb3BzLFxuICAgICAgICBnZXRJbnB1dFByb3BzOiBnZXRJbnB1dFByb3BzLFxuICAgICAgICBnZXRJdGVtUHJvcHM6IGdldEl0ZW1Qcm9wcyxcbiAgICAgICAgLy8gYWN0aW9uc1xuICAgICAgICByZXNldDogcmVzZXQsXG4gICAgICAgIG9wZW5NZW51OiBvcGVuTWVudSxcbiAgICAgICAgY2xvc2VNZW51OiBjbG9zZU1lbnUsXG4gICAgICAgIHRvZ2dsZU1lbnU6IHRvZ2dsZU1lbnUsXG4gICAgICAgIHNlbGVjdEl0ZW06IHNlbGVjdEl0ZW0sXG4gICAgICAgIHNlbGVjdEl0ZW1BdEluZGV4OiBzZWxlY3RJdGVtQXRJbmRleCxcbiAgICAgICAgc2VsZWN0SGlnaGxpZ2h0ZWRJdGVtOiBzZWxlY3RIaWdobGlnaHRlZEl0ZW0sXG4gICAgICAgIHNldEhpZ2hsaWdodGVkSW5kZXg6IHNldEhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICAgIGNsZWFyU2VsZWN0aW9uOiBjbGVhclNlbGVjdGlvbixcbiAgICAgICAgY2xlYXJJdGVtczogY2xlYXJJdGVtcyxcbiAgICAgICAgc2V0SXRlbUNvdW50OiBzZXRJdGVtQ291bnQsXG4gICAgICAgIHVuc2V0SXRlbUNvdW50OiB1bnNldEl0ZW1Db3VudCxcbiAgICAgICAgc2V0U3RhdGU6IHNldFN0YXRlLFxuICAgICAgICAvLyBwcm9wc1xuICAgICAgICBpdGVtVG9TdHJpbmc6IGl0ZW1Ub1N0cmluZyxcbiAgICAgICAgLy8gZGVyaXZlZFxuICAgICAgICBpZDogaWQsXG4gICAgICAgIC8vIHN0YXRlXG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICAgIGlucHV0VmFsdWU6IGlucHV0VmFsdWUsXG4gICAgICAgIGlzT3BlbjogaXNPcGVuLFxuICAgICAgICBzZWxlY3RlZEl0ZW06IHNlbGVjdGVkSXRlbVxuICAgICAgfTtcbiAgICB9IC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gUk9PVFxuICAgIDtcblxuICAgIF9wcm90by5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAocmVhY3QtbmF0aXZlKSAqL1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIWZhbHNlICYmIHRoaXMuZ2V0TWVudVByb3BzLmNhbGxlZCAmJiAhdGhpcy5nZXRNZW51UHJvcHMuc3VwcHJlc3NSZWZFcnJvcikge1xuICAgICAgICB2YWxpZGF0ZUdldE1lbnVQcm9wc0NhbGxlZENvcnJlY3RseSh0aGlzLl9tZW51Tm9kZSwgdGhpcy5nZXRNZW51UHJvcHMpO1xuICAgICAgfVxuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmIChyZWFjdC1uYXRpdmUpICovXG5cblxuICAgICAge1xuICAgICAgICAvLyB0aGlzLmlzTW91c2VEb3duIGhlbHBzIHVzIHRyYWNrIHdoZXRoZXIgdGhlIG1vdXNlIGlzIGN1cnJlbnRseSBoZWxkIGRvd24uXG4gICAgICAgIC8vIFRoaXMgaXMgdXNlZnVsIHdoZW4gdGhlIHVzZXIgY2xpY2tzIG9uIGFuIGl0ZW0gaW4gdGhlIGxpc3QsIGJ1dCBob2xkcyB0aGUgbW91c2VcbiAgICAgICAgLy8gZG93biBsb25nIGVub3VnaCBmb3IgdGhlIGxpc3QgdG8gZGlzYXBwZWFyIChiZWNhdXNlIHRoZSBibHVyIGV2ZW50IGZpcmVzIG9uIHRoZSBpbnB1dClcbiAgICAgICAgLy8gdGhpcy5pc01vdXNlRG93biBpcyB1c2VkIGluIHRoZSBibHVyIGhhbmRsZXIgb24gdGhlIGlucHV0IHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBibHVyIGV2ZW50IHNob3VsZFxuICAgICAgICAvLyB0cmlnZ2VyIGhpZGluZyB0aGUgbWVudS5cbiAgICAgICAgdmFyIG9uTW91c2VEb3duID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzNy5pc01vdXNlRG93biA9IHRydWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIG9uTW91c2VVcCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIF90aGlzNy5pc01vdXNlRG93biA9IGZhbHNlOyAvLyBpZiB0aGUgdGFyZ2V0IGVsZW1lbnQgb3IgdGhlIGFjdGl2ZUVsZW1lbnQgaXMgd2l0aGluIGEgZG93bnNoaWZ0IG5vZGVcbiAgICAgICAgICAvLyB0aGVuIHdlIGRvbid0IHdhbnQgdG8gcmVzZXQgZG93bnNoaWZ0XG5cbiAgICAgICAgICB2YXIgY29udGV4dFdpdGhpbkRvd25zaGlmdCA9IHRhcmdldFdpdGhpbkRvd25zaGlmdChldmVudC50YXJnZXQsIFtfdGhpczcuX3Jvb3ROb2RlLCBfdGhpczcuX21lbnVOb2RlXSwgX3RoaXM3LnByb3BzLmVudmlyb25tZW50LmRvY3VtZW50KTtcblxuICAgICAgICAgIGlmICghY29udGV4dFdpdGhpbkRvd25zaGlmdCAmJiBfdGhpczcuZ2V0U3RhdGUoKS5pc09wZW4pIHtcbiAgICAgICAgICAgIF90aGlzNy5yZXNldCh7XG4gICAgICAgICAgICAgIHR5cGU6IG1vdXNlVXBcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNy5wcm9wcy5vbk91dGVyQ2xpY2soX3RoaXM3LmdldFN0YXRlQW5kSGVscGVycygpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTsgLy8gVG91Y2hpbmcgYW4gZWxlbWVudCBpbiBpT1MgZ2l2ZXMgZm9jdXMgYW5kIGhvdmVyIHN0YXRlcywgYnV0IHRvdWNoaW5nIG91dCBvZlxuICAgICAgICAvLyB0aGUgZWxlbWVudCB3aWxsIHJlbW92ZSBob3ZlciwgYW5kIHBlcnNpc3QgdGhlIGZvY3VzIHN0YXRlLCByZXN1bHRpbmcgaW4gdGhlXG4gICAgICAgIC8vIGJsdXIgZXZlbnQgbm90IGJlaW5nIHRyaWdnZXJlZC5cbiAgICAgICAgLy8gdGhpcy5pc1RvdWNoTW92ZSBoZWxwcyB1cyB0cmFjayB3aGV0aGVyIHRoZSB1c2VyIGlzIHRhcHBpbmcgb3Igc3dpcGluZyBvbiBhIHRvdWNoIHNjcmVlbi5cbiAgICAgICAgLy8gSWYgdGhlIHVzZXIgdGFwcyBvdXRzaWRlIG9mIERvd25zaGlmdCwgdGhlIGNvbXBvbmVudCBzaG91bGQgYmUgcmVzZXQsXG4gICAgICAgIC8vIGJ1dCBub3QgaWYgdGhlIHVzZXIgaXMgc3dpcGluZ1xuXG5cbiAgICAgICAgdmFyIG9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczcuaXNUb3VjaE1vdmUgPSBmYWxzZTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgb25Ub3VjaE1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXM3LmlzVG91Y2hNb3ZlID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgb25Ub3VjaEVuZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIHZhciBjb250ZXh0V2l0aGluRG93bnNoaWZ0ID0gdGFyZ2V0V2l0aGluRG93bnNoaWZ0KGV2ZW50LnRhcmdldCwgW190aGlzNy5fcm9vdE5vZGUsIF90aGlzNy5fbWVudU5vZGVdLCBfdGhpczcucHJvcHMuZW52aXJvbm1lbnQuZG9jdW1lbnQsIGZhbHNlKTtcblxuICAgICAgICAgIGlmICghX3RoaXM3LmlzVG91Y2hNb3ZlICYmICFjb250ZXh0V2l0aGluRG93bnNoaWZ0ICYmIF90aGlzNy5nZXRTdGF0ZSgpLmlzT3Blbikge1xuICAgICAgICAgICAgX3RoaXM3LnJlc2V0KHtcbiAgICAgICAgICAgICAgdHlwZTogdG91Y2hFbmRcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNy5wcm9wcy5vbk91dGVyQ2xpY2soX3RoaXM3LmdldFN0YXRlQW5kSGVscGVycygpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZW52aXJvbm1lbnQgPSB0aGlzLnByb3BzLmVudmlyb25tZW50O1xuICAgICAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbk1vdXNlRG93bik7XG4gICAgICAgIGVudmlyb25tZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApO1xuICAgICAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgb25Ub3VjaFN0YXJ0KTtcbiAgICAgICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpO1xuXG4gICAgICAgIHRoaXMuY2xlYW51cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczcuaW50ZXJuYWxDbGVhclRpbWVvdXRzKCk7XG5cbiAgICAgICAgICBfdGhpczcudXBkYXRlU3RhdHVzLmNhbmNlbCgpO1xuXG4gICAgICAgICAgZW52aXJvbm1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25Nb3VzZURvd24pO1xuICAgICAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApO1xuICAgICAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQpO1xuICAgICAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlKTtcbiAgICAgICAgICBlbnZpcm9ubWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfcHJvdG8uc2hvdWxkU2Nyb2xsID0gZnVuY3Rpb24gc2hvdWxkU2Nyb2xsKHByZXZTdGF0ZSwgcHJldlByb3BzKSB7XG4gICAgICB2YXIgX3JlZjEwID0gdGhpcy5wcm9wcy5oaWdobGlnaHRlZEluZGV4ID09PSB1bmRlZmluZWQgPyB0aGlzLmdldFN0YXRlKCkgOiB0aGlzLnByb3BzLFxuICAgICAgICAgIGN1cnJlbnRIaWdobGlnaHRlZEluZGV4ID0gX3JlZjEwLmhpZ2hsaWdodGVkSW5kZXg7XG5cbiAgICAgIHZhciBfcmVmMTEgPSBwcmV2UHJvcHMuaGlnaGxpZ2h0ZWRJbmRleCA9PT0gdW5kZWZpbmVkID8gcHJldlN0YXRlIDogcHJldlByb3BzLFxuICAgICAgICAgIHByZXZIaWdobGlnaHRlZEluZGV4ID0gX3JlZjExLmhpZ2hsaWdodGVkSW5kZXg7XG5cbiAgICAgIHZhciBzY3JvbGxXaGVuT3BlbiA9IGN1cnJlbnRIaWdobGlnaHRlZEluZGV4ICYmIHRoaXMuZ2V0U3RhdGUoKS5pc09wZW4gJiYgIXByZXZTdGF0ZS5pc09wZW47XG4gICAgICByZXR1cm4gc2Nyb2xsV2hlbk9wZW4gfHwgY3VycmVudEhpZ2hsaWdodGVkSW5kZXggIT09IHByZXZIaWdobGlnaHRlZEluZGV4O1xuICAgIH07XG5cbiAgICBfcHJvdG8uY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICB2YWxpZGF0ZUNvbnRyb2xsZWRVbmNoYW5nZWQodGhpcy5zdGF0ZSwgcHJldlByb3BzLCB0aGlzLnByb3BzKTtcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmIChyZWFjdC1uYXRpdmUpICovXG5cbiAgICAgICAgaWYgKCB0aGlzLmdldE1lbnVQcm9wcy5jYWxsZWQgJiYgIXRoaXMuZ2V0TWVudVByb3BzLnN1cHByZXNzUmVmRXJyb3IpIHtcbiAgICAgICAgICB2YWxpZGF0ZUdldE1lbnVQcm9wc0NhbGxlZENvcnJlY3RseSh0aGlzLl9tZW51Tm9kZSwgdGhpcy5nZXRNZW51UHJvcHMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0NvbnRyb2xsZWRQcm9wKHRoaXMucHJvcHMsICdzZWxlY3RlZEl0ZW0nKSAmJiB0aGlzLnByb3BzLnNlbGVjdGVkSXRlbUNoYW5nZWQocHJldlByb3BzLnNlbGVjdGVkSXRlbSwgdGhpcy5wcm9wcy5zZWxlY3RlZEl0ZW0pKSB7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxTZXRTdGF0ZSh7XG4gICAgICAgICAgdHlwZTogY29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtLFxuICAgICAgICAgIGlucHV0VmFsdWU6IHRoaXMucHJvcHMuaXRlbVRvU3RyaW5nKHRoaXMucHJvcHMuc2VsZWN0ZWRJdGVtKVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLmF2b2lkU2Nyb2xsaW5nICYmIHRoaXMuc2hvdWxkU2Nyb2xsKHByZXZTdGF0ZSwgcHJldlByb3BzKSkge1xuICAgICAgICB0aGlzLnNjcm9sbEhpZ2hsaWdodGVkSXRlbUludG9WaWV3KCk7XG4gICAgICB9XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAocmVhY3QtbmF0aXZlKSAqL1xuXG5cbiAgICAgIHRoaXMudXBkYXRlU3RhdHVzKCk7XG4gICAgfTtcblxuICAgIF9wcm90by5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgdGhpcy5jbGVhbnVwKCk7IC8vIGF2b2lkcyBtZW1vcnkgbGVha1xuICAgIH07XG5cbiAgICBfcHJvdG8ucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIGNoaWxkcmVuID0gdW53cmFwQXJyYXkodGhpcy5wcm9wcy5jaGlsZHJlbiwgbm9vcCk7IC8vIGJlY2F1c2UgdGhlIGl0ZW1zIGFyZSByZXJlbmRlcmVkIGV2ZXJ5IHRpbWUgd2UgY2FsbCB0aGUgY2hpbGRyZW5cbiAgICAgIC8vIHdlIGNsZWFyIHRoaXMgb3V0IGVhY2ggcmVuZGVyIGFuZCBpdCB3aWxsIGJlIHBvcHVsYXRlZCBhZ2FpbiBhc1xuICAgICAgLy8gZ2V0SXRlbVByb3BzIGlzIGNhbGxlZC5cblxuICAgICAgdGhpcy5jbGVhckl0ZW1zKCk7IC8vIHdlIHJlc2V0IHRoaXMgc28gd2Uga25vdyB3aGV0aGVyIHRoZSB1c2VyIGNhbGxzIGdldFJvb3RQcm9wcyBkdXJpbmdcbiAgICAgIC8vIHRoaXMgcmVuZGVyLiBJZiB0aGV5IGRvIHRoZW4gd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZyxcbiAgICAgIC8vIGlmIHRoZXkgZG9uJ3QgdGhlbiB3ZSBuZWVkIHRvIGNsb25lIHRoZSBlbGVtZW50IHRoZXkgcmV0dXJuIGFuZFxuICAgICAgLy8gYXBwbHkgdGhlIHByb3BzIGZvciB0aGVtLlxuXG4gICAgICB0aGlzLmdldFJvb3RQcm9wcy5jYWxsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuZ2V0Um9vdFByb3BzLnJlZktleSA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMuZ2V0Um9vdFByb3BzLnN1cHByZXNzUmVmRXJyb3IgPSB1bmRlZmluZWQ7IC8vIHdlIGRvIHNvbWV0aGluZyBzaW1pbGFyIGZvciBnZXRNZW51UHJvcHNcblxuICAgICAgdGhpcy5nZXRNZW51UHJvcHMuY2FsbGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmdldE1lbnVQcm9wcy5yZWZLZXkgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmdldE1lbnVQcm9wcy5zdXBwcmVzc1JlZkVycm9yID0gdW5kZWZpbmVkOyAvLyB3ZSBkbyBzb21ldGhpbmcgc2ltaWxhciBmb3IgZ2V0TGFiZWxQcm9wc1xuXG4gICAgICB0aGlzLmdldExhYmVsUHJvcHMuY2FsbGVkID0gZmFsc2U7IC8vIGFuZCBzb21ldGhpbmcgc2ltaWxhciBmb3IgZ2V0SW5wdXRQcm9wc1xuXG4gICAgICB0aGlzLmdldElucHV0UHJvcHMuY2FsbGVkID0gZmFsc2U7XG4gICAgICB2YXIgZWxlbWVudCA9IHVud3JhcEFycmF5KGNoaWxkcmVuKHRoaXMuZ2V0U3RhdGVBbmRIZWxwZXJzKCkpKTtcblxuICAgICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5nZXRSb290UHJvcHMuY2FsbGVkIHx8IHRoaXMucHJvcHMuc3VwcHJlc3NSZWZFcnJvcikge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAhdGhpcy5nZXRSb290UHJvcHMuc3VwcHJlc3NSZWZFcnJvciAmJiAhdGhpcy5wcm9wcy5zdXBwcmVzc1JlZkVycm9yKSB7XG4gICAgICAgICAgdmFsaWRhdGVHZXRSb290UHJvcHNDYWxsZWRDb3JyZWN0bHkoZWxlbWVudCwgdGhpcy5nZXRSb290UHJvcHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICB9IGVsc2UgaWYgKGlzRE9NRWxlbWVudChlbGVtZW50KSkge1xuICAgICAgICAvLyB0aGV5IGRpZG4ndCBhcHBseSB0aGUgcm9vdCBwcm9wcywgYnV0IHdlIGNhbiBjbG9uZVxuICAgICAgICAvLyB0aGlzIGFuZCBhcHBseSB0aGUgcHJvcHMgb3Vyc2VsdmVzXG4gICAgICAgIHJldHVybiBjbG9uZUVsZW1lbnQoZWxlbWVudCwgdGhpcy5nZXRSb290UHJvcHMoZ2V0RWxlbWVudFByb3BzKGVsZW1lbnQpKSk7XG4gICAgICB9XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuXG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIC8vIHRoZXkgZGlkbid0IGFwcGx5IHRoZSByb290IHByb3BzLCBidXQgdGhleSBuZWVkIHRvXG4gICAgICAgIC8vIG90aGVyd2lzZSB3ZSBjYW4ndCBxdWVyeSBhcm91bmQgdGhlIGF1dG9jb21wbGV0ZVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Rvd25zaGlmdDogSWYgeW91IHJldHVybiBhIG5vbi1ET00gZWxlbWVudCwgeW91IG11c3QgYXBwbHkgdGhlIGdldFJvb3RQcm9wcyBmdW5jdGlvbicpO1xuICAgICAgfVxuICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cblxuXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG5cbiAgICByZXR1cm4gRG93bnNoaWZ0O1xuICB9KENvbXBvbmVudCk7XG5cbiAgRG93bnNoaWZ0LmRlZmF1bHRQcm9wcyA9IHtcbiAgICBkZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleDogbnVsbCxcbiAgICBkZWZhdWx0SXNPcGVuOiBmYWxzZSxcbiAgICBnZXRBMTF5U3RhdHVzTWVzc2FnZTogZ2V0QTExeVN0YXR1c01lc3NhZ2UsXG4gICAgaXRlbVRvU3RyaW5nOiBmdW5jdGlvbiBpdGVtVG9TdHJpbmcoaSkge1xuICAgICAgaWYgKGkgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGlzUGxhaW5PYmplY3QoaSkgJiYgIWkuaGFzT3duUHJvcGVydHkoJ3RvU3RyaW5nJykpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgY29uc29sZS53YXJuKCdkb3duc2hpZnQ6IEFuIG9iamVjdCB3YXMgcGFzc2VkIHRvIHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIG9mIGBpdGVtVG9TdHJpbmdgLiBZb3Ugc2hvdWxkIHByb2JhYmx5IHByb3ZpZGUgeW91ciBvd24gYGl0ZW1Ub1N0cmluZ2AgaW1wbGVtZW50YXRpb24uIFBsZWFzZSByZWZlciB0byB0aGUgYGl0ZW1Ub1N0cmluZ2AgQVBJIGRvY3VtZW50YXRpb24uJywgJ1RoZSBvYmplY3QgdGhhdCB3YXMgcGFzc2VkOicsIGkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gU3RyaW5nKGkpO1xuICAgIH0sXG4gICAgb25TdGF0ZUNoYW5nZTogbm9vcCxcbiAgICBvbklucHV0VmFsdWVDaGFuZ2U6IG5vb3AsXG4gICAgb25Vc2VyQWN0aW9uOiBub29wLFxuICAgIG9uQ2hhbmdlOiBub29wLFxuICAgIG9uU2VsZWN0OiBub29wLFxuICAgIG9uT3V0ZXJDbGljazogbm9vcCxcbiAgICBzZWxlY3RlZEl0ZW1DaGFuZ2VkOiBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1DaGFuZ2VkKHByZXZJdGVtLCBpdGVtKSB7XG4gICAgICByZXR1cm4gcHJldkl0ZW0gIT09IGl0ZW07XG4gICAgfSxcbiAgICBlbnZpcm9ubWVudDogdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAoc3NyKSAqL1xuICAgID8ge30gOiB3aW5kb3csXG4gICAgc3RhdGVSZWR1Y2VyOiBmdW5jdGlvbiBzdGF0ZVJlZHVjZXIoc3RhdGUsIHN0YXRlVG9TZXQpIHtcbiAgICAgIHJldHVybiBzdGF0ZVRvU2V0O1xuICAgIH0sXG4gICAgc3VwcHJlc3NSZWZFcnJvcjogZmFsc2UsXG4gICAgc2Nyb2xsSW50b1ZpZXc6IHNjcm9sbEludG9WaWV3XG4gIH07XG4gIERvd25zaGlmdC5zdGF0ZUNoYW5nZVR5cGVzID0gc3RhdGVDaGFuZ2VUeXBlcztcbiAgcmV0dXJuIERvd25zaGlmdDtcbn0oKTtcblxucHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gRG93bnNoaWZ0LnByb3BUeXBlcyA9IHtcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLFxuICBkZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgZGVmYXVsdElzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIGluaXRpYWxIaWdobGlnaHRlZEluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICBpbml0aWFsU2VsZWN0ZWRJdGVtOiBQcm9wVHlwZXMuYW55LFxuICBpbml0aWFsSW5wdXRWYWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgaW5pdGlhbElzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIGdldEExMXlTdGF0dXNNZXNzYWdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgaXRlbVRvU3RyaW5nOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvblNlbGVjdDogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uU3RhdGVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvbklucHV0VmFsdWVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvblVzZXJBY3Rpb246IFByb3BUeXBlcy5mdW5jLFxuICBvbk91dGVyQ2xpY2s6IFByb3BUeXBlcy5mdW5jLFxuICBzZWxlY3RlZEl0ZW1DaGFuZ2VkOiBQcm9wVHlwZXMuZnVuYyxcbiAgc3RhdGVSZWR1Y2VyOiBQcm9wVHlwZXMuZnVuYyxcbiAgaXRlbUNvdW50OiBQcm9wVHlwZXMubnVtYmVyLFxuICBpZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgZW52aXJvbm1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZG9jdW1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBnZXRFbGVtZW50QnlJZDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICBhY3RpdmVFbGVtZW50OiBQcm9wVHlwZXMuYW55LFxuICAgICAgYm9keTogUHJvcFR5cGVzLmFueVxuICAgIH0pXG4gIH0pLFxuICBzdXBwcmVzc1JlZkVycm9yOiBQcm9wVHlwZXMuYm9vbCxcbiAgc2Nyb2xsSW50b1ZpZXc6IFByb3BUeXBlcy5mdW5jLFxuICAvLyB0aGluZ3Mgd2Uga2VlcCBpbiBzdGF0ZSBmb3IgdW5jb250cm9sbGVkIGNvbXBvbmVudHNcbiAgLy8gYnV0IGNhbiBhY2NlcHQgYXMgcHJvcHMgZm9yIGNvbnRyb2xsZWQgY29tcG9uZW50c1xuXG4gIC8qIGVzbGludC1kaXNhYmxlIHJlYWN0L25vLXVudXNlZC1wcm9wLXR5cGVzICovXG4gIHNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgaXNPcGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgaW5wdXRWYWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgaGlnaGxpZ2h0ZWRJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgbGFiZWxJZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgaW5wdXRJZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgbWVudUlkOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBnZXRJdGVtSWQ6IFByb3BUeXBlcy5mdW5jXG4gIC8qIGVzbGludC1lbmFibGUgcmVhY3Qvbm8tdW51c2VkLXByb3AtdHlwZXMgKi9cblxufSA6IHZvaWQgMDtcblxuZnVuY3Rpb24gdmFsaWRhdGVHZXRNZW51UHJvcHNDYWxsZWRDb3JyZWN0bHkobm9kZSwgX3JlZjEyKSB7XG4gIHZhciByZWZLZXkgPSBfcmVmMTIucmVmS2V5O1xuXG4gIGlmICghbm9kZSkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5lcnJvcihcImRvd25zaGlmdDogVGhlIHJlZiBwcm9wIFxcXCJcIiArIHJlZktleSArIFwiXFxcIiBmcm9tIGdldE1lbnVQcm9wcyB3YXMgbm90IGFwcGxpZWQgY29ycmVjdGx5IG9uIHlvdXIgbWVudSBlbGVtZW50LlwiKTtcbiAgfVxufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZUdldFJvb3RQcm9wc0NhbGxlZENvcnJlY3RseShlbGVtZW50LCBfcmVmMTMpIHtcbiAgdmFyIHJlZktleSA9IF9yZWYxMy5yZWZLZXk7XG4gIHZhciByZWZLZXlTcGVjaWZpZWQgPSByZWZLZXkgIT09ICdyZWYnO1xuICB2YXIgaXNDb21wb3NpdGUgPSAhaXNET01FbGVtZW50KGVsZW1lbnQpO1xuXG4gIGlmIChpc0NvbXBvc2l0ZSAmJiAhcmVmS2V5U3BlY2lmaWVkICYmICFpc0ZvcndhcmRSZWYoZWxlbWVudCkpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUuZXJyb3IoJ2Rvd25zaGlmdDogWW91IHJldHVybmVkIGEgbm9uLURPTSBlbGVtZW50LiBZb3UgbXVzdCBzcGVjaWZ5IGEgcmVmS2V5IGluIGdldFJvb3RQcm9wcycpO1xuICB9IGVsc2UgaWYgKCFpc0NvbXBvc2l0ZSAmJiByZWZLZXlTcGVjaWZpZWQpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUuZXJyb3IoXCJkb3duc2hpZnQ6IFlvdSByZXR1cm5lZCBhIERPTSBlbGVtZW50LiBZb3Ugc2hvdWxkIG5vdCBzcGVjaWZ5IGEgcmVmS2V5IGluIGdldFJvb3RQcm9wcy4gWW91IHNwZWNpZmllZCBcXFwiXCIgKyByZWZLZXkgKyBcIlxcXCJcIik7XG4gIH1cblxuICBpZiAoIWlzRm9yd2FyZFJlZihlbGVtZW50KSAmJiAhZ2V0RWxlbWVudFByb3BzKGVsZW1lbnQpW3JlZktleV0pIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUuZXJyb3IoXCJkb3duc2hpZnQ6IFlvdSBtdXN0IGFwcGx5IHRoZSByZWYgcHJvcCBcXFwiXCIgKyByZWZLZXkgKyBcIlxcXCIgZnJvbSBnZXRSb290UHJvcHMgb250byB5b3VyIHJvb3QgZWxlbWVudC5cIik7XG4gIH1cbn1cblxudmFyIGRyb3Bkb3duRGVmYXVsdFN0YXRlVmFsdWVzID0ge1xuICBoaWdobGlnaHRlZEluZGV4OiAtMSxcbiAgaXNPcGVuOiBmYWxzZSxcbiAgc2VsZWN0ZWRJdGVtOiBudWxsLFxuICBpbnB1dFZhbHVlOiAnJ1xufTtcblxuZnVuY3Rpb24gY2FsbE9uQ2hhbmdlUHJvcHMoYWN0aW9uLCBzdGF0ZSwgbmV3U3RhdGUpIHtcbiAgdmFyIHByb3BzID0gYWN0aW9uLnByb3BzLFxuICAgICAgdHlwZSA9IGFjdGlvbi50eXBlO1xuICB2YXIgY2hhbmdlcyA9IHt9O1xuICBPYmplY3Qua2V5cyhzdGF0ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgaW52b2tlT25DaGFuZ2VIYW5kbGVyKGtleSwgYWN0aW9uLCBzdGF0ZSwgbmV3U3RhdGUpO1xuXG4gICAgaWYgKG5ld1N0YXRlW2tleV0gIT09IHN0YXRlW2tleV0pIHtcbiAgICAgIGNoYW5nZXNba2V5XSA9IG5ld1N0YXRlW2tleV07XG4gICAgfVxuICB9KTtcblxuICBpZiAocHJvcHMub25TdGF0ZUNoYW5nZSAmJiBPYmplY3Qua2V5cyhjaGFuZ2VzKS5sZW5ndGgpIHtcbiAgICBwcm9wcy5vblN0YXRlQ2hhbmdlKF9leHRlbmRzKHtcbiAgICAgIHR5cGU6IHR5cGVcbiAgICB9LCBjaGFuZ2VzKSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW52b2tlT25DaGFuZ2VIYW5kbGVyKGtleSwgYWN0aW9uLCBzdGF0ZSwgbmV3U3RhdGUpIHtcbiAgdmFyIHByb3BzID0gYWN0aW9uLnByb3BzLFxuICAgICAgdHlwZSA9IGFjdGlvbi50eXBlO1xuICB2YXIgaGFuZGxlciA9IFwib25cIiArIGNhcGl0YWxpemVTdHJpbmcoa2V5KSArIFwiQ2hhbmdlXCI7XG5cbiAgaWYgKHByb3BzW2hhbmRsZXJdICYmIG5ld1N0YXRlW2tleV0gIT09IHVuZGVmaW5lZCAmJiBuZXdTdGF0ZVtrZXldICE9PSBzdGF0ZVtrZXldKSB7XG4gICAgcHJvcHNbaGFuZGxlcl0oX2V4dGVuZHMoe1xuICAgICAgdHlwZTogdHlwZVxuICAgIH0sIG5ld1N0YXRlKSk7XG4gIH1cbn1cbi8qKlxuICogRGVmYXVsdCBzdGF0ZSByZWR1Y2VyIHRoYXQgcmV0dXJucyB0aGUgY2hhbmdlcy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcyBzdGF0ZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBhIGFjdGlvbiB3aXRoIGNoYW5nZXMuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBjaGFuZ2VzLlxuICovXG5cblxuZnVuY3Rpb24gc3RhdGVSZWR1Y2VyKHMsIGEpIHtcbiAgcmV0dXJuIGEuY2hhbmdlcztcbn1cbi8qKlxuICogUmV0dXJucyBhIG1lc3NhZ2UgdG8gYmUgYWRkZWQgdG8gYXJpYS1saXZlIHJlZ2lvbiB3aGVuIGl0ZW0gaXMgc2VsZWN0ZWQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHNlbGVjdGlvblBhcmFtZXRlcnMgUGFyYW1ldGVycyByZXF1aXJlZCB0byBidWlsZCB0aGUgbWVzc2FnZS5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBhMTF5IG1lc3NhZ2UuXG4gKi9cblxuXG5mdW5jdGlvbiBnZXRBMTF5U2VsZWN0aW9uTWVzc2FnZShzZWxlY3Rpb25QYXJhbWV0ZXJzKSB7XG4gIHZhciBzZWxlY3RlZEl0ZW0gPSBzZWxlY3Rpb25QYXJhbWV0ZXJzLnNlbGVjdGVkSXRlbSxcbiAgICAgIGl0ZW1Ub1N0cmluZ0xvY2FsID0gc2VsZWN0aW9uUGFyYW1ldGVycy5pdGVtVG9TdHJpbmc7XG4gIHJldHVybiBzZWxlY3RlZEl0ZW0gPyBpdGVtVG9TdHJpbmdMb2NhbChzZWxlY3RlZEl0ZW0pICsgXCIgaGFzIGJlZW4gc2VsZWN0ZWQuXCIgOiAnJztcbn1cbi8qKlxuICogRGVib3VuY2VkIGNhbGwgZm9yIHVwZGF0aW5nIHRoZSBhMTF5IG1lc3NhZ2UuXG4gKi9cblxuXG52YXIgdXBkYXRlQTExeVN0YXR1cyA9IGRlYm91bmNlKGZ1bmN0aW9uIChnZXRBMTF5TWVzc2FnZSwgZG9jdW1lbnQpIHtcbiAgc2V0U3RhdHVzKGdldEExMXlNZXNzYWdlKCksIGRvY3VtZW50KTtcbn0sIDIwMCk7XG5mdW5jdGlvbiBnZXRFbGVtZW50SWRzKF9yZWYpIHtcbiAgdmFyIGlkID0gX3JlZi5pZCxcbiAgICAgIGxhYmVsSWQgPSBfcmVmLmxhYmVsSWQsXG4gICAgICBtZW51SWQgPSBfcmVmLm1lbnVJZCxcbiAgICAgIGdldEl0ZW1JZCA9IF9yZWYuZ2V0SXRlbUlkLFxuICAgICAgdG9nZ2xlQnV0dG9uSWQgPSBfcmVmLnRvZ2dsZUJ1dHRvbklkO1xuICB2YXIgdW5pcXVlSWQgPSBpZCA9PT0gdW5kZWZpbmVkID8gXCJkb3duc2hpZnQtXCIgKyBnZW5lcmF0ZUlkKCkgOiBpZDtcbiAgcmV0dXJuIHtcbiAgICBsYWJlbElkOiBsYWJlbElkIHx8IHVuaXF1ZUlkICsgXCItbGFiZWxcIixcbiAgICBtZW51SWQ6IG1lbnVJZCB8fCB1bmlxdWVJZCArIFwiLW1lbnVcIixcbiAgICBnZXRJdGVtSWQ6IGdldEl0ZW1JZCB8fCBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgIHJldHVybiB1bmlxdWVJZCArIFwiLWl0ZW0tXCIgKyBpbmRleDtcbiAgICB9LFxuICAgIHRvZ2dsZUJ1dHRvbklkOiB0b2dnbGVCdXR0b25JZCB8fCB1bmlxdWVJZCArIFwiLXRvZ2dsZS1idXR0b25cIlxuICB9O1xufVxuZnVuY3Rpb24gZ2V0SXRlbUluZGV4KGluZGV4LCBpdGVtLCBpdGVtcykge1xuICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICByZXR1cm4gaXRlbXMuaW5kZXhPZihpdGVtKTtcbn1cblxuZnVuY3Rpb24gaXRlbVRvU3RyaW5nKGl0ZW0pIHtcbiAgcmV0dXJuIGl0ZW0gPyBTdHJpbmcoaXRlbSkgOiAnJztcbn1cblxuZnVuY3Rpb24gZ2V0UHJvcFR5cGVzVmFsaWRhdG9yKGNhbGxlciwgcHJvcFR5cGVzKSB7XG4gIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0XG4gIHJldHVybiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICB9XG5cbiAgICBPYmplY3Qua2V5cyhwcm9wVHlwZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgUHJvcFR5cGVzLmNoZWNrUHJvcFR5cGVzKHByb3BUeXBlcywgb3B0aW9ucywga2V5LCBjYWxsZXIubmFtZSk7XG4gICAgfSk7XG4gIH07XG59XG5mdW5jdGlvbiBpc0FjY2VwdGVkQ2hhcmFjdGVyS2V5KGtleSkge1xuICByZXR1cm4gL15cXFN7MX0kLy50ZXN0KGtleSk7XG59XG5mdW5jdGlvbiBjYXBpdGFsaXplU3RyaW5nKHN0cmluZykge1xuICByZXR1cm4gXCJcIiArIHN0cmluZy5zbGljZSgwLCAxKS50b1VwcGVyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpO1xufVxuZnVuY3Rpb24gdXNlTGF0ZXN0UmVmKHZhbCkge1xuICB2YXIgcmVmID0gdXNlUmVmKHZhbCk7IC8vIHRlY2huaWNhbGx5IHRoaXMgaXMgbm90IFwiY29uY3VycmVudCBtb2RlIHNhZmVcIiBiZWNhdXNlIHdlJ3JlIG1hbmlwdWxhdGluZ1xuICAvLyB0aGUgdmFsdWUgZHVyaW5nIHJlbmRlciAoc28gaXQncyBub3QgaWRlbXBvdGVudCkuIEhvd2V2ZXIsIHRoZSBwbGFjZXMgdGhpc1xuICAvLyBob29rIGlzIHVzZWQgaXMgdG8gc3VwcG9ydCBtZW1vaXppbmcgY2FsbGJhY2tzIHdoaWNoIHdpbGwgYmUgY2FsbGVkXG4gIC8vICpkdXJpbmcqIHJlbmRlciwgc28gd2UgbmVlZCB0aGUgbGF0ZXN0IHZhbHVlcyAqZHVyaW5nKiByZW5kZXIuXG4gIC8vIElmIG5vdCBmb3IgdGhpcywgdGhlbiB3ZSdkIHByb2JhYmx5IHdhbnQgdG8gdXNlIHVzZUxheW91dEVmZmVjdCBpbnN0ZWFkLlxuXG4gIHJlZi5jdXJyZW50ID0gdmFsO1xuICByZXR1cm4gcmVmO1xufVxuLyoqXG4gKiBDb21wdXRlcyB0aGUgY29udHJvbGxlZCBzdGF0ZSB1c2luZyBhIHRoZSBwcmV2aW91cyBzdGF0ZSwgcHJvcHMsXG4gKiB0d28gcmVkdWNlcnMsIG9uZSBmcm9tIGRvd25zaGlmdCBhbmQgYW4gb3B0aW9uYWwgb25lIGZyb20gdGhlIHVzZXIuXG4gKiBBbHNvIGNhbGxzIHRoZSBvbkNoYW5nZSBoYW5kbGVycyBmb3Igc3RhdGUgdmFsdWVzIHRoYXQgaGF2ZSBjaGFuZ2VkLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlZHVjZXIgUmVkdWNlciBmdW5jdGlvbiBmcm9tIGRvd25zaGlmdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBpbml0aWFsU3RhdGUgSW5pdGlhbCBzdGF0ZSBvZiB0aGUgaG9vay5cbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyBUaGUgaG9vayBwcm9wcy5cbiAqIEByZXR1cm5zIHtBcnJheX0gQW4gYXJyYXkgd2l0aCB0aGUgc3RhdGUgYW5kIGFuIGFjdGlvbiBkaXNwYXRjaGVyLlxuICovXG5cbmZ1bmN0aW9uIHVzZUVuaGFuY2VkUmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsU3RhdGUsIHByb3BzKSB7XG4gIHZhciBwcmV2U3RhdGVSZWYgPSB1c2VSZWYoKTtcbiAgdmFyIGFjdGlvblJlZiA9IHVzZVJlZigpO1xuICB2YXIgZW5oYW5jZWRSZWR1Y2VyID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcbiAgICBhY3Rpb25SZWYuY3VycmVudCA9IGFjdGlvbjtcbiAgICBzdGF0ZSA9IGdldFN0YXRlKHN0YXRlLCBhY3Rpb24ucHJvcHMpO1xuICAgIHZhciBjaGFuZ2VzID0gcmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbiAgICB2YXIgbmV3U3RhdGUgPSBhY3Rpb24ucHJvcHMuc3RhdGVSZWR1Y2VyKHN0YXRlLCBfZXh0ZW5kcyh7fSwgYWN0aW9uLCB7XG4gICAgICBjaGFuZ2VzOiBjaGFuZ2VzXG4gICAgfSkpO1xuICAgIHJldHVybiBuZXdTdGF0ZTtcbiAgfSwgW3JlZHVjZXJdKTtcblxuICB2YXIgX3VzZVJlZHVjZXIgPSB1c2VSZWR1Y2VyKGVuaGFuY2VkUmVkdWNlciwgaW5pdGlhbFN0YXRlKSxcbiAgICAgIHN0YXRlID0gX3VzZVJlZHVjZXJbMF0sXG4gICAgICBkaXNwYXRjaCA9IF91c2VSZWR1Y2VyWzFdO1xuXG4gIHZhciBwcm9wc1JlZiA9IHVzZUxhdGVzdFJlZihwcm9wcyk7XG4gIHZhciBkaXNwYXRjaFdpdGhQcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goX2V4dGVuZHMoe1xuICAgICAgcHJvcHM6IHByb3BzUmVmLmN1cnJlbnRcbiAgICB9LCBhY3Rpb24pKTtcbiAgfSwgW3Byb3BzUmVmXSk7XG4gIHZhciBhY3Rpb24gPSBhY3Rpb25SZWYuY3VycmVudDtcbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoYWN0aW9uICYmIHByZXZTdGF0ZVJlZi5jdXJyZW50ICYmIHByZXZTdGF0ZVJlZi5jdXJyZW50ICE9PSBzdGF0ZSkge1xuICAgICAgY2FsbE9uQ2hhbmdlUHJvcHMoYWN0aW9uLCBnZXRTdGF0ZShwcmV2U3RhdGVSZWYuY3VycmVudCwgYWN0aW9uLnByb3BzKSwgc3RhdGUpO1xuICAgIH1cblxuICAgIHByZXZTdGF0ZVJlZi5jdXJyZW50ID0gc3RhdGU7XG4gIH0sIFtzdGF0ZSwgcHJvcHMsIGFjdGlvbl0pO1xuICByZXR1cm4gW3N0YXRlLCBkaXNwYXRjaFdpdGhQcm9wc107XG59XG4vKipcbiAqIFdyYXBzIHRoZSB1c2VFbmhhbmNlZFJlZHVjZXIgYW5kIGFwcGxpZXMgdGhlIGNvbnRyb2xsZWQgcHJvcCB2YWx1ZXMgYmVmb3JlXG4gKiByZXR1cm5pbmcgdGhlIG5ldyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWR1Y2VyIFJlZHVjZXIgZnVuY3Rpb24gZnJvbSBkb3duc2hpZnQuXG4gKiBAcGFyYW0ge09iamVjdH0gaW5pdGlhbFN0YXRlIEluaXRpYWwgc3RhdGUgb2YgdGhlIGhvb2suXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgVGhlIGhvb2sgcHJvcHMuXG4gKiBAcmV0dXJucyB7QXJyYXl9IEFuIGFycmF5IHdpdGggdGhlIHN0YXRlIGFuZCBhbiBhY3Rpb24gZGlzcGF0Y2hlci5cbiAqL1xuXG5mdW5jdGlvbiB1c2VDb250cm9sbGVkUmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsU3RhdGUsIHByb3BzKSB7XG4gIHZhciBfdXNlRW5oYW5jZWRSZWR1Y2VyID0gdXNlRW5oYW5jZWRSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxTdGF0ZSwgcHJvcHMpLFxuICAgICAgc3RhdGUgPSBfdXNlRW5oYW5jZWRSZWR1Y2VyWzBdLFxuICAgICAgZGlzcGF0Y2ggPSBfdXNlRW5oYW5jZWRSZWR1Y2VyWzFdO1xuXG4gIHJldHVybiBbZ2V0U3RhdGUoc3RhdGUsIHByb3BzKSwgZGlzcGF0Y2hdO1xufVxudmFyIGRlZmF1bHRQcm9wcyA9IHtcbiAgaXRlbVRvU3RyaW5nOiBpdGVtVG9TdHJpbmcsXG4gIHN0YXRlUmVkdWNlcjogc3RhdGVSZWR1Y2VyLFxuICBnZXRBMTF5U2VsZWN0aW9uTWVzc2FnZTogZ2V0QTExeVNlbGVjdGlvbk1lc3NhZ2UsXG4gIHNjcm9sbEludG9WaWV3OiBzY3JvbGxJbnRvVmlldyxcbiAgY2lyY3VsYXJOYXZpZ2F0aW9uOiBmYWxzZSxcbiAgZW52aXJvbm1lbnQ6IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0IChzc3IpICovXG4gID8ge30gOiB3aW5kb3dcbn07XG5mdW5jdGlvbiBnZXREZWZhdWx0VmFsdWUocHJvcHMsIHByb3BLZXksIGRlZmF1bHRTdGF0ZVZhbHVlcykge1xuICBpZiAoZGVmYXVsdFN0YXRlVmFsdWVzID09PSB2b2lkIDApIHtcbiAgICBkZWZhdWx0U3RhdGVWYWx1ZXMgPSBkcm9wZG93bkRlZmF1bHRTdGF0ZVZhbHVlcztcbiAgfVxuXG4gIHZhciBkZWZhdWx0UHJvcEtleSA9IFwiZGVmYXVsdFwiICsgY2FwaXRhbGl6ZVN0cmluZyhwcm9wS2V5KTtcblxuICBpZiAoZGVmYXVsdFByb3BLZXkgaW4gcHJvcHMpIHtcbiAgICByZXR1cm4gcHJvcHNbZGVmYXVsdFByb3BLZXldO1xuICB9XG5cbiAgcmV0dXJuIGRlZmF1bHRTdGF0ZVZhbHVlc1twcm9wS2V5XTtcbn1cbmZ1bmN0aW9uIGdldEluaXRpYWxWYWx1ZShwcm9wcywgcHJvcEtleSwgZGVmYXVsdFN0YXRlVmFsdWVzKSB7XG4gIGlmIChkZWZhdWx0U3RhdGVWYWx1ZXMgPT09IHZvaWQgMCkge1xuICAgIGRlZmF1bHRTdGF0ZVZhbHVlcyA9IGRyb3Bkb3duRGVmYXVsdFN0YXRlVmFsdWVzO1xuICB9XG5cbiAgaWYgKHByb3BLZXkgaW4gcHJvcHMpIHtcbiAgICByZXR1cm4gcHJvcHNbcHJvcEtleV07XG4gIH1cblxuICB2YXIgaW5pdGlhbFByb3BLZXkgPSBcImluaXRpYWxcIiArIGNhcGl0YWxpemVTdHJpbmcocHJvcEtleSk7XG5cbiAgaWYgKGluaXRpYWxQcm9wS2V5IGluIHByb3BzKSB7XG4gICAgcmV0dXJuIHByb3BzW2luaXRpYWxQcm9wS2V5XTtcbiAgfVxuXG4gIHJldHVybiBnZXREZWZhdWx0VmFsdWUocHJvcHMsIHByb3BLZXksIGRlZmF1bHRTdGF0ZVZhbHVlcyk7XG59XG5mdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUocHJvcHMpIHtcbiAgdmFyIHNlbGVjdGVkSXRlbSA9IGdldEluaXRpYWxWYWx1ZShwcm9wcywgJ3NlbGVjdGVkSXRlbScpO1xuICB2YXIgaXNPcGVuID0gZ2V0SW5pdGlhbFZhbHVlKHByb3BzLCAnaXNPcGVuJyk7XG4gIHZhciBoaWdobGlnaHRlZEluZGV4ID0gZ2V0SW5pdGlhbFZhbHVlKHByb3BzLCAnaGlnaGxpZ2h0ZWRJbmRleCcpO1xuICB2YXIgaW5wdXRWYWx1ZSA9IGdldEluaXRpYWxWYWx1ZShwcm9wcywgJ2lucHV0VmFsdWUnKTtcbiAgcmV0dXJuIHtcbiAgICBoaWdobGlnaHRlZEluZGV4OiBoaWdobGlnaHRlZEluZGV4IDwgMCAmJiBzZWxlY3RlZEl0ZW0gJiYgaXNPcGVuID8gcHJvcHMuaXRlbXMuaW5kZXhPZihzZWxlY3RlZEl0ZW0pIDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBpc09wZW46IGlzT3BlbixcbiAgICBzZWxlY3RlZEl0ZW06IHNlbGVjdGVkSXRlbSxcbiAgICBpbnB1dFZhbHVlOiBpbnB1dFZhbHVlXG4gIH07XG59XG5mdW5jdGlvbiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgb2Zmc2V0LCBnZXRJdGVtTm9kZUZyb21JbmRleCkge1xuICB2YXIgaXRlbXMgPSBwcm9wcy5pdGVtcyxcbiAgICAgIGluaXRpYWxIaWdobGlnaHRlZEluZGV4ID0gcHJvcHMuaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICBkZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCA9IHByb3BzLmRlZmF1bHRIaWdobGlnaHRlZEluZGV4O1xuICB2YXIgc2VsZWN0ZWRJdGVtID0gc3RhdGUuc2VsZWN0ZWRJdGVtLFxuICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IHN0YXRlLmhpZ2hsaWdodGVkSW5kZXg7XG5cbiAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAtMTtcbiAgfSAvLyBpbml0aWFsSGlnaGxpZ2h0ZWRJbmRleCB3aWxsIGdpdmUgdmFsdWUgdG8gaGlnaGxpZ2h0ZWRJbmRleCBvbiBpbml0aWFsIHN0YXRlIG9ubHkuXG5cblxuICBpZiAoaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXggIT09IHVuZGVmaW5lZCAmJiBoaWdobGlnaHRlZEluZGV4ID09PSBpbml0aWFsSGlnaGxpZ2h0ZWRJbmRleCkge1xuICAgIHJldHVybiBpbml0aWFsSGlnaGxpZ2h0ZWRJbmRleDtcbiAgfVxuXG4gIGlmIChkZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRIaWdobGlnaHRlZEluZGV4O1xuICB9XG5cbiAgaWYgKHNlbGVjdGVkSXRlbSkge1xuICAgIGlmIChvZmZzZXQgPT09IDApIHtcbiAgICAgIHJldHVybiBpdGVtcy5pbmRleE9mKHNlbGVjdGVkSXRlbSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldE5leHRXcmFwcGluZ0luZGV4KG9mZnNldCwgaXRlbXMuaW5kZXhPZihzZWxlY3RlZEl0ZW0pLCBpdGVtcy5sZW5ndGgsIGdldEl0ZW1Ob2RlRnJvbUluZGV4LCBmYWxzZSk7XG4gIH1cblxuICBpZiAob2Zmc2V0ID09PSAwKSB7XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgcmV0dXJuIG9mZnNldCA8IDAgPyBpdGVtcy5sZW5ndGggLSAxIDogMDtcbn1cbi8qKlxuICogUmV1c2UgdGhlIG1vdmVtZW50IHRyYWNraW5nIG9mIG1vdXNlIGFuZCB0b3VjaCBldmVudHMuXG4gKlxuICogQHBhcmFtIHtib29sZWFufSBpc09wZW4gV2hldGhlciB0aGUgZHJvcGRvd24gaXMgb3BlbiBvciBub3QuXG4gKiBAcGFyYW0ge0FycmF5PE9iamVjdD59IGRvd25zaGlmdEVsZW1lbnRSZWZzIERvd25zaGlmdCBlbGVtZW50IHJlZnMgdG8gdHJhY2sgbW92ZW1lbnQgKHRvZ2dsZUJ1dHRvbiwgbWVudSBldGMuKVxuICogQHBhcmFtIHtPYmplY3R9IGVudmlyb25tZW50IEVudmlyb25tZW50IHdoZXJlIGNvbXBvbmVudC9ob29rIGV4aXN0cy5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZUJsdXIgSGFuZGxlciBvbiBibHVyIGZyb20gbW91c2Ugb3IgdG91Y2guXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZWYgY29udGFpbmluZyB3aGV0aGVyIG1vdXNlRG93biBvciB0b3VjaE1vdmUgZXZlbnQgaXMgaGFwcGVuaW5nXG4gKi9cblxuZnVuY3Rpb24gdXNlTW91c2VBbmRUb3VjaFRyYWNrZXIoaXNPcGVuLCBkb3duc2hpZnRFbGVtZW50UmVmcywgZW52aXJvbm1lbnQsIGhhbmRsZUJsdXIpIHtcbiAgdmFyIG1vdXNlQW5kVG91Y2hUcmFja2Vyc1JlZiA9IHVzZVJlZih7XG4gICAgaXNNb3VzZURvd246IGZhbHNlLFxuICAgIGlzVG91Y2hNb3ZlOiBmYWxzZVxuICB9KTtcbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICAvLyBUaGUgc2FtZSBzdHJhdGVneSBmb3IgY2hlY2tpbmcgaWYgYSBjbGljayBvY2N1cnJlZCBpbnNpZGUgb3Igb3V0c2lkZSBkb3duc2lmdFxuICAgIC8vIGFzIGluIGRvd25zaGlmdC5qcy5cbiAgICB2YXIgb25Nb3VzZURvd24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBtb3VzZUFuZFRvdWNoVHJhY2tlcnNSZWYuY3VycmVudC5pc01vdXNlRG93biA9IHRydWU7XG4gICAgfTtcblxuICAgIHZhciBvbk1vdXNlVXAgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIG1vdXNlQW5kVG91Y2hUcmFja2Vyc1JlZi5jdXJyZW50LmlzTW91c2VEb3duID0gZmFsc2U7XG5cbiAgICAgIGlmIChpc09wZW4gJiYgIXRhcmdldFdpdGhpbkRvd25zaGlmdChldmVudC50YXJnZXQsIGRvd25zaGlmdEVsZW1lbnRSZWZzLm1hcChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgIHJldHVybiByZWYuY3VycmVudDtcbiAgICAgIH0pLCBlbnZpcm9ubWVudC5kb2N1bWVudCkpIHtcbiAgICAgICAgaGFuZGxlQmx1cigpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgb25Ub3VjaFN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQuaXNUb3VjaE1vdmUgPSBmYWxzZTtcbiAgICB9O1xuXG4gICAgdmFyIG9uVG91Y2hNb3ZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQuaXNUb3VjaE1vdmUgPSB0cnVlO1xuICAgIH07XG5cbiAgICB2YXIgb25Ub3VjaEVuZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgaWYgKGlzT3BlbiAmJiAhbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQuaXNUb3VjaE1vdmUgJiYgIXRhcmdldFdpdGhpbkRvd25zaGlmdChldmVudC50YXJnZXQsIGRvd25zaGlmdEVsZW1lbnRSZWZzLm1hcChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgIHJldHVybiByZWYuY3VycmVudDtcbiAgICAgIH0pLCBlbnZpcm9ubWVudC5kb2N1bWVudCwgZmFsc2UpKSB7XG4gICAgICAgIGhhbmRsZUJsdXIoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25Nb3VzZURvd24pO1xuICAgIGVudmlyb25tZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApO1xuICAgIGVudmlyb25tZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQpO1xuICAgIGVudmlyb25tZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlKTtcbiAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBlbnZpcm9ubWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbk1vdXNlRG93bik7XG4gICAgICBlbnZpcm9ubWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTtcbiAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQpO1xuICAgICAgZW52aXJvbm1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgZW52aXJvbm1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBvblRvdWNoRW5kKTtcbiAgICB9OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtpc09wZW4sIGVudmlyb25tZW50XSk7XG4gIHJldHVybiBtb3VzZUFuZFRvdWNoVHJhY2tlcnNSZWY7XG59XG4vKipcbiAqIEN1c3RvbSBob29rIHRoYXQgY2hlY2tzIGlmIGdldHRlciBwcm9wcyBhcmUgY2FsbGVkIGNvcnJlY3RseS5cbiAqXG4gKiBAcGFyYW0gIHsuLi5hbnl9IHByb3BLZXlzIEdldHRlciBwcm9wIG5hbWVzIHRvIGJlIGhhbmRsZWQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFNldHRlciBmdW5jdGlvbiBjYWxsZWQgaW5zaWRlIGdldHRlciBwcm9wcyB0byBzZXQgY2FsbCBpbmZvcm1hdGlvbi5cbiAqL1xuXG5mdW5jdGlvbiB1c2VHZXR0ZXJQcm9wc0NhbGxlZENoZWNrZXIoKSB7XG4gIHZhciBpc05vdFByb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nO1xuICB2YXIgaXNJbml0aWFsTW91bnRSZWYgPSB1c2VSZWYodHJ1ZSk7XG5cbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHByb3BLZXlzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIHByb3BLZXlzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgdmFyIGdldHRlclByb3BzQ2FsbGVkUmVmID0gdXNlUmVmKHByb3BLZXlzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwcm9wS2V5KSB7XG4gICAgYWNjW3Byb3BLZXldID0ge307XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pKTtcbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWlzTm90UHJvZHVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIE9iamVjdC5rZXlzKGdldHRlclByb3BzQ2FsbGVkUmVmLmN1cnJlbnQpLmZvckVhY2goZnVuY3Rpb24gKHByb3BLZXkpIHtcbiAgICAgIHZhciBwcm9wQ2FsbEluZm8gPSBnZXR0ZXJQcm9wc0NhbGxlZFJlZi5jdXJyZW50W3Byb3BLZXldO1xuXG4gICAgICBpZiAoaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCkge1xuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKHByb3BDYWxsSW5mbykubGVuZ3RoKSB7XG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZG93bnNoaWZ0OiBZb3UgZm9yZ290IHRvIGNhbGwgdGhlIFwiICsgcHJvcEtleSArIFwiIGdldHRlciBmdW5jdGlvbiBvbiB5b3VyIGNvbXBvbmVudCAvIGVsZW1lbnQuXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgc3VwcHJlc3NSZWZFcnJvciA9IHByb3BDYWxsSW5mby5zdXBwcmVzc1JlZkVycm9yLFxuICAgICAgICAgIHJlZktleSA9IHByb3BDYWxsSW5mby5yZWZLZXksXG4gICAgICAgICAgZWxlbWVudFJlZiA9IHByb3BDYWxsSW5mby5lbGVtZW50UmVmO1xuXG4gICAgICBpZiAoKCFlbGVtZW50UmVmIHx8ICFlbGVtZW50UmVmLmN1cnJlbnQpICYmICFzdXBwcmVzc1JlZkVycm9yKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJkb3duc2hpZnQ6IFRoZSByZWYgcHJvcCBcXFwiXCIgKyByZWZLZXkgKyBcIlxcXCIgZnJvbSBcIiArIHByb3BLZXkgKyBcIiB3YXMgbm90IGFwcGxpZWQgY29ycmVjdGx5IG9uIHlvdXIgZWxlbWVudC5cIik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCA9IGZhbHNlO1xuICB9KTtcbiAgdmFyIHNldEdldHRlclByb3BDYWxsSW5mbyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChwcm9wS2V5LCBzdXBwcmVzc1JlZkVycm9yLCByZWZLZXksIGVsZW1lbnRSZWYpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgZ2V0dGVyUHJvcHNDYWxsZWRSZWYuY3VycmVudFtwcm9wS2V5XSA9IHtcbiAgICAgICAgc3VwcHJlc3NSZWZFcnJvcjogc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgICAgcmVmS2V5OiByZWZLZXksXG4gICAgICAgIGVsZW1lbnRSZWY6IGVsZW1lbnRSZWZcbiAgICAgIH07XG4gICAgfVxuICB9LCBbXSk7XG4gIHJldHVybiBzZXRHZXR0ZXJQcm9wQ2FsbEluZm87XG59XG5mdW5jdGlvbiB1c2VBMTF5TWVzc2FnZVNldHRlcihnZXRBMTF5TWVzc2FnZSwgZGVwZW5kZW5jeUFycmF5LCBfcmVmMikge1xuICB2YXIgaXNJbml0aWFsTW91bnQgPSBfcmVmMi5pc0luaXRpYWxNb3VudCxcbiAgICAgIHByZXZpb3VzUmVzdWx0Q291bnQgPSBfcmVmMi5wcmV2aW91c1Jlc3VsdENvdW50LFxuICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IF9yZWYyLmhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICBpdGVtcyA9IF9yZWYyLml0ZW1zLFxuICAgICAgZW52aXJvbm1lbnQgPSBfcmVmMi5lbnZpcm9ubWVudCxcbiAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmMiwgW1wiaXNJbml0aWFsTW91bnRcIiwgXCJwcmV2aW91c1Jlc3VsdENvdW50XCIsIFwiaGlnaGxpZ2h0ZWRJbmRleFwiLCBcIml0ZW1zXCIsIFwiZW52aXJvbm1lbnRcIl0pO1xuXG4gIC8vIFNldHMgYTExeSBzdGF0dXMgbWVzc2FnZSBvbiBjaGFuZ2VzIGluIHN0YXRlLlxuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmIChpc0luaXRpYWxNb3VudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHVwZGF0ZUExMXlTdGF0dXMoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGdldEExMXlNZXNzYWdlKF9leHRlbmRzKHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJdGVtOiBpdGVtc1toaWdobGlnaHRlZEluZGV4XSxcbiAgICAgICAgcmVzdWx0Q291bnQ6IGl0ZW1zLmxlbmd0aCxcbiAgICAgICAgcHJldmlvdXNSZXN1bHRDb3VudDogcHJldmlvdXNSZXN1bHRDb3VudFxuICAgICAgfSwgcmVzdCkpO1xuICAgIH0sIGVudmlyb25tZW50LmRvY3VtZW50KTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBkZXBlbmRlbmN5QXJyYXkpO1xufVxuZnVuY3Rpb24gdXNlU2Nyb2xsSW50b1ZpZXcoX3JlZjMpIHtcbiAgdmFyIGhpZ2hsaWdodGVkSW5kZXggPSBfcmVmMy5oaWdobGlnaHRlZEluZGV4LFxuICAgICAgaXNPcGVuID0gX3JlZjMuaXNPcGVuLFxuICAgICAgaXRlbVJlZnMgPSBfcmVmMy5pdGVtUmVmcyxcbiAgICAgIGdldEl0ZW1Ob2RlRnJvbUluZGV4ID0gX3JlZjMuZ2V0SXRlbU5vZGVGcm9tSW5kZXgsXG4gICAgICBtZW51RWxlbWVudCA9IF9yZWYzLm1lbnVFbGVtZW50LFxuICAgICAgc2Nyb2xsSW50b1ZpZXdQcm9wID0gX3JlZjMuc2Nyb2xsSW50b1ZpZXc7XG4gIC8vIHVzZWQgbm90IHRvIHNjcm9sbCBvbiBoaWdobGlnaHQgYnkgbW91c2UuXG4gIHZhciBzaG91bGRTY3JvbGxSZWYgPSB1c2VSZWYodHJ1ZSk7IC8vIFNjcm9sbCBvbiBoaWdobGlnaHRlZCBpdGVtIGlmIGNoYW5nZSBjb21lcyBmcm9tIGtleWJvYXJkLlxuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGhpZ2hsaWdodGVkSW5kZXggPCAwIHx8ICFpc09wZW4gfHwgIU9iamVjdC5rZXlzKGl0ZW1SZWZzLmN1cnJlbnQpLmxlbmd0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChzaG91bGRTY3JvbGxSZWYuY3VycmVudCA9PT0gZmFsc2UpIHtcbiAgICAgIHNob3VsZFNjcm9sbFJlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2Nyb2xsSW50b1ZpZXdQcm9wKGdldEl0ZW1Ob2RlRnJvbUluZGV4KGhpZ2hsaWdodGVkSW5kZXgpLCBtZW51RWxlbWVudCk7XG4gICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG5cbiAgfSwgW2hpZ2hsaWdodGVkSW5kZXhdKTtcbiAgcmV0dXJuIHNob3VsZFNjcm9sbFJlZjtcbn1cbmZ1bmN0aW9uIHVzZUNvbnRyb2xQcm9wc1ZhbGlkYXRvcihfcmVmNCkge1xuICB2YXIgaXNJbml0aWFsTW91bnQgPSBfcmVmNC5pc0luaXRpYWxNb3VudCxcbiAgICAgIHByb3BzID0gX3JlZjQucHJvcHMsXG4gICAgICBzdGF0ZSA9IF9yZWY0LnN0YXRlO1xuICAvLyB1c2VkIGZvciBjaGVja2luZyB3aGVuIHByb3BzIGFyZSBtb3ZpbmcgZnJvbSBjb250cm9sbGVkIHRvIHVuY29udHJvbGxlZC5cbiAgdmFyIHByZXZQcm9wc1JlZiA9IHVzZVJlZihwcm9wcyk7XG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGlzSW5pdGlhbE1vdW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFsaWRhdGVDb250cm9sbGVkVW5jaGFuZ2VkKHN0YXRlLCBwcmV2UHJvcHNSZWYuY3VycmVudCwgcHJvcHMpO1xuICAgIHByZXZQcm9wc1JlZi5jdXJyZW50ID0gcHJvcHM7XG4gIH0sIFtzdGF0ZSwgcHJvcHMsIGlzSW5pdGlhbE1vdW50XSk7XG59XG5cbmZ1bmN0aW9uIGdldEl0ZW1JbmRleEJ5Q2hhcmFjdGVyS2V5KGtleXNTb0ZhciwgaGlnaGxpZ2h0ZWRJbmRleCwgaXRlbXMsIGl0ZW1Ub1N0cmluZ1BhcmFtLCBnZXRJdGVtTm9kZUZyb21JbmRleCkge1xuICB2YXIgbG93ZXJDYXNlZEl0ZW1TdHJpbmdzID0gaXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgcmV0dXJuIGl0ZW1Ub1N0cmluZ1BhcmFtKGl0ZW0pLnRvTG93ZXJDYXNlKCk7XG4gIH0pO1xuICB2YXIgbG93ZXJDYXNlZEtleXNTb0ZhciA9IGtleXNTb0Zhci50b0xvd2VyQ2FzZSgpO1xuXG4gIHZhciBpc1ZhbGlkID0gZnVuY3Rpb24gKGl0ZW1TdHJpbmcsIGluZGV4KSB7XG4gICAgdmFyIGVsZW1lbnQgPSBnZXRJdGVtTm9kZUZyb21JbmRleChpbmRleCk7XG4gICAgcmV0dXJuIGl0ZW1TdHJpbmcuc3RhcnRzV2l0aChsb3dlckNhc2VkS2V5c1NvRmFyKSAmJiAhKGVsZW1lbnQgJiYgZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpO1xuICB9O1xuXG4gIGZvciAodmFyIGluZGV4ID0gaGlnaGxpZ2h0ZWRJbmRleCArIDE7IGluZGV4IDwgbG93ZXJDYXNlZEl0ZW1TdHJpbmdzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgIHZhciBpdGVtU3RyaW5nID0gbG93ZXJDYXNlZEl0ZW1TdHJpbmdzW2luZGV4XTtcblxuICAgIGlmIChpc1ZhbGlkKGl0ZW1TdHJpbmcsIGluZGV4KSkge1xuICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH1cbiAgfVxuXG4gIGZvciAodmFyIF9pbmRleCA9IDA7IF9pbmRleCA8IGhpZ2hsaWdodGVkSW5kZXg7IF9pbmRleCsrKSB7XG4gICAgdmFyIF9pdGVtU3RyaW5nID0gbG93ZXJDYXNlZEl0ZW1TdHJpbmdzW19pbmRleF07XG5cbiAgICBpZiAoaXNWYWxpZChfaXRlbVN0cmluZywgX2luZGV4KSkge1xuICAgICAgcmV0dXJuIF9pbmRleDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gaGlnaGxpZ2h0ZWRJbmRleDtcbn1cblxudmFyIHByb3BUeXBlcyA9IHtcbiAgaXRlbXM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBpdGVtVG9TdHJpbmc6IFByb3BUeXBlcy5mdW5jLFxuICBnZXRBMTF5U3RhdHVzTWVzc2FnZTogUHJvcFR5cGVzLmZ1bmMsXG4gIGdldEExMXlTZWxlY3Rpb25NZXNzYWdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgY2lyY3VsYXJOYXZpZ2F0aW9uOiBQcm9wVHlwZXMuYm9vbCxcbiAgaGlnaGxpZ2h0ZWRJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsXG4gIGluaXRpYWxIaWdobGlnaHRlZEluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICBpc09wZW46IFByb3BUeXBlcy5ib29sLFxuICBkZWZhdWx0SXNPcGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgaW5pdGlhbElzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIHNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgaW5pdGlhbFNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgZGVmYXVsdFNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgaWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGxhYmVsSWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIG1lbnVJZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgZ2V0SXRlbUlkOiBQcm9wVHlwZXMuZnVuYyxcbiAgdG9nZ2xlQnV0dG9uSWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIHN0YXRlUmVkdWNlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uU2VsZWN0ZWRJdGVtQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25IaWdobGlnaHRlZEluZGV4Q2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25TdGF0ZUNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uSXNPcGVuQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgZW52aXJvbm1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZG9jdW1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBnZXRFbGVtZW50QnlJZDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICBhY3RpdmVFbGVtZW50OiBQcm9wVHlwZXMuYW55LFxuICAgICAgYm9keTogUHJvcFR5cGVzLmFueVxuICAgIH0pXG4gIH0pXG59O1xuLyoqXG4gKiBEZWZhdWx0IGltcGxlbWVudGF0aW9uIGZvciBzdGF0dXMgbWVzc2FnZS4gT25seSBhZGRlZCB3aGVuIG1lbnUgaXMgb3Blbi5cbiAqIFdpbGwgc3BlY2lmdCBpZiB0aGVyZSBhcmUgcmVzdWx0cyBpbiB0aGUgbGlzdCwgYW5kIGlmIHNvLCBob3cgbWFueSxcbiAqIGFuZCB3aGF0IGtleXMgYXJlIHJlbGV2YW50LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbSB0aGUgZG93bnNoaWZ0IHN0YXRlIGFuZCBvdGhlciByZWxldmFudCBwcm9wZXJ0aWVzXG4gKiBAcmV0dXJuIHtTdHJpbmd9IHRoZSBhMTF5IHN0YXR1cyBtZXNzYWdlXG4gKi9cblxuZnVuY3Rpb24gZ2V0QTExeVN0YXR1c01lc3NhZ2UkMShfcmVmKSB7XG4gIHZhciBpc09wZW4gPSBfcmVmLmlzT3BlbixcbiAgICAgIHJlc3VsdENvdW50ID0gX3JlZi5yZXN1bHRDb3VudCxcbiAgICAgIHByZXZpb3VzUmVzdWx0Q291bnQgPSBfcmVmLnByZXZpb3VzUmVzdWx0Q291bnQ7XG5cbiAgaWYgKCFpc09wZW4pIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAoIXJlc3VsdENvdW50KSB7XG4gICAgcmV0dXJuICdObyByZXN1bHRzIGFyZSBhdmFpbGFibGUuJztcbiAgfVxuXG4gIGlmIChyZXN1bHRDb3VudCAhPT0gcHJldmlvdXNSZXN1bHRDb3VudCkge1xuICAgIHJldHVybiByZXN1bHRDb3VudCArIFwiIHJlc3VsdFwiICsgKHJlc3VsdENvdW50ID09PSAxID8gJyBpcycgOiAncyBhcmUnKSArIFwiIGF2YWlsYWJsZSwgdXNlIHVwIGFuZCBkb3duIGFycm93IGtleXMgdG8gbmF2aWdhdGUuIFByZXNzIEVudGVyIG9yIFNwYWNlIEJhciBrZXlzIHRvIHNlbGVjdC5cIjtcbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxudmFyIGRlZmF1bHRQcm9wcyQxID0gX2V4dGVuZHMoe30sIGRlZmF1bHRQcm9wcywge1xuICBnZXRBMTF5U3RhdHVzTWVzc2FnZTogZ2V0QTExeVN0YXR1c01lc3NhZ2UkMVxufSk7XG5cbnZhciBNZW51S2V5RG93bkFycm93RG93biA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX21lbnVfa2V5ZG93bl9hcnJvd19kb3duX18nIDogMDtcbnZhciBNZW51S2V5RG93bkFycm93VXAgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19tZW51X2tleWRvd25fYXJyb3dfdXBfXycgOiAxO1xudmFyIE1lbnVLZXlEb3duRXNjYXBlID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fbWVudV9rZXlkb3duX2VzY2FwZV9fJyA6IDI7XG52YXIgTWVudUtleURvd25Ib21lID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fbWVudV9rZXlkb3duX2hvbWVfXycgOiAzO1xudmFyIE1lbnVLZXlEb3duRW5kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fbWVudV9rZXlkb3duX2VuZF9fJyA6IDQ7XG52YXIgTWVudUtleURvd25FbnRlciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX21lbnVfa2V5ZG93bl9lbnRlcl9fJyA6IDU7XG52YXIgTWVudUtleURvd25TcGFjZUJ1dHRvbiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX21lbnVfa2V5ZG93bl9zcGFjZV9idXR0b25fXycgOiA2O1xudmFyIE1lbnVLZXlEb3duQ2hhcmFjdGVyID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fbWVudV9rZXlkb3duX2NoYXJhY3Rlcl9fJyA6IDc7XG52YXIgTWVudUJsdXIgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19tZW51X2JsdXJfXycgOiA4O1xudmFyIE1lbnVNb3VzZUxlYXZlID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fbWVudV9tb3VzZV9sZWF2ZV9fJyA6IDk7XG52YXIgSXRlbU1vdXNlTW92ZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2l0ZW1fbW91c2VfbW92ZV9fJyA6IDEwO1xudmFyIEl0ZW1DbGljayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2l0ZW1fY2xpY2tfXycgOiAxMTtcbnZhciBUb2dnbGVCdXR0b25DbGljayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3RvZ2dsZWJ1dHRvbl9jbGlja19fJyA6IDEyO1xudmFyIFRvZ2dsZUJ1dHRvbktleURvd25BcnJvd0Rvd24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX190b2dnbGVidXR0b25fa2V5ZG93bl9hcnJvd19kb3duX18nIDogMTM7XG52YXIgVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93VXAgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX190b2dnbGVidXR0b25fa2V5ZG93bl9hcnJvd191cF9fJyA6IDE0O1xudmFyIFRvZ2dsZUJ1dHRvbktleURvd25DaGFyYWN0ZXIgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX190b2dnbGVidXR0b25fa2V5ZG93bl9jaGFyYWN0ZXJfXycgOiAxNTtcbnZhciBGdW5jdGlvblRvZ2dsZU1lbnUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19mdW5jdGlvbl90b2dnbGVfbWVudV9fJyA6IDE2O1xudmFyIEZ1bmN0aW9uT3Blbk1lbnUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19mdW5jdGlvbl9vcGVuX21lbnVfXycgOiAxNztcbnZhciBGdW5jdGlvbkNsb3NlTWVudSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX2Nsb3NlX21lbnVfXycgOiAxODtcbnZhciBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXggPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19mdW5jdGlvbl9zZXRfaGlnaGxpZ2h0ZWRfaW5kZXhfXycgOiAxOTtcbnZhciBGdW5jdGlvblNlbGVjdEl0ZW0gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19mdW5jdGlvbl9zZWxlY3RfaXRlbV9fJyA6IDIwO1xudmFyIEZ1bmN0aW9uU2V0SW5wdXRWYWx1ZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9pbnB1dF92YWx1ZV9fJyA6IDIxO1xudmFyIEZ1bmN0aW9uUmVzZXQgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19mdW5jdGlvbl9yZXNldF9fJyA6IDIyO1xuXG52YXIgc3RhdGVDaGFuZ2VUeXBlcyQxID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIE1lbnVLZXlEb3duQXJyb3dEb3duOiBNZW51S2V5RG93bkFycm93RG93bixcbiAgTWVudUtleURvd25BcnJvd1VwOiBNZW51S2V5RG93bkFycm93VXAsXG4gIE1lbnVLZXlEb3duRXNjYXBlOiBNZW51S2V5RG93bkVzY2FwZSxcbiAgTWVudUtleURvd25Ib21lOiBNZW51S2V5RG93bkhvbWUsXG4gIE1lbnVLZXlEb3duRW5kOiBNZW51S2V5RG93bkVuZCxcbiAgTWVudUtleURvd25FbnRlcjogTWVudUtleURvd25FbnRlcixcbiAgTWVudUtleURvd25TcGFjZUJ1dHRvbjogTWVudUtleURvd25TcGFjZUJ1dHRvbixcbiAgTWVudUtleURvd25DaGFyYWN0ZXI6IE1lbnVLZXlEb3duQ2hhcmFjdGVyLFxuICBNZW51Qmx1cjogTWVudUJsdXIsXG4gIE1lbnVNb3VzZUxlYXZlOiBNZW51TW91c2VMZWF2ZSxcbiAgSXRlbU1vdXNlTW92ZTogSXRlbU1vdXNlTW92ZSxcbiAgSXRlbUNsaWNrOiBJdGVtQ2xpY2ssXG4gIFRvZ2dsZUJ1dHRvbkNsaWNrOiBUb2dnbGVCdXR0b25DbGljayxcbiAgVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93RG93bjogVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93RG93bixcbiAgVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93VXA6IFRvZ2dsZUJ1dHRvbktleURvd25BcnJvd1VwLFxuICBUb2dnbGVCdXR0b25LZXlEb3duQ2hhcmFjdGVyOiBUb2dnbGVCdXR0b25LZXlEb3duQ2hhcmFjdGVyLFxuICBGdW5jdGlvblRvZ2dsZU1lbnU6IEZ1bmN0aW9uVG9nZ2xlTWVudSxcbiAgRnVuY3Rpb25PcGVuTWVudTogRnVuY3Rpb25PcGVuTWVudSxcbiAgRnVuY3Rpb25DbG9zZU1lbnU6IEZ1bmN0aW9uQ2xvc2VNZW51LFxuICBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXg6IEZ1bmN0aW9uU2V0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgRnVuY3Rpb25TZWxlY3RJdGVtOiBGdW5jdGlvblNlbGVjdEl0ZW0sXG4gIEZ1bmN0aW9uU2V0SW5wdXRWYWx1ZTogRnVuY3Rpb25TZXRJbnB1dFZhbHVlLFxuICBGdW5jdGlvblJlc2V0OiBGdW5jdGlvblJlc2V0XG59KTtcblxuLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqL1xuXG5mdW5jdGlvbiBkb3duc2hpZnRTZWxlY3RSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pIHtcbiAgdmFyIHR5cGUgPSBhY3Rpb24udHlwZSxcbiAgICAgIHByb3BzID0gYWN0aW9uLnByb3BzLFxuICAgICAgc2hpZnRLZXkgPSBhY3Rpb24uc2hpZnRLZXk7XG4gIHZhciBjaGFuZ2VzO1xuXG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgSXRlbU1vdXNlTW92ZTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGFjdGlvbi5pbmRleFxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBJdGVtQ2xpY2s6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBpc09wZW46IGdldERlZmF1bHRWYWx1ZShwcm9wcywgJ2lzT3BlbicpLFxuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdoaWdobGlnaHRlZEluZGV4JyksXG4gICAgICAgIHNlbGVjdGVkSXRlbTogcHJvcHMuaXRlbXNbYWN0aW9uLmluZGV4XVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBUb2dnbGVCdXR0b25LZXlEb3duQ2hhcmFjdGVyOlxuICAgICAge1xuICAgICAgICB2YXIgbG93ZXJjYXNlZEtleSA9IGFjdGlvbi5rZXk7XG4gICAgICAgIHZhciBpbnB1dFZhbHVlID0gXCJcIiArIHN0YXRlLmlucHV0VmFsdWUgKyBsb3dlcmNhc2VkS2V5O1xuICAgICAgICB2YXIgaXRlbUluZGV4ID0gZ2V0SXRlbUluZGV4QnlDaGFyYWN0ZXJLZXkoaW5wdXRWYWx1ZSwgc3RhdGUuc2VsZWN0ZWRJdGVtID8gcHJvcHMuaXRlbXMuaW5kZXhPZihzdGF0ZS5zZWxlY3RlZEl0ZW0pIDogLTEsIHByb3BzLml0ZW1zLCBwcm9wcy5pdGVtVG9TdHJpbmcsIGFjdGlvbi5nZXRJdGVtTm9kZUZyb21JbmRleCk7XG4gICAgICAgIGNoYW5nZXMgPSBfZXh0ZW5kcyh7XG4gICAgICAgICAgaW5wdXRWYWx1ZTogaW5wdXRWYWx1ZVxuICAgICAgICB9LCBpdGVtSW5kZXggPj0gMCAmJiB7XG4gICAgICAgICAgc2VsZWN0ZWRJdGVtOiBwcm9wcy5pdGVtc1tpdGVtSW5kZXhdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIFRvZ2dsZUJ1dHRvbktleURvd25BcnJvd0Rvd246XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgMSwgYWN0aW9uLmdldEl0ZW1Ob2RlRnJvbUluZGV4KSxcbiAgICAgICAgaXNPcGVuOiB0cnVlXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIFRvZ2dsZUJ1dHRvbktleURvd25BcnJvd1VwOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0SGlnaGxpZ2h0ZWRJbmRleE9uT3Blbihwcm9wcywgc3RhdGUsIC0xLCBhY3Rpb24uZ2V0SXRlbU5vZGVGcm9tSW5kZXgpLFxuICAgICAgICBpc09wZW46IHRydWVcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgTWVudUtleURvd25FbnRlcjpcbiAgICBjYXNlIE1lbnVLZXlEb3duU3BhY2VCdXR0b246XG4gICAgICBjaGFuZ2VzID0gX2V4dGVuZHMoe1xuICAgICAgICBpc09wZW46IGdldERlZmF1bHRWYWx1ZShwcm9wcywgJ2lzT3BlbicpLFxuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdoaWdobGlnaHRlZEluZGV4JylcbiAgICAgIH0sIHN0YXRlLmhpZ2hsaWdodGVkSW5kZXggPj0gMCAmJiB7XG4gICAgICAgIHNlbGVjdGVkSXRlbTogcHJvcHMuaXRlbXNbc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleF1cbiAgICAgIH0pO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIE1lbnVLZXlEb3duSG9tZTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldE5leHROb25EaXNhYmxlZEluZGV4KDEsIDAsIHByb3BzLml0ZW1zLmxlbmd0aCwgYWN0aW9uLmdldEl0ZW1Ob2RlRnJvbUluZGV4LCBmYWxzZSlcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgTWVudUtleURvd25FbmQ6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXROZXh0Tm9uRGlzYWJsZWRJbmRleCgtMSwgcHJvcHMuaXRlbXMubGVuZ3RoIC0gMSwgcHJvcHMuaXRlbXMubGVuZ3RoLCBhY3Rpb24uZ2V0SXRlbU5vZGVGcm9tSW5kZXgsIGZhbHNlKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBNZW51S2V5RG93bkVzY2FwZTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogZmFsc2UsXG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IC0xXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIE1lbnVCbHVyOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaXNPcGVuOiBmYWxzZSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogLTFcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgTWVudUtleURvd25DaGFyYWN0ZXI6XG4gICAgICB7XG4gICAgICAgIHZhciBfbG93ZXJjYXNlZEtleSA9IGFjdGlvbi5rZXk7XG5cbiAgICAgICAgdmFyIF9pbnB1dFZhbHVlID0gXCJcIiArIHN0YXRlLmlucHV0VmFsdWUgKyBfbG93ZXJjYXNlZEtleTtcblxuICAgICAgICB2YXIgaGlnaGxpZ2h0ZWRJbmRleCA9IGdldEl0ZW1JbmRleEJ5Q2hhcmFjdGVyS2V5KF9pbnB1dFZhbHVlLCBzdGF0ZS5oaWdobGlnaHRlZEluZGV4LCBwcm9wcy5pdGVtcywgcHJvcHMuaXRlbVRvU3RyaW5nLCBhY3Rpb24uZ2V0SXRlbU5vZGVGcm9tSW5kZXgpO1xuICAgICAgICBjaGFuZ2VzID0gX2V4dGVuZHMoe1xuICAgICAgICAgIGlucHV0VmFsdWU6IF9pbnB1dFZhbHVlXG4gICAgICAgIH0sIGhpZ2hsaWdodGVkSW5kZXggPj0gMCAmJiB7XG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBNZW51S2V5RG93bkFycm93RG93bjpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldE5leHRXcmFwcGluZ0luZGV4KHNoaWZ0S2V5ID8gNSA6IDEsIHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsIHByb3BzLml0ZW1zLmxlbmd0aCwgYWN0aW9uLmdldEl0ZW1Ob2RlRnJvbUluZGV4LCBwcm9wcy5jaXJjdWxhck5hdmlnYXRpb24pXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIE1lbnVLZXlEb3duQXJyb3dVcDpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldE5leHRXcmFwcGluZ0luZGV4KHNoaWZ0S2V5ID8gLTUgOiAtMSwgc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCwgcHJvcHMuaXRlbXMubGVuZ3RoLCBhY3Rpb24uZ2V0SXRlbU5vZGVGcm9tSW5kZXgsIHByb3BzLmNpcmN1bGFyTmF2aWdhdGlvbilcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgTWVudU1vdXNlTGVhdmU6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiAtMVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBUb2dnbGVCdXR0b25DbGljazpcbiAgICBjYXNlIEZ1bmN0aW9uVG9nZ2xlTWVudTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogIXN0YXRlLmlzT3BlbixcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogc3RhdGUuaXNPcGVuID8gLTEgOiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgMClcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgRnVuY3Rpb25PcGVuTWVudTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0SGlnaGxpZ2h0ZWRJbmRleE9uT3Blbihwcm9wcywgc3RhdGUsIDApXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIEZ1bmN0aW9uQ2xvc2VNZW51OlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaXNPcGVuOiBmYWxzZVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXg6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBhY3Rpb24uaGlnaGxpZ2h0ZWRJbmRleFxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBGdW5jdGlvblNlbGVjdEl0ZW06XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBzZWxlY3RlZEl0ZW06IGFjdGlvbi5zZWxlY3RlZEl0ZW1cbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgRnVuY3Rpb25TZXRJbnB1dFZhbHVlOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaW5wdXRWYWx1ZTogYWN0aW9uLmlucHV0VmFsdWVcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgRnVuY3Rpb25SZXNldDpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldERlZmF1bHRWYWx1ZShwcm9wcywgJ2hpZ2hsaWdodGVkSW5kZXgnKSxcbiAgICAgICAgaXNPcGVuOiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdpc09wZW4nKSxcbiAgICAgICAgc2VsZWN0ZWRJdGVtOiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdzZWxlY3RlZEl0ZW0nKSxcbiAgICAgICAgaW5wdXRWYWx1ZTogZ2V0RGVmYXVsdFZhbHVlKHByb3BzLCAnaW5wdXRWYWx1ZScpXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWR1Y2VyIGNhbGxlZCB3aXRob3V0IHByb3BlciBhY3Rpb24gdHlwZS4nKTtcbiAgfVxuXG4gIHJldHVybiBfZXh0ZW5kcyh7fSwgc3RhdGUsIGNoYW5nZXMpO1xufVxuLyogZXNsaW50LWVuYWJsZSBjb21wbGV4aXR5ICovXG5cbnZhciB2YWxpZGF0ZVByb3BUeXBlcyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgP1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbm51bGwgOiBnZXRQcm9wVHlwZXNWYWxpZGF0b3IodXNlU2VsZWN0LCBwcm9wVHlwZXMpO1xudXNlU2VsZWN0LnN0YXRlQ2hhbmdlVHlwZXMgPSBzdGF0ZUNoYW5nZVR5cGVzJDE7XG5cbmZ1bmN0aW9uIHVzZVNlbGVjdCh1c2VyUHJvcHMpIHtcbiAgaWYgKHVzZXJQcm9wcyA9PT0gdm9pZCAwKSB7XG4gICAgdXNlclByb3BzID0ge307XG4gIH1cblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgIHZhbGlkYXRlUHJvcFR5cGVzKHVzZXJQcm9wcyk7XG4gIH0gLy8gUHJvcHMgZGVmYXVsdHMgYW5kIGRlc3RydWN0dXJpbmcuXG5cblxuICB2YXIgcHJvcHMgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdFByb3BzJDEsIHVzZXJQcm9wcyk7XG5cbiAgdmFyIGl0ZW1zID0gcHJvcHMuaXRlbXMsXG4gICAgICBzY3JvbGxJbnRvVmlldyA9IHByb3BzLnNjcm9sbEludG9WaWV3LFxuICAgICAgZW52aXJvbm1lbnQgPSBwcm9wcy5lbnZpcm9ubWVudCxcbiAgICAgIGluaXRpYWxJc09wZW4gPSBwcm9wcy5pbml0aWFsSXNPcGVuLFxuICAgICAgZGVmYXVsdElzT3BlbiA9IHByb3BzLmRlZmF1bHRJc09wZW4sXG4gICAgICBpdGVtVG9TdHJpbmcgPSBwcm9wcy5pdGVtVG9TdHJpbmcsXG4gICAgICBnZXRBMTF5U2VsZWN0aW9uTWVzc2FnZSA9IHByb3BzLmdldEExMXlTZWxlY3Rpb25NZXNzYWdlLFxuICAgICAgZ2V0QTExeVN0YXR1c01lc3NhZ2UgPSBwcm9wcy5nZXRBMTF5U3RhdHVzTWVzc2FnZTsgLy8gSW5pdGlhbCBzdGF0ZSBkZXBlbmRpbmcgb24gY29udHJvbGxlZCBwcm9wcy5cblxuICB2YXIgaW5pdGlhbFN0YXRlID0gZ2V0SW5pdGlhbFN0YXRlKHByb3BzKTtcblxuICB2YXIgX3VzZUNvbnRyb2xsZWRSZWR1Y2VyID0gdXNlQ29udHJvbGxlZFJlZHVjZXIoZG93bnNoaWZ0U2VsZWN0UmVkdWNlciwgaW5pdGlhbFN0YXRlLCBwcm9wcyksXG4gICAgICBzdGF0ZSA9IF91c2VDb250cm9sbGVkUmVkdWNlclswXSxcbiAgICAgIGRpc3BhdGNoID0gX3VzZUNvbnRyb2xsZWRSZWR1Y2VyWzFdO1xuXG4gIHZhciBpc09wZW4gPSBzdGF0ZS5pc09wZW4sXG4gICAgICBoaWdobGlnaHRlZEluZGV4ID0gc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgIHNlbGVjdGVkSXRlbSA9IHN0YXRlLnNlbGVjdGVkSXRlbSxcbiAgICAgIGlucHV0VmFsdWUgPSBzdGF0ZS5pbnB1dFZhbHVlOyAvLyBFbGVtZW50IGVmcy5cblxuICB2YXIgdG9nZ2xlQnV0dG9uUmVmID0gdXNlUmVmKG51bGwpO1xuICB2YXIgbWVudVJlZiA9IHVzZVJlZihudWxsKTtcbiAgdmFyIGl0ZW1SZWZzID0gdXNlUmVmKCk7XG4gIGl0ZW1SZWZzLmN1cnJlbnQgPSB7fTsgLy8gdXNlZCBub3QgdG8gdHJpZ2dlciBtZW51IGJsdXIgYWN0aW9uIGluIHNvbWUgc2NlbmFyaW9zLlxuXG4gIHZhciBzaG91bGRCbHVyUmVmID0gdXNlUmVmKHRydWUpOyAvLyB1c2VkIHRvIGtlZXAgdGhlIGlucHV0VmFsdWUgY2xlYXJUaW1lb3V0IG9iamVjdCBiZXR3ZWVuIHJlbmRlcnMuXG5cbiAgdmFyIGNsZWFyVGltZW91dFJlZiA9IHVzZVJlZihudWxsKTsgLy8gcHJldmVudCBpZCByZS1nZW5lcmF0aW9uIGJldHdlZW4gcmVuZGVycy5cblxuICB2YXIgZWxlbWVudElkc1JlZiA9IHVzZVJlZihnZXRFbGVtZW50SWRzKHByb3BzKSk7IC8vIHVzZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBpdGVtcyB3ZSBoYWQgb24gcHJldmlvdXMgY3ljbGUuXG5cbiAgdmFyIHByZXZpb3VzUmVzdWx0Q291bnRSZWYgPSB1c2VSZWYoKTtcbiAgdmFyIGlzSW5pdGlhbE1vdW50UmVmID0gdXNlUmVmKHRydWUpOyAvLyB1dGlsaXR5IGNhbGxiYWNrIHRvIGdldCBpdGVtIGVsZW1lbnQuXG5cbiAgdmFyIGxhdGVzdCA9IHVzZUxhdGVzdFJlZih7XG4gICAgc3RhdGU6IHN0YXRlLFxuICAgIHByb3BzOiBwcm9wc1xuICB9KTsgLy8gU29tZSB1dGlscy5cblxuICB2YXIgZ2V0SXRlbU5vZGVGcm9tSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICByZXR1cm4gaXRlbVJlZnMuY3VycmVudFtlbGVtZW50SWRzUmVmLmN1cnJlbnQuZ2V0SXRlbUlkKGluZGV4KV07XG4gIH07IC8vIEVmZmVjdHMuXG4gIC8vIFNldHMgYTExeSBzdGF0dXMgbWVzc2FnZSBvbiBjaGFuZ2VzIGluIHN0YXRlLlxuXG5cbiAgdXNlQTExeU1lc3NhZ2VTZXR0ZXIoZ2V0QTExeVN0YXR1c01lc3NhZ2UsIFtpc09wZW4sIGhpZ2hsaWdodGVkSW5kZXgsIGlucHV0VmFsdWUsIGl0ZW1zXSwgX2V4dGVuZHMoe1xuICAgIGlzSW5pdGlhbE1vdW50OiBpc0luaXRpYWxNb3VudFJlZi5jdXJyZW50LFxuICAgIHByZXZpb3VzUmVzdWx0Q291bnQ6IHByZXZpb3VzUmVzdWx0Q291bnRSZWYuY3VycmVudCxcbiAgICBpdGVtczogaXRlbXMsXG4gICAgZW52aXJvbm1lbnQ6IGVudmlyb25tZW50LFxuICAgIGl0ZW1Ub1N0cmluZzogaXRlbVRvU3RyaW5nXG4gIH0sIHN0YXRlKSk7IC8vIFNldHMgYTExeSBzdGF0dXMgbWVzc2FnZSBvbiBjaGFuZ2VzIGluIHNlbGVjdGVkSXRlbS5cblxuICB1c2VBMTF5TWVzc2FnZVNldHRlcihnZXRBMTF5U2VsZWN0aW9uTWVzc2FnZSwgW3NlbGVjdGVkSXRlbV0sIF9leHRlbmRzKHtcbiAgICBpc0luaXRpYWxNb3VudDogaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCxcbiAgICBwcmV2aW91c1Jlc3VsdENvdW50OiBwcmV2aW91c1Jlc3VsdENvdW50UmVmLmN1cnJlbnQsXG4gICAgaXRlbXM6IGl0ZW1zLFxuICAgIGVudmlyb25tZW50OiBlbnZpcm9ubWVudCxcbiAgICBpdGVtVG9TdHJpbmc6IGl0ZW1Ub1N0cmluZ1xuICB9LCBzdGF0ZSkpOyAvLyBTY3JvbGwgb24gaGlnaGxpZ2h0ZWQgaXRlbSBpZiBjaGFuZ2UgY29tZXMgZnJvbSBrZXlib2FyZC5cblxuICB2YXIgc2hvdWxkU2Nyb2xsUmVmID0gdXNlU2Nyb2xsSW50b1ZpZXcoe1xuICAgIG1lbnVFbGVtZW50OiBtZW51UmVmLmN1cnJlbnQsXG4gICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBpc09wZW46IGlzT3BlbixcbiAgICBpdGVtUmVmczogaXRlbVJlZnMsXG4gICAgc2Nyb2xsSW50b1ZpZXc6IHNjcm9sbEludG9WaWV3LFxuICAgIGdldEl0ZW1Ob2RlRnJvbUluZGV4OiBnZXRJdGVtTm9kZUZyb21JbmRleFxuICB9KTsgLy8gU2V0cyBjbGVhbnVwIGZvciB0aGUga2V5c1NvRmFyIGFmdGVyIDUwMG1zLlxuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgLy8gaW5pdCB0aGUgY2xlYW4gZnVuY3Rpb24gaGVyZSBhcyB3ZSBuZWVkIGFjY2VzcyB0byBkaXNwYXRjaC5cbiAgICBpZiAoaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCkge1xuICAgICAgY2xlYXJUaW1lb3V0UmVmLmN1cnJlbnQgPSBkZWJvdW5jZShmdW5jdGlvbiAob3V0ZXJEaXNwYXRjaCkge1xuICAgICAgICBvdXRlckRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBGdW5jdGlvblNldElucHV0VmFsdWUsXG4gICAgICAgICAgaW5wdXRWYWx1ZTogJydcbiAgICAgICAgfSk7XG4gICAgICB9LCA1MDApO1xuICAgIH1cblxuICAgIGlmICghaW5wdXRWYWx1ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNsZWFyVGltZW91dFJlZi5jdXJyZW50KGRpc3BhdGNoKTtcbiAgfSwgW2Rpc3BhdGNoLCBpbnB1dFZhbHVlXSk7XG4gIHVzZUNvbnRyb2xQcm9wc1ZhbGlkYXRvcih7XG4gICAgaXNJbml0aWFsTW91bnQ6IGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQsXG4gICAgcHJvcHM6IHByb3BzLFxuICAgIHN0YXRlOiBzdGF0ZVxuICB9KTtcbiAgLyogQ29udHJvbHMgdGhlIGZvY3VzIG9uIHRoZSBtZW51IG9yIHRoZSB0b2dnbGUgYnV0dG9uLiAqL1xuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgLy8gRG9uJ3QgZm9jdXMgbWVudSBvbiBmaXJzdCByZW5kZXIuXG4gICAgaWYgKGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQpIHtcbiAgICAgIC8vIFVubGVzcyBpdCB3YXMgaW5pdGlhbGlzZWQgYXMgb3Blbi5cbiAgICAgIGlmICgoaW5pdGlhbElzT3BlbiB8fCBkZWZhdWx0SXNPcGVuIHx8IGlzT3BlbikgJiYgbWVudVJlZi5jdXJyZW50KSB7XG4gICAgICAgIG1lbnVSZWYuY3VycmVudC5mb2N1cygpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm47XG4gICAgfSAvLyBGb2N1cyBtZW51IG9uIG9wZW4uXG5cblxuICAgIGlmIChpc09wZW4pIHtcbiAgICAgIC8vIGlzdGFuYnVsIGlnbm9yZSBlbHNlXG4gICAgICBpZiAobWVudVJlZi5jdXJyZW50KSB7XG4gICAgICAgIG1lbnVSZWYuY3VycmVudC5mb2N1cygpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm47XG4gICAgfSAvLyBGb2N1cyB0b2dnbGVCdXR0b24gb24gY2xvc2UsIGJ1dCBub3QgaWYgaXQgd2FzIGNsb3NlZCB3aXRoIChTaGlmdCspVGFiLlxuXG5cbiAgICBpZiAoZW52aXJvbm1lbnQuZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gbWVudVJlZi5jdXJyZW50KSB7XG4gICAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgZWxzZVxuICAgICAgaWYgKHRvZ2dsZUJ1dHRvblJlZi5jdXJyZW50KSB7XG4gICAgICAgIHNob3VsZEJsdXJSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgICB0b2dnbGVCdXR0b25SZWYuY3VycmVudC5mb2N1cygpO1xuICAgICAgfVxuICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuXG4gIH0sIFtpc09wZW5dKTtcbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHByZXZpb3VzUmVzdWx0Q291bnRSZWYuY3VycmVudCA9IGl0ZW1zLmxlbmd0aDtcbiAgfSk7IC8vIEFkZCBtb3VzZS90b3VjaCBldmVudHMgdG8gZG9jdW1lbnQuXG5cbiAgdmFyIG1vdXNlQW5kVG91Y2hUcmFja2Vyc1JlZiA9IHVzZU1vdXNlQW5kVG91Y2hUcmFja2VyKGlzT3BlbiwgW21lbnVSZWYsIHRvZ2dsZUJ1dHRvblJlZl0sIGVudmlyb25tZW50LCBmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogTWVudUJsdXJcbiAgICB9KTtcbiAgfSk7XG4gIHZhciBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8gPSB1c2VHZXR0ZXJQcm9wc0NhbGxlZENoZWNrZXIoJ2dldE1lbnVQcm9wcycsICdnZXRUb2dnbGVCdXR0b25Qcm9wcycpOyAvLyBNYWtlIGluaXRpYWwgcmVmIGZhbHNlLlxuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCA9IGZhbHNlO1xuICB9LCBbXSk7IC8vIEV2ZW50IGhhbmRsZXIgZnVuY3Rpb25zLlxuXG4gIHZhciB0b2dnbGVCdXR0b25LZXlEb3duSGFuZGxlcnMgPSB1c2VNZW1vKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgQXJyb3dEb3duOiBmdW5jdGlvbiBBcnJvd0Rvd24oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IFRvZ2dsZUJ1dHRvbktleURvd25BcnJvd0Rvd24sXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4LFxuICAgICAgICAgIHNoaWZ0S2V5OiBldmVudC5zaGlmdEtleVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBBcnJvd1VwOiBmdW5jdGlvbiBBcnJvd1VwKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25LZXlEb3duQXJyb3dVcCxcbiAgICAgICAgICBnZXRJdGVtTm9kZUZyb21JbmRleDogZ2V0SXRlbU5vZGVGcm9tSW5kZXgsXG4gICAgICAgICAgc2hpZnRLZXk6IGV2ZW50LnNoaWZ0S2V5XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgbWVudUtleURvd25IYW5kbGVycyA9IHVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICBBcnJvd0Rvd246IGZ1bmN0aW9uIEFycm93RG93bihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogTWVudUtleURvd25BcnJvd0Rvd24sXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4LFxuICAgICAgICAgIHNoaWZ0S2V5OiBldmVudC5zaGlmdEtleVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBBcnJvd1VwOiBmdW5jdGlvbiBBcnJvd1VwKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBNZW51S2V5RG93bkFycm93VXAsXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4LFxuICAgICAgICAgIHNoaWZ0S2V5OiBldmVudC5zaGlmdEtleVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBIb21lOiBmdW5jdGlvbiBIb21lKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBNZW51S2V5RG93bkhvbWUsXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIEVuZDogZnVuY3Rpb24gRW5kKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBNZW51S2V5RG93bkVuZCxcbiAgICAgICAgICBnZXRJdGVtTm9kZUZyb21JbmRleDogZ2V0SXRlbU5vZGVGcm9tSW5kZXhcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgRXNjYXBlOiBmdW5jdGlvbiBFc2NhcGUoKSB7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBNZW51S2V5RG93bkVzY2FwZVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBFbnRlcjogZnVuY3Rpb24gRW50ZXIoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IE1lbnVLZXlEb3duRW50ZXJcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgJyAnOiBmdW5jdGlvbiBfKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBNZW51S2V5RG93blNwYWNlQnV0dG9uXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtkaXNwYXRjaF0pOyAvLyBBY3Rpb24gZnVuY3Rpb25zLlxuXG4gIHZhciB0b2dnbGVNZW51ID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKCkge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6IEZ1bmN0aW9uVG9nZ2xlTWVudVxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIGNsb3NlTWVudSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvbkNsb3NlTWVudVxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIG9wZW5NZW51ID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKCkge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6IEZ1bmN0aW9uT3Blbk1lbnVcbiAgICB9KTtcbiAgfSwgW2Rpc3BhdGNoXSk7XG4gIHZhciBzZXRIaWdobGlnaHRlZEluZGV4ID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKG5ld0hpZ2hsaWdodGVkSW5kZXgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICBoaWdobGlnaHRlZEluZGV4OiBuZXdIaWdobGlnaHRlZEluZGV4XG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2VsZWN0SXRlbSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdTZWxlY3RlZEl0ZW0pIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNlbGVjdEl0ZW0sXG4gICAgICBzZWxlY3RlZEl0ZW06IG5ld1NlbGVjdGVkSXRlbVxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIHJlc2V0ID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKCkge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6IEZ1bmN0aW9uUmVzZXRcbiAgICB9KTtcbiAgfSwgW2Rpc3BhdGNoXSk7XG4gIHZhciBzZXRJbnB1dFZhbHVlID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKG5ld0lucHV0VmFsdWUpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNldElucHV0VmFsdWUsXG4gICAgICBpbnB1dFZhbHVlOiBuZXdJbnB1dFZhbHVlXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pOyAvLyBHZXR0ZXIgZnVuY3Rpb25zLlxuXG4gIHZhciBnZXRMYWJlbFByb3BzID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKGxhYmVsUHJvcHMpIHtcbiAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgaWQ6IGVsZW1lbnRJZHNSZWYuY3VycmVudC5sYWJlbElkLFxuICAgICAgaHRtbEZvcjogZWxlbWVudElkc1JlZi5jdXJyZW50LnRvZ2dsZUJ1dHRvbklkXG4gICAgfSwgbGFiZWxQcm9wcyk7XG4gIH0sIFtdKTtcbiAgdmFyIGdldE1lbnVQcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcCwgX3RlbXAyKSB7XG4gICAgdmFyIF9leHRlbmRzMjtcblxuICAgIHZhciBfcmVmID0gX3RlbXAgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAsXG4gICAgICAgIG9uTW91c2VMZWF2ZSA9IF9yZWYub25Nb3VzZUxlYXZlLFxuICAgICAgICBfcmVmJHJlZktleSA9IF9yZWYucmVmS2V5LFxuICAgICAgICByZWZLZXkgPSBfcmVmJHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmJHJlZktleSxcbiAgICAgICAgb25LZXlEb3duID0gX3JlZi5vbktleURvd24sXG4gICAgICAgIG9uQmx1ciA9IF9yZWYub25CbHVyLFxuICAgICAgICByZWYgPSBfcmVmLnJlZixcbiAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYsIFtcIm9uTW91c2VMZWF2ZVwiLCBcInJlZktleVwiLCBcIm9uS2V5RG93blwiLCBcIm9uQmx1clwiLCBcInJlZlwiXSk7XG5cbiAgICB2YXIgX3JlZjIgPSBfdGVtcDIgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAyLFxuICAgICAgICBfcmVmMiRzdXBwcmVzc1JlZkVycm8gPSBfcmVmMi5zdXBwcmVzc1JlZkVycm9yLFxuICAgICAgICBzdXBwcmVzc1JlZkVycm9yID0gX3JlZjIkc3VwcHJlc3NSZWZFcnJvID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYyJHN1cHByZXNzUmVmRXJybztcblxuICAgIHZhciBsYXRlc3RTdGF0ZSA9IGxhdGVzdC5jdXJyZW50LnN0YXRlO1xuICAgIHNldEdldHRlclByb3BDYWxsSW5mbygnZ2V0TWVudVByb3BzJywgc3VwcHJlc3NSZWZFcnJvciwgcmVmS2V5LCBtZW51UmVmKTtcbiAgICByZXR1cm4gX2V4dGVuZHMoKF9leHRlbmRzMiA9IHt9LCBfZXh0ZW5kczJbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBmdW5jdGlvbiAobWVudU5vZGUpIHtcbiAgICAgIG1lbnVSZWYuY3VycmVudCA9IG1lbnVOb2RlO1xuICAgIH0pLCBfZXh0ZW5kczIuaWQgPSBlbGVtZW50SWRzUmVmLmN1cnJlbnQubWVudUlkLCBfZXh0ZW5kczIucm9sZSA9ICdsaXN0Ym94JywgX2V4dGVuZHMyWydhcmlhLWxhYmVsbGVkYnknXSA9IGVsZW1lbnRJZHNSZWYuY3VycmVudC5sYWJlbElkLCBfZXh0ZW5kczIudGFiSW5kZXggPSAtMSwgX2V4dGVuZHMyKSwgbGF0ZXN0U3RhdGUuaXNPcGVuICYmIGxhdGVzdFN0YXRlLmhpZ2hsaWdodGVkSW5kZXggPiAtMSAmJiB7XG4gICAgICAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogZWxlbWVudElkc1JlZi5jdXJyZW50LmdldEl0ZW1JZChsYXRlc3RTdGF0ZS5oaWdobGlnaHRlZEluZGV4KVxuICAgIH0sIHtcbiAgICAgIG9uTW91c2VMZWF2ZTogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25Nb3VzZUxlYXZlLCBmdW5jdGlvbiBtZW51SGFuZGxlTW91c2VMZWF2ZSgpIHtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IE1lbnVNb3VzZUxlYXZlXG4gICAgICAgIH0pO1xuICAgICAgfSksXG4gICAgICBvbktleURvd246IGNhbGxBbGxFdmVudEhhbmRsZXJzKG9uS2V5RG93biwgZnVuY3Rpb24gbWVudUhhbmRsZUtleURvd24oZXZlbnQpIHtcbiAgICAgICAgdmFyIGtleSA9IG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KTtcblxuICAgICAgICBpZiAoa2V5ICYmIG1lbnVLZXlEb3duSGFuZGxlcnNba2V5XSkge1xuICAgICAgICAgIG1lbnVLZXlEb3duSGFuZGxlcnNba2V5XShldmVudCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNBY2NlcHRlZENoYXJhY3RlcktleShrZXkpKSB7XG4gICAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgICAgdHlwZTogTWVudUtleURvd25DaGFyYWN0ZXIsXG4gICAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICAgIGdldEl0ZW1Ob2RlRnJvbUluZGV4OiBnZXRJdGVtTm9kZUZyb21JbmRleFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KSxcbiAgICAgIG9uQmx1cjogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25CbHVyLCBmdW5jdGlvbiBtZW51SGFuZGxlQmx1cigpIHtcbiAgICAgICAgLy8gaWYgdGhlIGJsdXIgd2FzIGEgcmVzdWx0IG9mIHNlbGVjdGlvbiwgd2UgZG9uJ3QgdHJpZ2dlciB0aGlzIGFjdGlvbi5cbiAgICAgICAgaWYgKHNob3VsZEJsdXJSZWYuY3VycmVudCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBzaG91bGRCbHVyUmVmLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzaG91bGRCbHVyID0gIW1vdXNlQW5kVG91Y2hUcmFja2Vyc1JlZi5jdXJyZW50LmlzTW91c2VEb3duO1xuICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuXG4gICAgICAgIGlmIChzaG91bGRCbHVyKSB7XG4gICAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgICAgdHlwZTogTWVudUJsdXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9LCByZXN0KTtcbiAgfSwgW2Rpc3BhdGNoLCBsYXRlc3QsIG1lbnVLZXlEb3duSGFuZGxlcnMsIG1vdXNlQW5kVG91Y2hUcmFja2Vyc1JlZiwgc2V0R2V0dGVyUHJvcENhbGxJbmZvXSk7XG4gIHZhciBnZXRUb2dnbGVCdXR0b25Qcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcDMsIF90ZW1wNCkge1xuICAgIHZhciBfZXh0ZW5kczM7XG5cbiAgICB2YXIgX3JlZjMgPSBfdGVtcDMgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAzLFxuICAgICAgICBvbkNsaWNrID0gX3JlZjMub25DbGljayxcbiAgICAgICAgb25LZXlEb3duID0gX3JlZjMub25LZXlEb3duLFxuICAgICAgICBfcmVmMyRyZWZLZXkgPSBfcmVmMy5yZWZLZXksXG4gICAgICAgIHJlZktleSA9IF9yZWYzJHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmMyRyZWZLZXksXG4gICAgICAgIHJlZiA9IF9yZWYzLnJlZixcbiAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYzLCBbXCJvbkNsaWNrXCIsIFwib25LZXlEb3duXCIsIFwicmVmS2V5XCIsIFwicmVmXCJdKTtcblxuICAgIHZhciBfcmVmNCA9IF90ZW1wNCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDQsXG4gICAgICAgIF9yZWY0JHN1cHByZXNzUmVmRXJybyA9IF9yZWY0LnN1cHByZXNzUmVmRXJyb3IsXG4gICAgICAgIHN1cHByZXNzUmVmRXJyb3IgPSBfcmVmNCRzdXBwcmVzc1JlZkVycm8gPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjQkc3VwcHJlc3NSZWZFcnJvO1xuXG4gICAgdmFyIHRvZ2dsZUJ1dHRvbkhhbmRsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25DbGlja1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciB0b2dnbGVCdXR0b25IYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICB2YXIga2V5ID0gbm9ybWFsaXplQXJyb3dLZXkoZXZlbnQpO1xuXG4gICAgICBpZiAoa2V5ICYmIHRvZ2dsZUJ1dHRvbktleURvd25IYW5kbGVyc1trZXldKSB7XG4gICAgICAgIHRvZ2dsZUJ1dHRvbktleURvd25IYW5kbGVyc1trZXldKGV2ZW50KTtcbiAgICAgIH0gZWxzZSBpZiAoaXNBY2NlcHRlZENoYXJhY3RlcktleShrZXkpKSB7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25LZXlEb3duQ2hhcmFjdGVyLFxuICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgIGdldEl0ZW1Ob2RlRnJvbUluZGV4OiBnZXRJdGVtTm9kZUZyb21JbmRleFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIHRvZ2dsZVByb3BzID0gX2V4dGVuZHMoKF9leHRlbmRzMyA9IHt9LCBfZXh0ZW5kczNbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBmdW5jdGlvbiAodG9nZ2xlQnV0dG9uTm9kZSkge1xuICAgICAgdG9nZ2xlQnV0dG9uUmVmLmN1cnJlbnQgPSB0b2dnbGVCdXR0b25Ob2RlO1xuICAgIH0pLCBfZXh0ZW5kczMuaWQgPSBlbGVtZW50SWRzUmVmLmN1cnJlbnQudG9nZ2xlQnV0dG9uSWQsIF9leHRlbmRzM1snYXJpYS1oYXNwb3B1cCddID0gJ2xpc3Rib3gnLCBfZXh0ZW5kczNbJ2FyaWEtZXhwYW5kZWQnXSA9IGxhdGVzdC5jdXJyZW50LnN0YXRlLmlzT3BlbiwgX2V4dGVuZHMzWydhcmlhLWxhYmVsbGVkYnknXSA9IGVsZW1lbnRJZHNSZWYuY3VycmVudC5sYWJlbElkICsgXCIgXCIgKyBlbGVtZW50SWRzUmVmLmN1cnJlbnQudG9nZ2xlQnV0dG9uSWQsIF9leHRlbmRzMyksIHJlc3QpO1xuXG4gICAgaWYgKCFyZXN0LmRpc2FibGVkKSB7XG4gICAgICB0b2dnbGVQcm9wcy5vbkNsaWNrID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DbGljaywgdG9nZ2xlQnV0dG9uSGFuZGxlQ2xpY2spO1xuICAgICAgdG9nZ2xlUHJvcHMub25LZXlEb3duID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCB0b2dnbGVCdXR0b25IYW5kbGVLZXlEb3duKTtcbiAgICB9XG5cbiAgICBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8oJ2dldFRvZ2dsZUJ1dHRvblByb3BzJywgc3VwcHJlc3NSZWZFcnJvciwgcmVmS2V5LCB0b2dnbGVCdXR0b25SZWYpO1xuICAgIHJldHVybiB0b2dnbGVQcm9wcztcbiAgfSwgW2Rpc3BhdGNoLCBsYXRlc3QsIHRvZ2dsZUJ1dHRvbktleURvd25IYW5kbGVycywgc2V0R2V0dGVyUHJvcENhbGxJbmZvXSk7XG4gIHZhciBnZXRJdGVtUHJvcHMgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoX3RlbXA1KSB7XG4gICAgdmFyIF9leHRlbmRzNDtcblxuICAgIHZhciBfcmVmNSA9IF90ZW1wNSA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDUsXG4gICAgICAgIGl0ZW0gPSBfcmVmNS5pdGVtLFxuICAgICAgICBpbmRleCA9IF9yZWY1LmluZGV4LFxuICAgICAgICBvbk1vdXNlTW92ZSA9IF9yZWY1Lm9uTW91c2VNb3ZlLFxuICAgICAgICBvbkNsaWNrID0gX3JlZjUub25DbGljayxcbiAgICAgICAgX3JlZjUkcmVmS2V5ID0gX3JlZjUucmVmS2V5LFxuICAgICAgICByZWZLZXkgPSBfcmVmNSRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjUkcmVmS2V5LFxuICAgICAgICByZWYgPSBfcmVmNS5yZWYsXG4gICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNSwgW1wiaXRlbVwiLCBcImluZGV4XCIsIFwib25Nb3VzZU1vdmVcIiwgXCJvbkNsaWNrXCIsIFwicmVmS2V5XCIsIFwicmVmXCJdKTtcblxuICAgIHZhciBfbGF0ZXN0JGN1cnJlbnQgPSBsYXRlc3QuY3VycmVudCxcbiAgICAgICAgbGF0ZXN0U3RhdGUgPSBfbGF0ZXN0JGN1cnJlbnQuc3RhdGUsXG4gICAgICAgIGxhdGVzdFByb3BzID0gX2xhdGVzdCRjdXJyZW50LnByb3BzO1xuXG4gICAgdmFyIGl0ZW1IYW5kbGVNb3VzZU1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaW5kZXggPT09IGxhdGVzdFN0YXRlLmhpZ2hsaWdodGVkSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzaG91bGRTY3JvbGxSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBJdGVtTW91c2VNb3ZlLFxuICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgaXRlbUhhbmRsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBJdGVtQ2xpY2ssXG4gICAgICAgIGluZGV4OiBpbmRleFxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBpdGVtSW5kZXggPSBnZXRJdGVtSW5kZXgoaW5kZXgsIGl0ZW0sIGxhdGVzdFByb3BzLml0ZW1zKTtcblxuICAgIGlmIChpdGVtSW5kZXggPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bhc3MgZWl0aGVyIGl0ZW0gb3IgaXRlbSBpbmRleCBpbiBnZXRJdGVtUHJvcHMhJyk7XG4gICAgfVxuXG4gICAgdmFyIGl0ZW1Qcm9wcyA9IF9leHRlbmRzKChfZXh0ZW5kczQgPSB7XG4gICAgICByb2xlOiAnb3B0aW9uJyxcbiAgICAgICdhcmlhLXNlbGVjdGVkJzogXCJcIiArIChpdGVtSW5kZXggPT09IGxhdGVzdFN0YXRlLmhpZ2hsaWdodGVkSW5kZXgpLFxuICAgICAgaWQ6IGVsZW1lbnRJZHNSZWYuY3VycmVudC5nZXRJdGVtSWQoaXRlbUluZGV4KVxuICAgIH0sIF9leHRlbmRzNFtyZWZLZXldID0gaGFuZGxlUmVmcyhyZWYsIGZ1bmN0aW9uIChpdGVtTm9kZSkge1xuICAgICAgaWYgKGl0ZW1Ob2RlKSB7XG4gICAgICAgIGl0ZW1SZWZzLmN1cnJlbnRbZWxlbWVudElkc1JlZi5jdXJyZW50LmdldEl0ZW1JZChpdGVtSW5kZXgpXSA9IGl0ZW1Ob2RlO1xuICAgICAgfVxuICAgIH0pLCBfZXh0ZW5kczQpLCByZXN0KTtcblxuICAgIGlmICghcmVzdC5kaXNhYmxlZCkge1xuICAgICAgaXRlbVByb3BzLm9uTW91c2VNb3ZlID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25Nb3VzZU1vdmUsIGl0ZW1IYW5kbGVNb3VzZU1vdmUpO1xuICAgICAgaXRlbVByb3BzLm9uQ2xpY2sgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkNsaWNrLCBpdGVtSGFuZGxlQ2xpY2spO1xuICAgIH1cblxuICAgIHJldHVybiBpdGVtUHJvcHM7XG4gIH0sIFtkaXNwYXRjaCwgbGF0ZXN0LCBzaG91bGRTY3JvbGxSZWZdKTtcbiAgcmV0dXJuIHtcbiAgICAvLyBwcm9wIGdldHRlcnMuXG4gICAgZ2V0VG9nZ2xlQnV0dG9uUHJvcHM6IGdldFRvZ2dsZUJ1dHRvblByb3BzLFxuICAgIGdldExhYmVsUHJvcHM6IGdldExhYmVsUHJvcHMsXG4gICAgZ2V0TWVudVByb3BzOiBnZXRNZW51UHJvcHMsXG4gICAgZ2V0SXRlbVByb3BzOiBnZXRJdGVtUHJvcHMsXG4gICAgLy8gYWN0aW9ucy5cbiAgICB0b2dnbGVNZW51OiB0b2dnbGVNZW51LFxuICAgIG9wZW5NZW51OiBvcGVuTWVudSxcbiAgICBjbG9zZU1lbnU6IGNsb3NlTWVudSxcbiAgICBzZXRIaWdobGlnaHRlZEluZGV4OiBzZXRIaWdobGlnaHRlZEluZGV4LFxuICAgIHNlbGVjdEl0ZW06IHNlbGVjdEl0ZW0sXG4gICAgcmVzZXQ6IHJlc2V0LFxuICAgIHNldElucHV0VmFsdWU6IHNldElucHV0VmFsdWUsXG4gICAgLy8gc3RhdGUuXG4gICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBpc09wZW46IGlzT3BlbixcbiAgICBzZWxlY3RlZEl0ZW06IHNlbGVjdGVkSXRlbSxcbiAgICBpbnB1dFZhbHVlOiBpbnB1dFZhbHVlXG4gIH07XG59XG5cbnZhciBJbnB1dEtleURvd25BcnJvd0Rvd24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX2Fycm93X2Rvd25fXycgOiAwO1xudmFyIElucHV0S2V5RG93bkFycm93VXAgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX2Fycm93X3VwX18nIDogMTtcbnZhciBJbnB1dEtleURvd25Fc2NhcGUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX2VzY2FwZV9fJyA6IDI7XG52YXIgSW5wdXRLZXlEb3duSG9tZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2lucHV0X2tleWRvd25faG9tZV9fJyA6IDM7XG52YXIgSW5wdXRLZXlEb3duRW5kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19faW5wdXRfa2V5ZG93bl9lbmRfXycgOiA0O1xudmFyIElucHV0S2V5RG93bkVudGVyID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19faW5wdXRfa2V5ZG93bl9lbnRlcl9fJyA6IDU7XG52YXIgSW5wdXRDaGFuZ2UgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9jaGFuZ2VfXycgOiA2O1xudmFyIElucHV0Qmx1ciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2lucHV0X2JsdXJfXycgOiA3O1xudmFyIE1lbnVNb3VzZUxlYXZlJDEgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19tZW51X21vdXNlX2xlYXZlX18nIDogODtcbnZhciBJdGVtTW91c2VNb3ZlJDEgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pdGVtX21vdXNlX21vdmVfXycgOiA5O1xudmFyIEl0ZW1DbGljayQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19faXRlbV9jbGlja19fJyA6IDEwO1xudmFyIFRvZ2dsZUJ1dHRvbkNsaWNrJDEgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX190b2dnbGVidXR0b25fY2xpY2tfXycgOiAxMTtcbnZhciBGdW5jdGlvblRvZ2dsZU1lbnUkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3RvZ2dsZV9tZW51X18nIDogMTI7XG52YXIgRnVuY3Rpb25PcGVuTWVudSQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fb3Blbl9tZW51X18nIDogMTM7XG52YXIgRnVuY3Rpb25DbG9zZU1lbnUkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX2Nsb3NlX21lbnVfXycgOiAxNDtcbnZhciBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXgkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9oaWdobGlnaHRlZF9pbmRleF9fJyA6IDE1O1xudmFyIEZ1bmN0aW9uU2VsZWN0SXRlbSQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fc2VsZWN0X2l0ZW1fXycgOiAxNjtcbnZhciBGdW5jdGlvblNldElucHV0VmFsdWUkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9pbnB1dF92YWx1ZV9fJyA6IDE3O1xudmFyIEZ1bmN0aW9uUmVzZXQkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3Jlc2V0X18nIDogMTg7XG52YXIgQ29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fY29udHJvbGxlZF9wcm9wX3VwZGF0ZWRfc2VsZWN0ZWRfaXRlbV9fJyA6IDE5O1xuXG52YXIgc3RhdGVDaGFuZ2VUeXBlcyQyID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIElucHV0S2V5RG93bkFycm93RG93bjogSW5wdXRLZXlEb3duQXJyb3dEb3duLFxuICBJbnB1dEtleURvd25BcnJvd1VwOiBJbnB1dEtleURvd25BcnJvd1VwLFxuICBJbnB1dEtleURvd25Fc2NhcGU6IElucHV0S2V5RG93bkVzY2FwZSxcbiAgSW5wdXRLZXlEb3duSG9tZTogSW5wdXRLZXlEb3duSG9tZSxcbiAgSW5wdXRLZXlEb3duRW5kOiBJbnB1dEtleURvd25FbmQsXG4gIElucHV0S2V5RG93bkVudGVyOiBJbnB1dEtleURvd25FbnRlcixcbiAgSW5wdXRDaGFuZ2U6IElucHV0Q2hhbmdlLFxuICBJbnB1dEJsdXI6IElucHV0Qmx1cixcbiAgTWVudU1vdXNlTGVhdmU6IE1lbnVNb3VzZUxlYXZlJDEsXG4gIEl0ZW1Nb3VzZU1vdmU6IEl0ZW1Nb3VzZU1vdmUkMSxcbiAgSXRlbUNsaWNrOiBJdGVtQ2xpY2skMSxcbiAgVG9nZ2xlQnV0dG9uQ2xpY2s6IFRvZ2dsZUJ1dHRvbkNsaWNrJDEsXG4gIEZ1bmN0aW9uVG9nZ2xlTWVudTogRnVuY3Rpb25Ub2dnbGVNZW51JDEsXG4gIEZ1bmN0aW9uT3Blbk1lbnU6IEZ1bmN0aW9uT3Blbk1lbnUkMSxcbiAgRnVuY3Rpb25DbG9zZU1lbnU6IEZ1bmN0aW9uQ2xvc2VNZW51JDEsXG4gIEZ1bmN0aW9uU2V0SGlnaGxpZ2h0ZWRJbmRleDogRnVuY3Rpb25TZXRIaWdobGlnaHRlZEluZGV4JDEsXG4gIEZ1bmN0aW9uU2VsZWN0SXRlbTogRnVuY3Rpb25TZWxlY3RJdGVtJDEsXG4gIEZ1bmN0aW9uU2V0SW5wdXRWYWx1ZTogRnVuY3Rpb25TZXRJbnB1dFZhbHVlJDEsXG4gIEZ1bmN0aW9uUmVzZXQ6IEZ1bmN0aW9uUmVzZXQkMSxcbiAgQ29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtOiBDb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW1cbn0pO1xuXG5mdW5jdGlvbiBnZXRFbGVtZW50SWRzJDEoX3JlZikge1xuICB2YXIgaWQgPSBfcmVmLmlkLFxuICAgICAgaW5wdXRJZCA9IF9yZWYuaW5wdXRJZCxcbiAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmLCBbXCJpZFwiLCBcImlucHV0SWRcIl0pO1xuXG4gIHZhciB1bmlxdWVJZCA9IGlkID09PSB1bmRlZmluZWQgPyBcImRvd25zaGlmdC1cIiArIGdlbmVyYXRlSWQoKSA6IGlkO1xuICByZXR1cm4gX2V4dGVuZHMoe1xuICAgIGlucHV0SWQ6IGlucHV0SWQgfHwgdW5pcXVlSWQgKyBcIi1pbnB1dFwiXG4gIH0sIGdldEVsZW1lbnRJZHMoX2V4dGVuZHMoe1xuICAgIGlkOiBpZFxuICB9LCByZXN0KSkpO1xufVxuZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlJDEocHJvcHMpIHtcbiAgdmFyIGluaXRpYWxTdGF0ZSA9IGdldEluaXRpYWxTdGF0ZShwcm9wcyk7XG4gIHZhciBzZWxlY3RlZEl0ZW0gPSBpbml0aWFsU3RhdGUuc2VsZWN0ZWRJdGVtO1xuICB2YXIgaW5wdXRWYWx1ZSA9IGluaXRpYWxTdGF0ZS5pbnB1dFZhbHVlO1xuXG4gIGlmIChpbnB1dFZhbHVlID09PSAnJyAmJiBzZWxlY3RlZEl0ZW0gJiYgcHJvcHMuZGVmYXVsdElucHV0VmFsdWUgPT09IHVuZGVmaW5lZCAmJiBwcm9wcy5pbml0aWFsSW5wdXRWYWx1ZSA9PT0gdW5kZWZpbmVkICYmIHByb3BzLmlucHV0VmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIGlucHV0VmFsdWUgPSBwcm9wcy5pdGVtVG9TdHJpbmcoc2VsZWN0ZWRJdGVtKTtcbiAgfVxuXG4gIHJldHVybiBfZXh0ZW5kcyh7fSwgaW5pdGlhbFN0YXRlLCB7XG4gICAgaW5wdXRWYWx1ZTogaW5wdXRWYWx1ZVxuICB9KTtcbn1cbnZhciBwcm9wVHlwZXMkMSA9IHtcbiAgaXRlbXM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBpdGVtVG9TdHJpbmc6IFByb3BUeXBlcy5mdW5jLFxuICBnZXRBMTF5U3RhdHVzTWVzc2FnZTogUHJvcFR5cGVzLmZ1bmMsXG4gIGdldEExMXlTZWxlY3Rpb25NZXNzYWdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgY2lyY3VsYXJOYXZpZ2F0aW9uOiBQcm9wVHlwZXMuYm9vbCxcbiAgaGlnaGxpZ2h0ZWRJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsXG4gIGluaXRpYWxIaWdobGlnaHRlZEluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICBpc09wZW46IFByb3BUeXBlcy5ib29sLFxuICBkZWZhdWx0SXNPcGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgaW5pdGlhbElzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIHNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgaW5pdGlhbFNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgZGVmYXVsdFNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgaW5wdXRWYWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgZGVmYXVsdElucHV0VmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGluaXRpYWxJbnB1dFZhbHVlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBpZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgbGFiZWxJZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgbWVudUlkOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBnZXRJdGVtSWQ6IFByb3BUeXBlcy5mdW5jLFxuICBpbnB1dElkOiBQcm9wVHlwZXMuc3RyaW5nLFxuICB0b2dnbGVCdXR0b25JZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgc3RhdGVSZWR1Y2VyOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25TZWxlY3RlZEl0ZW1DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvbkhpZ2hsaWdodGVkSW5kZXhDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvblN0YXRlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25Jc09wZW5DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvbklucHV0VmFsdWVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBlbnZpcm9ubWVudDogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICBhZGRFdmVudExpc3RlbmVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgICByZW1vdmVFdmVudExpc3RlbmVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBkb2N1bWVudDogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIGdldEVsZW1lbnRCeUlkOiBQcm9wVHlwZXMuZnVuYyxcbiAgICAgIGFjdGl2ZUVsZW1lbnQ6IFByb3BUeXBlcy5hbnksXG4gICAgICBib2R5OiBQcm9wVHlwZXMuYW55XG4gICAgfSlcbiAgfSlcbn07XG4vKipcbiAqIFRoZSB1c2VDb21ib2JveCB2ZXJzaW9uIG9mIHVzZUNvbnRyb2xsZWRSZWR1Y2VyLCB3aGljaCBhbHNvXG4gKiBjaGVja3MgaWYgdGhlIGNvbnRyb2xsZWQgcHJvcCBzZWxlY3RlZEl0ZW0gY2hhbmdlZCBiZXR3ZWVuXG4gKiByZW5kZXJzLiBJZiBzbywgaXQgd2lsbCBhbHNvIHVwZGF0ZSBpbnB1dFZhbHVlIHdpdGggaXRzXG4gKiBzdHJpbmcgZXF1aXZhbGVudC4gSXQgdXNlcyB0aGUgY29tbW9uIHVzZUVuaGFuY2VkUmVkdWNlciB0b1xuICogY29tcHV0ZSB0aGUgcmVzdCBvZiB0aGUgc3RhdGUuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVkdWNlciBSZWR1Y2VyIGZ1bmN0aW9uIGZyb20gZG93bnNoaWZ0LlxuICogQHBhcmFtIHtPYmplY3R9IGluaXRpYWxTdGF0ZSBJbml0aWFsIHN0YXRlIG9mIHRoZSBob29rLlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzIFRoZSBob29rIHByb3BzLlxuICogQHJldHVybnMge0FycmF5fSBBbiBhcnJheSB3aXRoIHRoZSBzdGF0ZSBhbmQgYW4gYWN0aW9uIGRpc3BhdGNoZXIuXG4gKi9cblxuZnVuY3Rpb24gdXNlQ29udHJvbGxlZFJlZHVjZXIkMShyZWR1Y2VyLCBpbml0aWFsU3RhdGUsIHByb3BzKSB7XG4gIHZhciBwcmV2aW91c1NlbGVjdGVkSXRlbVJlZiA9IHVzZVJlZigpO1xuXG4gIHZhciBfdXNlRW5oYW5jZWRSZWR1Y2VyID0gdXNlRW5oYW5jZWRSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxTdGF0ZSwgcHJvcHMpLFxuICAgICAgc3RhdGUgPSBfdXNlRW5oYW5jZWRSZWR1Y2VyWzBdLFxuICAgICAgZGlzcGF0Y2ggPSBfdXNlRW5oYW5jZWRSZWR1Y2VyWzFdOyAvLyBUb0RvOiBpZiBuZWVkZWQsIG1ha2Ugc2FtZSBhcHByb2FjaCBhcyBzZWxlY3RlZEl0ZW1DaGFuZ2VkIGZyb20gRG93bnNoaWZ0LlxuXG5cbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoaXNDb250cm9sbGVkUHJvcChwcm9wcywgJ3NlbGVjdGVkSXRlbScpKSB7XG4gICAgICBpZiAocHJldmlvdXNTZWxlY3RlZEl0ZW1SZWYuY3VycmVudCAhPT0gcHJvcHMuc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBDb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW0sXG4gICAgICAgICAgaW5wdXRWYWx1ZTogcHJvcHMuaXRlbVRvU3RyaW5nKHByb3BzLnNlbGVjdGVkSXRlbSlcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHByZXZpb3VzU2VsZWN0ZWRJdGVtUmVmLmN1cnJlbnQgPSBzdGF0ZS5zZWxlY3RlZEl0ZW0gPT09IHByZXZpb3VzU2VsZWN0ZWRJdGVtUmVmLmN1cnJlbnQgPyBwcm9wcy5zZWxlY3RlZEl0ZW0gOiBzdGF0ZS5zZWxlY3RlZEl0ZW07XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIFtnZXRTdGF0ZShzdGF0ZSwgcHJvcHMpLCBkaXNwYXRjaF07XG59XG52YXIgZGVmYXVsdFByb3BzJDIgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdFByb3BzLCB7XG4gIGdldEExMXlTdGF0dXNNZXNzYWdlOiBnZXRBMTF5U3RhdHVzTWVzc2FnZSxcbiAgY2lyY3VsYXJOYXZpZ2F0aW9uOiB0cnVlXG59KTtcblxuLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqL1xuXG5mdW5jdGlvbiBkb3duc2hpZnRVc2VDb21ib2JveFJlZHVjZXIoc3RhdGUsIGFjdGlvbikge1xuICB2YXIgdHlwZSA9IGFjdGlvbi50eXBlLFxuICAgICAgcHJvcHMgPSBhY3Rpb24ucHJvcHMsXG4gICAgICBzaGlmdEtleSA9IGFjdGlvbi5zaGlmdEtleTtcbiAgdmFyIGNoYW5nZXM7XG5cbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBJdGVtTW91c2VNb3ZlJDE6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBhY3Rpb24uaW5kZXhcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgSXRlbUNsaWNrJDE6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBpc09wZW46IGdldERlZmF1bHRWYWx1ZShwcm9wcywgJ2lzT3BlbicpLFxuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdoaWdobGlnaHRlZEluZGV4JyksXG4gICAgICAgIHNlbGVjdGVkSXRlbTogcHJvcHMuaXRlbXNbYWN0aW9uLmluZGV4XSxcbiAgICAgICAgaW5wdXRWYWx1ZTogcHJvcHMuaXRlbVRvU3RyaW5nKHByb3BzLml0ZW1zW2FjdGlvbi5pbmRleF0pXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIElucHV0S2V5RG93bkFycm93RG93bjpcbiAgICAgIGlmIChzdGF0ZS5pc09wZW4pIHtcbiAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXROZXh0V3JhcHBpbmdJbmRleChzaGlmdEtleSA/IDUgOiAxLCBzdGF0ZS5oaWdobGlnaHRlZEluZGV4LCBwcm9wcy5pdGVtcy5sZW5ndGgsIGFjdGlvbi5nZXRJdGVtTm9kZUZyb21JbmRleCwgcHJvcHMuY2lyY3VsYXJOYXZpZ2F0aW9uKVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgMSwgYWN0aW9uLmdldEl0ZW1Ob2RlRnJvbUluZGV4KSxcbiAgICAgICAgICBpc09wZW46IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIElucHV0S2V5RG93bkFycm93VXA6XG4gICAgICBpZiAoc3RhdGUuaXNPcGVuKSB7XG4gICAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0TmV4dFdyYXBwaW5nSW5kZXgoc2hpZnRLZXkgPyAtNSA6IC0xLCBzdGF0ZS5oaWdobGlnaHRlZEluZGV4LCBwcm9wcy5pdGVtcy5sZW5ndGgsIGFjdGlvbi5nZXRJdGVtTm9kZUZyb21JbmRleCwgcHJvcHMuY2lyY3VsYXJOYXZpZ2F0aW9uKVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgLTEsIGFjdGlvbi5nZXRJdGVtTm9kZUZyb21JbmRleCksXG4gICAgICAgICAgaXNPcGVuOiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBJbnB1dEtleURvd25FbnRlcjpcbiAgICAgIGNoYW5nZXMgPSBfZXh0ZW5kcyh7fSwgc3RhdGUuaXNPcGVuICYmIHN0YXRlLmhpZ2hsaWdodGVkSW5kZXggPj0gMCAmJiB7XG4gICAgICAgIHNlbGVjdGVkSXRlbTogcHJvcHMuaXRlbXNbc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleF0sXG4gICAgICAgIGlzT3BlbjogZ2V0RGVmYXVsdFZhbHVlKHByb3BzLCAnaXNPcGVuJyksXG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldERlZmF1bHRWYWx1ZShwcm9wcywgJ2hpZ2hsaWdodGVkSW5kZXgnKSxcbiAgICAgICAgaW5wdXRWYWx1ZTogcHJvcHMuaXRlbVRvU3RyaW5nKHByb3BzLml0ZW1zW3N0YXRlLmhpZ2hsaWdodGVkSW5kZXhdKVxuICAgICAgfSk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgSW5wdXRLZXlEb3duRXNjYXBlOlxuICAgICAgY2hhbmdlcyA9IF9leHRlbmRzKHtcbiAgICAgICAgaXNPcGVuOiBmYWxzZSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogLTFcbiAgICAgIH0sICFzdGF0ZS5pc09wZW4gJiYge1xuICAgICAgICBzZWxlY3RlZEl0ZW06IG51bGwsXG4gICAgICAgIGlucHV0VmFsdWU6ICcnXG4gICAgICB9KTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBJbnB1dEtleURvd25Ib21lOlxuICAgICAgY2hhbmdlcyA9IF9leHRlbmRzKHt9LCBzdGF0ZS5pc09wZW4gJiYge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXROZXh0Tm9uRGlzYWJsZWRJbmRleCgxLCAwLCBwcm9wcy5pdGVtcy5sZW5ndGgsIGFjdGlvbi5nZXRJdGVtTm9kZUZyb21JbmRleCwgZmFsc2UpXG4gICAgICB9KTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBJbnB1dEtleURvd25FbmQ6XG4gICAgICBjaGFuZ2VzID0gX2V4dGVuZHMoe30sIHN0YXRlLmlzT3BlbiAmJiB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldE5leHROb25EaXNhYmxlZEluZGV4KC0xLCBwcm9wcy5pdGVtcy5sZW5ndGggLSAxLCBwcm9wcy5pdGVtcy5sZW5ndGgsIGFjdGlvbi5nZXRJdGVtTm9kZUZyb21JbmRleCwgZmFsc2UpXG4gICAgICB9KTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBJbnB1dEJsdXI6XG4gICAgICBpZiAoc3RhdGUuaXNPcGVuKSB7XG4gICAgICAgIGNoYW5nZXMgPSBfZXh0ZW5kcyh7XG4gICAgICAgICAgaXNPcGVuOiBmYWxzZSxcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiAtMVxuICAgICAgICB9LCBzdGF0ZS5oaWdobGlnaHRlZEluZGV4ID49IDAgJiYgYWN0aW9uLnNlbGVjdEl0ZW0gJiYge1xuICAgICAgICAgIHNlbGVjdGVkSXRlbTogcHJvcHMuaXRlbXNbc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleF0sXG4gICAgICAgICAgaW5wdXRWYWx1ZTogcHJvcHMuaXRlbVRvU3RyaW5nKHByb3BzLml0ZW1zW3N0YXRlLmhpZ2hsaWdodGVkSW5kZXhdKVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIElucHV0Q2hhbmdlOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaXNPcGVuOiB0cnVlLFxuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdoaWdobGlnaHRlZEluZGV4JyksXG4gICAgICAgIGlucHV0VmFsdWU6IGFjdGlvbi5pbnB1dFZhbHVlXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIE1lbnVNb3VzZUxlYXZlJDE6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiAtMVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBUb2dnbGVCdXR0b25DbGljayQxOlxuICAgIGNhc2UgRnVuY3Rpb25Ub2dnbGVNZW51JDE6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBpc09wZW46ICFzdGF0ZS5pc09wZW4sXG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IHN0YXRlLmlzT3BlbiA/IC0xIDogZ2V0SGlnaGxpZ2h0ZWRJbmRleE9uT3Blbihwcm9wcywgc3RhdGUsIDApXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIEZ1bmN0aW9uT3Blbk1lbnUkMTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0SGlnaGxpZ2h0ZWRJbmRleE9uT3Blbihwcm9wcywgc3RhdGUsIDApXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIEZ1bmN0aW9uQ2xvc2VNZW51JDE6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBpc09wZW46IGZhbHNlXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIEZ1bmN0aW9uU2V0SGlnaGxpZ2h0ZWRJbmRleCQxOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogYWN0aW9uLmhpZ2hsaWdodGVkSW5kZXhcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgRnVuY3Rpb25TZWxlY3RJdGVtJDE6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBzZWxlY3RlZEl0ZW06IGFjdGlvbi5zZWxlY3RlZEl0ZW0sXG4gICAgICAgIGlucHV0VmFsdWU6IHByb3BzLml0ZW1Ub1N0cmluZyhhY3Rpb24uc2VsZWN0ZWRJdGVtKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBDb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW06XG4gICAgY2FzZSBGdW5jdGlvblNldElucHV0VmFsdWUkMTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlucHV0VmFsdWU6IGFjdGlvbi5pbnB1dFZhbHVlXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIEZ1bmN0aW9uUmVzZXQkMTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldERlZmF1bHRWYWx1ZShwcm9wcywgJ2hpZ2hsaWdodGVkSW5kZXgnKSxcbiAgICAgICAgaXNPcGVuOiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdpc09wZW4nKSxcbiAgICAgICAgc2VsZWN0ZWRJdGVtOiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdzZWxlY3RlZEl0ZW0nKSxcbiAgICAgICAgaW5wdXRWYWx1ZTogZ2V0RGVmYXVsdFZhbHVlKHByb3BzLCAnaW5wdXRWYWx1ZScpXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWR1Y2VyIGNhbGxlZCB3aXRob3V0IHByb3BlciBhY3Rpb24gdHlwZS4nKTtcbiAgfVxuXG4gIHJldHVybiBfZXh0ZW5kcyh7fSwgc3RhdGUsIGNoYW5nZXMpO1xufVxuLyogZXNsaW50LWVuYWJsZSBjb21wbGV4aXR5ICovXG5cbnZhciB2YWxpZGF0ZVByb3BUeXBlcyQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xubnVsbCA6IGdldFByb3BUeXBlc1ZhbGlkYXRvcih1c2VDb21ib2JveCwgcHJvcFR5cGVzJDEpO1xudXNlQ29tYm9ib3guc3RhdGVDaGFuZ2VUeXBlcyA9IHN0YXRlQ2hhbmdlVHlwZXMkMjtcblxuZnVuY3Rpb24gdXNlQ29tYm9ib3godXNlclByb3BzKSB7XG4gIGlmICh1c2VyUHJvcHMgPT09IHZvaWQgMCkge1xuICAgIHVzZXJQcm9wcyA9IHt9O1xuICB9XG5cbiAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICB2YWxpZGF0ZVByb3BUeXBlcyQxKHVzZXJQcm9wcyk7XG4gIH0gLy8gUHJvcHMgZGVmYXVsdHMgYW5kIGRlc3RydWN0dXJpbmcuXG5cblxuICB2YXIgcHJvcHMgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdFByb3BzJDIsIHVzZXJQcm9wcyk7XG5cbiAgdmFyIGluaXRpYWxJc09wZW4gPSBwcm9wcy5pbml0aWFsSXNPcGVuLFxuICAgICAgZGVmYXVsdElzT3BlbiA9IHByb3BzLmRlZmF1bHRJc09wZW4sXG4gICAgICBpdGVtcyA9IHByb3BzLml0ZW1zLFxuICAgICAgc2Nyb2xsSW50b1ZpZXcgPSBwcm9wcy5zY3JvbGxJbnRvVmlldyxcbiAgICAgIGVudmlyb25tZW50ID0gcHJvcHMuZW52aXJvbm1lbnQsXG4gICAgICBnZXRBMTF5U3RhdHVzTWVzc2FnZSA9IHByb3BzLmdldEExMXlTdGF0dXNNZXNzYWdlLFxuICAgICAgZ2V0QTExeVNlbGVjdGlvbk1lc3NhZ2UgPSBwcm9wcy5nZXRBMTF5U2VsZWN0aW9uTWVzc2FnZSxcbiAgICAgIGl0ZW1Ub1N0cmluZyA9IHByb3BzLml0ZW1Ub1N0cmluZzsgLy8gSW5pdGlhbCBzdGF0ZSBkZXBlbmRpbmcgb24gY29udHJvbGxlZCBwcm9wcy5cblxuICB2YXIgaW5pdGlhbFN0YXRlID0gZ2V0SW5pdGlhbFN0YXRlJDEocHJvcHMpO1xuXG4gIHZhciBfdXNlQ29udHJvbGxlZFJlZHVjZXIgPSB1c2VDb250cm9sbGVkUmVkdWNlciQxKGRvd25zaGlmdFVzZUNvbWJvYm94UmVkdWNlciwgaW5pdGlhbFN0YXRlLCBwcm9wcyksXG4gICAgICBzdGF0ZSA9IF91c2VDb250cm9sbGVkUmVkdWNlclswXSxcbiAgICAgIGRpc3BhdGNoID0gX3VzZUNvbnRyb2xsZWRSZWR1Y2VyWzFdO1xuXG4gIHZhciBpc09wZW4gPSBzdGF0ZS5pc09wZW4sXG4gICAgICBoaWdobGlnaHRlZEluZGV4ID0gc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgIHNlbGVjdGVkSXRlbSA9IHN0YXRlLnNlbGVjdGVkSXRlbSxcbiAgICAgIGlucHV0VmFsdWUgPSBzdGF0ZS5pbnB1dFZhbHVlOyAvLyBFbGVtZW50IHJlZnMuXG5cbiAgdmFyIG1lbnVSZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciBpdGVtUmVmcyA9IHVzZVJlZigpO1xuICB2YXIgaW5wdXRSZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciB0b2dnbGVCdXR0b25SZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciBjb21ib2JveFJlZiA9IHVzZVJlZihudWxsKTtcbiAgaXRlbVJlZnMuY3VycmVudCA9IHt9O1xuICB2YXIgaXNJbml0aWFsTW91bnRSZWYgPSB1c2VSZWYodHJ1ZSk7IC8vIHByZXZlbnQgaWQgcmUtZ2VuZXJhdGlvbiBiZXR3ZWVuIHJlbmRlcnMuXG5cbiAgdmFyIGVsZW1lbnRJZHNSZWYgPSB1c2VSZWYoZ2V0RWxlbWVudElkcyQxKHByb3BzKSk7IC8vIHVzZWQgdG8ga2VlcCB0cmFjayBvZiBob3cgbWFueSBpdGVtcyB3ZSBoYWQgb24gcHJldmlvdXMgY3ljbGUuXG5cbiAgdmFyIHByZXZpb3VzUmVzdWx0Q291bnRSZWYgPSB1c2VSZWYoKTsgLy8gdXRpbGl0eSBjYWxsYmFjayB0byBnZXQgaXRlbSBlbGVtZW50LlxuXG4gIHZhciBsYXRlc3QgPSB1c2VMYXRlc3RSZWYoe1xuICAgIHN0YXRlOiBzdGF0ZSxcbiAgICBwcm9wczogcHJvcHNcbiAgfSk7XG5cbiAgdmFyIGdldEl0ZW1Ob2RlRnJvbUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgcmV0dXJuIGl0ZW1SZWZzLmN1cnJlbnRbZWxlbWVudElkc1JlZi5jdXJyZW50LmdldEl0ZW1JZChpbmRleCldO1xuICB9OyAvLyBFZmZlY3RzLlxuICAvLyBTZXRzIGExMXkgc3RhdHVzIG1lc3NhZ2Ugb24gY2hhbmdlcyBpbiBzdGF0ZS5cblxuXG4gIHVzZUExMXlNZXNzYWdlU2V0dGVyKGdldEExMXlTdGF0dXNNZXNzYWdlLCBbaXNPcGVuLCBoaWdobGlnaHRlZEluZGV4LCBpbnB1dFZhbHVlLCBpdGVtc10sIF9leHRlbmRzKHtcbiAgICBpc0luaXRpYWxNb3VudDogaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCxcbiAgICBwcmV2aW91c1Jlc3VsdENvdW50OiBwcmV2aW91c1Jlc3VsdENvdW50UmVmLmN1cnJlbnQsXG4gICAgaXRlbXM6IGl0ZW1zLFxuICAgIGVudmlyb25tZW50OiBlbnZpcm9ubWVudCxcbiAgICBpdGVtVG9TdHJpbmc6IGl0ZW1Ub1N0cmluZ1xuICB9LCBzdGF0ZSkpOyAvLyBTZXRzIGExMXkgc3RhdHVzIG1lc3NhZ2Ugb24gY2hhbmdlcyBpbiBzZWxlY3RlZEl0ZW0uXG5cbiAgdXNlQTExeU1lc3NhZ2VTZXR0ZXIoZ2V0QTExeVNlbGVjdGlvbk1lc3NhZ2UsIFtzZWxlY3RlZEl0ZW1dLCBfZXh0ZW5kcyh7XG4gICAgaXNJbml0aWFsTW91bnQ6IGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQsXG4gICAgcHJldmlvdXNSZXN1bHRDb3VudDogcHJldmlvdXNSZXN1bHRDb3VudFJlZi5jdXJyZW50LFxuICAgIGl0ZW1zOiBpdGVtcyxcbiAgICBlbnZpcm9ubWVudDogZW52aXJvbm1lbnQsXG4gICAgaXRlbVRvU3RyaW5nOiBpdGVtVG9TdHJpbmdcbiAgfSwgc3RhdGUpKTsgLy8gU2Nyb2xsIG9uIGhpZ2hsaWdodGVkIGl0ZW0gaWYgY2hhbmdlIGNvbWVzIGZyb20ga2V5Ym9hcmQuXG5cbiAgdmFyIHNob3VsZFNjcm9sbFJlZiA9IHVzZVNjcm9sbEludG9WaWV3KHtcbiAgICBtZW51RWxlbWVudDogbWVudVJlZi5jdXJyZW50LFxuICAgIGhpZ2hsaWdodGVkSW5kZXg6IGhpZ2hsaWdodGVkSW5kZXgsXG4gICAgaXNPcGVuOiBpc09wZW4sXG4gICAgaXRlbVJlZnM6IGl0ZW1SZWZzLFxuICAgIHNjcm9sbEludG9WaWV3OiBzY3JvbGxJbnRvVmlldyxcbiAgICBnZXRJdGVtTm9kZUZyb21JbmRleDogZ2V0SXRlbU5vZGVGcm9tSW5kZXhcbiAgfSk7XG4gIHVzZUNvbnRyb2xQcm9wc1ZhbGlkYXRvcih7XG4gICAgaXNJbml0aWFsTW91bnQ6IGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQsXG4gICAgcHJvcHM6IHByb3BzLFxuICAgIHN0YXRlOiBzdGF0ZVxuICB9KTsgLy8gQ29udHJvbHMgdGhlIGZvY3VzIG9uIHRoZSBpbnB1dCBvbiBvcGVuLlxuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgLy8gRG9uJ3QgZm9jdXMgbWVudSBvbiBmaXJzdCByZW5kZXIuXG4gICAgaWYgKGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQpIHtcbiAgICAgIC8vIFVubGVzcyBpdCB3YXMgaW5pdGlhbGlzZWQgYXMgb3Blbi5cbiAgICAgIGlmIChpbml0aWFsSXNPcGVuIHx8IGRlZmF1bHRJc09wZW4gfHwgaXNPcGVuKSB7XG4gICAgICAgIGlmIChpbnB1dFJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgaW5wdXRSZWYuY3VycmVudC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG5cbiAgfSwgW2lzT3Blbl0pO1xuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmIChpc0luaXRpYWxNb3VudFJlZi5jdXJyZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcHJldmlvdXNSZXN1bHRDb3VudFJlZi5jdXJyZW50ID0gaXRlbXMubGVuZ3RoO1xuICB9KTsgLy8gQWRkIG1vdXNlL3RvdWNoIGV2ZW50cyB0byBkb2N1bWVudC5cblxuICB2YXIgbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmID0gdXNlTW91c2VBbmRUb3VjaFRyYWNrZXIoaXNPcGVuLCBbY29tYm9ib3hSZWYsIG1lbnVSZWYsIHRvZ2dsZUJ1dHRvblJlZl0sIGVudmlyb25tZW50LCBmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogSW5wdXRCbHVyLFxuICAgICAgc2VsZWN0SXRlbTogZmFsc2VcbiAgICB9KTtcbiAgfSk7XG4gIHZhciBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8gPSB1c2VHZXR0ZXJQcm9wc0NhbGxlZENoZWNrZXIoJ2dldElucHV0UHJvcHMnLCAnZ2V0Q29tYm9ib3hQcm9wcycsICdnZXRNZW51UHJvcHMnKTsgLy8gTWFrZSBpbml0aWFsIHJlZiBmYWxzZS5cblxuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgfSwgW10pO1xuICAvKiBFdmVudCBoYW5kbGVyIGZ1bmN0aW9ucyAqL1xuXG4gIHZhciBpbnB1dEtleURvd25IYW5kbGVycyA9IHVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICBBcnJvd0Rvd246IGZ1bmN0aW9uIEFycm93RG93bihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogSW5wdXRLZXlEb3duQXJyb3dEb3duLFxuICAgICAgICAgIHNoaWZ0S2V5OiBldmVudC5zaGlmdEtleSxcbiAgICAgICAgICBnZXRJdGVtTm9kZUZyb21JbmRleDogZ2V0SXRlbU5vZGVGcm9tSW5kZXhcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgQXJyb3dVcDogZnVuY3Rpb24gQXJyb3dVcChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogSW5wdXRLZXlEb3duQXJyb3dVcCxcbiAgICAgICAgICBzaGlmdEtleTogZXZlbnQuc2hpZnRLZXksXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIEhvbWU6IGZ1bmN0aW9uIEhvbWUoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IElucHV0S2V5RG93bkhvbWUsXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIEVuZDogZnVuY3Rpb24gRW5kKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25FbmQsXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIEVzY2FwZTogZnVuY3Rpb24gRXNjYXBlKCkge1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogSW5wdXRLZXlEb3duRXNjYXBlXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIEVudGVyOiBmdW5jdGlvbiBFbnRlcihldmVudCkge1xuICAgICAgICAvLyBpZiBJTUUgY29tcG9zaW5nLCB3YWl0IGZvciBuZXh0IEVudGVyIGtleWRvd24gZXZlbnQuXG4gICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMjI5KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGxhdGVzdFN0YXRlID0gbGF0ZXN0LmN1cnJlbnQuc3RhdGU7XG5cbiAgICAgICAgaWYgKGxhdGVzdFN0YXRlLmlzT3Blbikge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogSW5wdXRLZXlEb3duRW50ZXIsXG4gICAgICAgICAgZ2V0SXRlbU5vZGVGcm9tSW5kZXg6IGdldEl0ZW1Ob2RlRnJvbUluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtkaXNwYXRjaCwgbGF0ZXN0XSk7IC8vIEdldHRlciBwcm9wcy5cblxuICB2YXIgZ2V0TGFiZWxQcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChsYWJlbFByb3BzKSB7XG4gICAgcmV0dXJuIF9leHRlbmRzKHtcbiAgICAgIGlkOiBlbGVtZW50SWRzUmVmLmN1cnJlbnQubGFiZWxJZCxcbiAgICAgIGh0bWxGb3I6IGVsZW1lbnRJZHNSZWYuY3VycmVudC5pbnB1dElkXG4gICAgfSwgbGFiZWxQcm9wcyk7XG4gIH0sIFtdKTtcbiAgdmFyIGdldE1lbnVQcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcCwgX3RlbXAyKSB7XG4gICAgdmFyIF9leHRlbmRzMjtcblxuICAgIHZhciBfcmVmID0gX3RlbXAgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAsXG4gICAgICAgIG9uTW91c2VMZWF2ZSA9IF9yZWYub25Nb3VzZUxlYXZlLFxuICAgICAgICBfcmVmJHJlZktleSA9IF9yZWYucmVmS2V5LFxuICAgICAgICByZWZLZXkgPSBfcmVmJHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmJHJlZktleSxcbiAgICAgICAgcmVmID0gX3JlZi5yZWYsXG4gICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmLCBbXCJvbk1vdXNlTGVhdmVcIiwgXCJyZWZLZXlcIiwgXCJyZWZcIl0pO1xuXG4gICAgdmFyIF9yZWYyID0gX3RlbXAyID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wMixcbiAgICAgICAgX3JlZjIkc3VwcHJlc3NSZWZFcnJvID0gX3JlZjIuc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgICAgc3VwcHJlc3NSZWZFcnJvciA9IF9yZWYyJHN1cHByZXNzUmVmRXJybyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMiRzdXBwcmVzc1JlZkVycm87XG5cbiAgICBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8oJ2dldE1lbnVQcm9wcycsIHN1cHByZXNzUmVmRXJyb3IsIHJlZktleSwgbWVudVJlZik7XG4gICAgcmV0dXJuIF9leHRlbmRzKChfZXh0ZW5kczIgPSB7fSwgX2V4dGVuZHMyW3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgZnVuY3Rpb24gKG1lbnVOb2RlKSB7XG4gICAgICBtZW51UmVmLmN1cnJlbnQgPSBtZW51Tm9kZTtcbiAgICB9KSwgX2V4dGVuZHMyLmlkID0gZWxlbWVudElkc1JlZi5jdXJyZW50Lm1lbnVJZCwgX2V4dGVuZHMyLnJvbGUgPSAnbGlzdGJveCcsIF9leHRlbmRzMlsnYXJpYS1sYWJlbGxlZGJ5J10gPSBlbGVtZW50SWRzUmVmLmN1cnJlbnQubGFiZWxJZCwgX2V4dGVuZHMyLm9uTW91c2VMZWF2ZSA9IGNhbGxBbGxFdmVudEhhbmRsZXJzKG9uTW91c2VMZWF2ZSwgZnVuY3Rpb24gKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBNZW51TW91c2VMZWF2ZSQxXG4gICAgICB9KTtcbiAgICB9KSwgX2V4dGVuZHMyKSwgcmVzdCk7XG4gIH0sIFtkaXNwYXRjaCwgc2V0R2V0dGVyUHJvcENhbGxJbmZvXSk7XG4gIHZhciBnZXRJdGVtUHJvcHMgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoX3RlbXAzKSB7XG4gICAgdmFyIF9leHRlbmRzMywgX3JlZjQ7XG5cbiAgICB2YXIgX3JlZjMgPSBfdGVtcDMgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAzLFxuICAgICAgICBpdGVtID0gX3JlZjMuaXRlbSxcbiAgICAgICAgaW5kZXggPSBfcmVmMy5pbmRleCxcbiAgICAgICAgX3JlZjMkcmVmS2V5ID0gX3JlZjMucmVmS2V5LFxuICAgICAgICByZWZLZXkgPSBfcmVmMyRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjMkcmVmS2V5LFxuICAgICAgICByZWYgPSBfcmVmMy5yZWYsXG4gICAgICAgIG9uTW91c2VNb3ZlID0gX3JlZjMub25Nb3VzZU1vdmUsXG4gICAgICAgIG9uQ2xpY2sgPSBfcmVmMy5vbkNsaWNrLFxuICAgICAgICBvblByZXNzID0gX3JlZjMub25QcmVzcyxcbiAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYzLCBbXCJpdGVtXCIsIFwiaW5kZXhcIiwgXCJyZWZLZXlcIiwgXCJyZWZcIiwgXCJvbk1vdXNlTW92ZVwiLCBcIm9uQ2xpY2tcIiwgXCJvblByZXNzXCJdKTtcblxuICAgIHZhciBfbGF0ZXN0JGN1cnJlbnQgPSBsYXRlc3QuY3VycmVudCxcbiAgICAgICAgbGF0ZXN0UHJvcHMgPSBfbGF0ZXN0JGN1cnJlbnQucHJvcHMsXG4gICAgICAgIGxhdGVzdFN0YXRlID0gX2xhdGVzdCRjdXJyZW50LnN0YXRlO1xuICAgIHZhciBpdGVtSW5kZXggPSBnZXRJdGVtSW5kZXgoaW5kZXgsIGl0ZW0sIGxhdGVzdFByb3BzLml0ZW1zKTtcblxuICAgIGlmIChpdGVtSW5kZXggPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bhc3MgZWl0aGVyIGl0ZW0gb3IgaXRlbSBpbmRleCBpbiBnZXRJdGVtUHJvcHMhJyk7XG4gICAgfVxuXG4gICAgdmFyIG9uU2VsZWN0S2V5ID0gJ29uQ2xpY2snO1xuICAgIHZhciBjdXN0b21DbGlja0hhbmRsZXIgPSBvbkNsaWNrO1xuICAgIHJldHVybiBfZXh0ZW5kcygoX2V4dGVuZHMzID0ge30sIF9leHRlbmRzM1tyZWZLZXldID0gaGFuZGxlUmVmcyhyZWYsIGZ1bmN0aW9uIChpdGVtTm9kZSkge1xuICAgICAgaWYgKGl0ZW1Ob2RlKSB7XG4gICAgICAgIGl0ZW1SZWZzLmN1cnJlbnRbZWxlbWVudElkc1JlZi5jdXJyZW50LmdldEl0ZW1JZChpdGVtSW5kZXgpXSA9IGl0ZW1Ob2RlO1xuICAgICAgfVxuICAgIH0pLCBfZXh0ZW5kczMucm9sZSA9ICdvcHRpb24nLCBfZXh0ZW5kczNbJ2FyaWEtc2VsZWN0ZWQnXSA9IFwiXCIgKyAoaXRlbUluZGV4ID09PSBsYXRlc3RTdGF0ZS5oaWdobGlnaHRlZEluZGV4KSwgX2V4dGVuZHMzLmlkID0gZWxlbWVudElkc1JlZi5jdXJyZW50LmdldEl0ZW1JZChpdGVtSW5kZXgpLCBfZXh0ZW5kczMpLCAhcmVzdC5kaXNhYmxlZCAmJiAoX3JlZjQgPSB7XG4gICAgICBvbk1vdXNlTW92ZTogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25Nb3VzZU1vdmUsIGZ1bmN0aW9uIGl0ZW1IYW5kbGVNb3VzZU1vdmUoKSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gbGF0ZXN0U3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHNob3VsZFNjcm9sbFJlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBJdGVtTW91c2VNb3ZlJDEsXG4gICAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICB9LCBfcmVmNFtvblNlbGVjdEtleV0gPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhjdXN0b21DbGlja0hhbmRsZXIsIGZ1bmN0aW9uIGl0ZW1IYW5kbGVDbGljaygpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogSXRlbUNsaWNrJDEsXG4gICAgICAgIGluZGV4OiBpbmRleFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChpbnB1dFJlZi5jdXJyZW50KSB7XG4gICAgICAgIGlucHV0UmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICAgIH1cbiAgICB9KSwgX3JlZjQpLCByZXN0KTtcbiAgfSwgW2Rpc3BhdGNoLCBsYXRlc3QsIHNob3VsZFNjcm9sbFJlZl0pO1xuICB2YXIgZ2V0VG9nZ2xlQnV0dG9uUHJvcHMgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoX3RlbXA0KSB7XG4gICAgdmFyIF9leHRlbmRzNDtcblxuICAgIHZhciBfcmVmNSA9IF90ZW1wNCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDQsXG4gICAgICAgIG9uQ2xpY2sgPSBfcmVmNS5vbkNsaWNrLFxuICAgICAgICBvblByZXNzID0gX3JlZjUub25QcmVzcyxcbiAgICAgICAgX3JlZjUkcmVmS2V5ID0gX3JlZjUucmVmS2V5LFxuICAgICAgICByZWZLZXkgPSBfcmVmNSRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjUkcmVmS2V5LFxuICAgICAgICByZWYgPSBfcmVmNS5yZWYsXG4gICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNSwgW1wib25DbGlja1wiLCBcIm9uUHJlc3NcIiwgXCJyZWZLZXlcIiwgXCJyZWZcIl0pO1xuXG4gICAgdmFyIHRvZ2dsZUJ1dHRvbkhhbmRsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25DbGljayQxXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFsYXRlc3QuY3VycmVudC5zdGF0ZS5pc09wZW4gJiYgaW5wdXRSZWYuY3VycmVudCkge1xuICAgICAgICBpbnB1dFJlZi5jdXJyZW50LmZvY3VzKCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBfZXh0ZW5kcygoX2V4dGVuZHM0ID0ge30sIF9leHRlbmRzNFtyZWZLZXldID0gaGFuZGxlUmVmcyhyZWYsIGZ1bmN0aW9uICh0b2dnbGVCdXR0b25Ob2RlKSB7XG4gICAgICB0b2dnbGVCdXR0b25SZWYuY3VycmVudCA9IHRvZ2dsZUJ1dHRvbk5vZGU7XG4gICAgfSksIF9leHRlbmRzNC5pZCA9IGVsZW1lbnRJZHNSZWYuY3VycmVudC50b2dnbGVCdXR0b25JZCwgX2V4dGVuZHM0LnRhYkluZGV4ID0gLTEsIF9leHRlbmRzNCksICFyZXN0LmRpc2FibGVkICYmIF9leHRlbmRzKHt9LCB7XG4gICAgICBvbkNsaWNrOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkNsaWNrLCB0b2dnbGVCdXR0b25IYW5kbGVDbGljaylcbiAgICB9KSwgcmVzdCk7XG4gIH0sIFtkaXNwYXRjaCwgbGF0ZXN0XSk7XG4gIHZhciBnZXRJbnB1dFByb3BzID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKF90ZW1wNSwgX3RlbXA2KSB7XG4gICAgdmFyIF9leHRlbmRzNTtcblxuICAgIHZhciBfcmVmNiA9IF90ZW1wNSA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDUsXG4gICAgICAgIG9uS2V5RG93biA9IF9yZWY2Lm9uS2V5RG93bixcbiAgICAgICAgb25DaGFuZ2UgPSBfcmVmNi5vbkNoYW5nZSxcbiAgICAgICAgb25JbnB1dCA9IF9yZWY2Lm9uSW5wdXQsXG4gICAgICAgIG9uQmx1ciA9IF9yZWY2Lm9uQmx1cixcbiAgICAgICAgb25DaGFuZ2VUZXh0ID0gX3JlZjYub25DaGFuZ2VUZXh0LFxuICAgICAgICBfcmVmNiRyZWZLZXkgPSBfcmVmNi5yZWZLZXksXG4gICAgICAgIHJlZktleSA9IF9yZWY2JHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmNiRyZWZLZXksXG4gICAgICAgIHJlZiA9IF9yZWY2LnJlZixcbiAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY2LCBbXCJvbktleURvd25cIiwgXCJvbkNoYW5nZVwiLCBcIm9uSW5wdXRcIiwgXCJvbkJsdXJcIiwgXCJvbkNoYW5nZVRleHRcIiwgXCJyZWZLZXlcIiwgXCJyZWZcIl0pO1xuXG4gICAgdmFyIF9yZWY3ID0gX3RlbXA2ID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wNixcbiAgICAgICAgX3JlZjckc3VwcHJlc3NSZWZFcnJvID0gX3JlZjcuc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgICAgc3VwcHJlc3NSZWZFcnJvciA9IF9yZWY3JHN1cHByZXNzUmVmRXJybyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmNyRzdXBwcmVzc1JlZkVycm87XG5cbiAgICBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8oJ2dldElucHV0UHJvcHMnLCBzdXBwcmVzc1JlZkVycm9yLCByZWZLZXksIGlucHV0UmVmKTtcbiAgICB2YXIgbGF0ZXN0U3RhdGUgPSBsYXRlc3QuY3VycmVudC5zdGF0ZTtcblxuICAgIHZhciBpbnB1dEhhbmRsZUtleURvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIHZhciBrZXkgPSBub3JtYWxpemVBcnJvd0tleShldmVudCk7XG5cbiAgICAgIGlmIChrZXkgJiYgaW5wdXRLZXlEb3duSGFuZGxlcnNba2V5XSkge1xuICAgICAgICBpbnB1dEtleURvd25IYW5kbGVyc1trZXldKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGlucHV0SGFuZGxlQ2hhbmdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IElucHV0Q2hhbmdlLFxuICAgICAgICBpbnB1dFZhbHVlOiBldmVudC50YXJnZXQudmFsdWVcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgaW5wdXRIYW5kbGVCbHVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgICAgIGlmICghbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQuaXNNb3VzZURvd24pIHtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IElucHV0Qmx1cixcbiAgICAgICAgICBzZWxlY3RJdGVtOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKHByZWFjdCkgKi9cblxuXG4gICAgdmFyIG9uQ2hhbmdlS2V5ID0gJ29uQ2hhbmdlJztcbiAgICB2YXIgZXZlbnRIYW5kbGVycyA9IHt9O1xuXG4gICAgaWYgKCFyZXN0LmRpc2FibGVkKSB7XG4gICAgICB2YXIgX2V2ZW50SGFuZGxlcnM7XG5cbiAgICAgIGV2ZW50SGFuZGxlcnMgPSAoX2V2ZW50SGFuZGxlcnMgPSB7fSwgX2V2ZW50SGFuZGxlcnNbb25DaGFuZ2VLZXldID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DaGFuZ2UsIG9uSW5wdXQsIGlucHV0SGFuZGxlQ2hhbmdlKSwgX2V2ZW50SGFuZGxlcnMub25LZXlEb3duID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCBpbnB1dEhhbmRsZUtleURvd24pLCBfZXZlbnRIYW5kbGVycy5vbkJsdXIgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkJsdXIsIGlucHV0SGFuZGxlQmx1ciksIF9ldmVudEhhbmRsZXJzKTtcbiAgICB9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIGlmIChyZWFjdC1uYXRpdmUpICovXG5cblxuICAgIHJldHVybiBfZXh0ZW5kcygoX2V4dGVuZHM1ID0ge30sIF9leHRlbmRzNVtyZWZLZXldID0gaGFuZGxlUmVmcyhyZWYsIGZ1bmN0aW9uIChpbnB1dE5vZGUpIHtcbiAgICAgIGlucHV0UmVmLmN1cnJlbnQgPSBpbnB1dE5vZGU7XG4gICAgfSksIF9leHRlbmRzNS5pZCA9IGVsZW1lbnRJZHNSZWYuY3VycmVudC5pbnB1dElkLCBfZXh0ZW5kczVbJ2FyaWEtYXV0b2NvbXBsZXRlJ10gPSAnbGlzdCcsIF9leHRlbmRzNVsnYXJpYS1jb250cm9scyddID0gZWxlbWVudElkc1JlZi5jdXJyZW50Lm1lbnVJZCwgX2V4dGVuZHM1KSwgbGF0ZXN0U3RhdGUuaXNPcGVuICYmIGxhdGVzdFN0YXRlLmhpZ2hsaWdodGVkSW5kZXggPiAtMSAmJiB7XG4gICAgICAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogZWxlbWVudElkc1JlZi5jdXJyZW50LmdldEl0ZW1JZChsYXRlc3RTdGF0ZS5oaWdobGlnaHRlZEluZGV4KVxuICAgIH0sIHtcbiAgICAgICdhcmlhLWxhYmVsbGVkYnknOiBlbGVtZW50SWRzUmVmLmN1cnJlbnQubGFiZWxJZCxcbiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL1NlY3VyaXR5L1NlY3VyaW5nX3lvdXJfc2l0ZS9UdXJuaW5nX29mZl9mb3JtX2F1dG9jb21wbGV0aW9uXG4gICAgICAvLyByZXZlcnQgYmFjayBzaW5jZSBhdXRvY29tcGxldGU9XCJub3BlXCIgaXMgaWdub3JlZCBvbiBsYXRlc3QgQ2hyb21lIGFuZCBPcGVyYVxuICAgICAgYXV0b0NvbXBsZXRlOiAnb2ZmJyxcbiAgICAgIHZhbHVlOiBsYXRlc3RTdGF0ZS5pbnB1dFZhbHVlXG4gICAgfSwgZXZlbnRIYW5kbGVycywgcmVzdCk7XG4gIH0sIFtkaXNwYXRjaCwgaW5wdXRLZXlEb3duSGFuZGxlcnMsIGxhdGVzdCwgbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLCBzZXRHZXR0ZXJQcm9wQ2FsbEluZm9dKTtcbiAgdmFyIGdldENvbWJvYm94UHJvcHMgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoX3RlbXA3LCBfdGVtcDgpIHtcbiAgICB2YXIgX2V4dGVuZHM2O1xuXG4gICAgdmFyIF9yZWY4ID0gX3RlbXA3ID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wNyxcbiAgICAgICAgX3JlZjgkcmVmS2V5ID0gX3JlZjgucmVmS2V5LFxuICAgICAgICByZWZLZXkgPSBfcmVmOCRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjgkcmVmS2V5LFxuICAgICAgICByZWYgPSBfcmVmOC5yZWYsXG4gICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmOCwgW1wicmVmS2V5XCIsIFwicmVmXCJdKTtcblxuICAgIHZhciBfcmVmOSA9IF90ZW1wOCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDgsXG4gICAgICAgIF9yZWY5JHN1cHByZXNzUmVmRXJybyA9IF9yZWY5LnN1cHByZXNzUmVmRXJyb3IsXG4gICAgICAgIHN1cHByZXNzUmVmRXJyb3IgPSBfcmVmOSRzdXBwcmVzc1JlZkVycm8gPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjkkc3VwcHJlc3NSZWZFcnJvO1xuXG4gICAgc2V0R2V0dGVyUHJvcENhbGxJbmZvKCdnZXRDb21ib2JveFByb3BzJywgc3VwcHJlc3NSZWZFcnJvciwgcmVmS2V5LCBjb21ib2JveFJlZik7XG4gICAgcmV0dXJuIF9leHRlbmRzKChfZXh0ZW5kczYgPSB7fSwgX2V4dGVuZHM2W3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgZnVuY3Rpb24gKGNvbWJvYm94Tm9kZSkge1xuICAgICAgY29tYm9ib3hSZWYuY3VycmVudCA9IGNvbWJvYm94Tm9kZTtcbiAgICB9KSwgX2V4dGVuZHM2LnJvbGUgPSAnY29tYm9ib3gnLCBfZXh0ZW5kczZbJ2FyaWEtaGFzcG9wdXAnXSA9ICdsaXN0Ym94JywgX2V4dGVuZHM2WydhcmlhLW93bnMnXSA9IGVsZW1lbnRJZHNSZWYuY3VycmVudC5tZW51SWQsIF9leHRlbmRzNlsnYXJpYS1leHBhbmRlZCddID0gbGF0ZXN0LmN1cnJlbnQuc3RhdGUuaXNPcGVuLCBfZXh0ZW5kczYpLCByZXN0KTtcbiAgfSwgW2xhdGVzdCwgc2V0R2V0dGVyUHJvcENhbGxJbmZvXSk7IC8vIHJldHVybnNcblxuICB2YXIgdG9nZ2xlTWVudSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblRvZ2dsZU1lbnUkMVxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIGNsb3NlTWVudSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvbkNsb3NlTWVudSQxXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgb3Blbk1lbnUgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25PcGVuTWVudSQxXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2V0SGlnaGxpZ2h0ZWRJbmRleCA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdIaWdobGlnaHRlZEluZGV4KSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZXRIaWdobGlnaHRlZEluZGV4JDEsXG4gICAgICBoaWdobGlnaHRlZEluZGV4OiBuZXdIaWdobGlnaHRlZEluZGV4XG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2VsZWN0SXRlbSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdTZWxlY3RlZEl0ZW0pIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNlbGVjdEl0ZW0kMSxcbiAgICAgIHNlbGVjdGVkSXRlbTogbmV3U2VsZWN0ZWRJdGVtXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2V0SW5wdXRWYWx1ZSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdJbnB1dFZhbHVlKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZXRJbnB1dFZhbHVlJDEsXG4gICAgICBpbnB1dFZhbHVlOiBuZXdJbnB1dFZhbHVlXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgcmVzZXQgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25SZXNldCQxXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICByZXR1cm4ge1xuICAgIC8vIHByb3AgZ2V0dGVycy5cbiAgICBnZXRJdGVtUHJvcHM6IGdldEl0ZW1Qcm9wcyxcbiAgICBnZXRMYWJlbFByb3BzOiBnZXRMYWJlbFByb3BzLFxuICAgIGdldE1lbnVQcm9wczogZ2V0TWVudVByb3BzLFxuICAgIGdldElucHV0UHJvcHM6IGdldElucHV0UHJvcHMsXG4gICAgZ2V0Q29tYm9ib3hQcm9wczogZ2V0Q29tYm9ib3hQcm9wcyxcbiAgICBnZXRUb2dnbGVCdXR0b25Qcm9wczogZ2V0VG9nZ2xlQnV0dG9uUHJvcHMsXG4gICAgLy8gYWN0aW9ucy5cbiAgICB0b2dnbGVNZW51OiB0b2dnbGVNZW51LFxuICAgIG9wZW5NZW51OiBvcGVuTWVudSxcbiAgICBjbG9zZU1lbnU6IGNsb3NlTWVudSxcbiAgICBzZXRIaWdobGlnaHRlZEluZGV4OiBzZXRIaWdobGlnaHRlZEluZGV4LFxuICAgIHNldElucHV0VmFsdWU6IHNldElucHV0VmFsdWUsXG4gICAgc2VsZWN0SXRlbTogc2VsZWN0SXRlbSxcbiAgICByZXNldDogcmVzZXQsXG4gICAgLy8gc3RhdGUuXG4gICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBpc09wZW46IGlzT3BlbixcbiAgICBzZWxlY3RlZEl0ZW06IHNlbGVjdGVkSXRlbSxcbiAgICBpbnB1dFZhbHVlOiBpbnB1dFZhbHVlXG4gIH07XG59XG5cbnZhciBkZWZhdWx0U3RhdGVWYWx1ZXMgPSB7XG4gIGFjdGl2ZUluZGV4OiAtMSxcbiAgc2VsZWN0ZWRJdGVtczogW11cbn07XG4vKipcbiAqIFJldHVybnMgdGhlIGluaXRpYWwgdmFsdWUgZm9yIGEgc3RhdGUga2V5IGluIHRoZSBmb2xsb3dpbmcgb3JkZXI6XG4gKiAxLiBjb250cm9sbGVkIHByb3AsIDIuIGluaXRpYWwgcHJvcCwgMy4gZGVmYXVsdCBwcm9wLCA0LiBkZWZhdWx0XG4gKiB2YWx1ZSBmcm9tIERvd25zaGlmdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgUHJvcHMgcGFzc2VkIHRvIHRoZSBob29rLlxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BLZXkgUHJvcHMga2V5IHRvIGdlbmVyYXRlIHRoZSB2YWx1ZSBmb3IuXG4gKiBAcmV0dXJucyB7YW55fSBUaGUgaW5pdGlhbCB2YWx1ZSBmb3IgdGhhdCBwcm9wLlxuICovXG5cbmZ1bmN0aW9uIGdldEluaXRpYWxWYWx1ZSQxKHByb3BzLCBwcm9wS2V5KSB7XG4gIHJldHVybiBnZXRJbml0aWFsVmFsdWUocHJvcHMsIHByb3BLZXksIGRlZmF1bHRTdGF0ZVZhbHVlcyk7XG59XG4vKipcbiAqIFJldHVybnMgdGhlIGRlZmF1bHQgdmFsdWUgZm9yIGEgc3RhdGUga2V5IGluIHRoZSBmb2xsb3dpbmcgb3JkZXI6XG4gKiAxLiBjb250cm9sbGVkIHByb3AsIDIuIGRlZmF1bHQgcHJvcCwgMy4gZGVmYXVsdCB2YWx1ZSBmcm9tIERvd25zaGlmdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgUHJvcHMgcGFzc2VkIHRvIHRoZSBob29rLlxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BLZXkgUHJvcHMga2V5IHRvIGdlbmVyYXRlIHRoZSB2YWx1ZSBmb3IuXG4gKiBAcmV0dXJucyB7YW55fSBUaGUgaW5pdGlhbCB2YWx1ZSBmb3IgdGhhdCBwcm9wLlxuICovXG5cblxuZnVuY3Rpb24gZ2V0RGVmYXVsdFZhbHVlJDEocHJvcHMsIHByb3BLZXkpIHtcbiAgcmV0dXJuIGdldERlZmF1bHRWYWx1ZShwcm9wcywgcHJvcEtleSwgZGVmYXVsdFN0YXRlVmFsdWVzKTtcbn1cbi8qKlxuICogR2V0cyB0aGUgaW5pdGlhbCBzdGF0ZSBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgcHJvcHMuIEl0IHVzZXMgaW5pdGlhbCwgZGVmYXVsdFxuICogYW5kIGNvbnRyb2xsZWQgcHJvcHMgcmVsYXRlZCB0byBzdGF0ZSBpbiBvcmRlciB0byBjb21wdXRlIHRoZSBpbml0aWFsIHZhbHVlLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyBQcm9wcyBwYXNzZWQgdG8gdGhlIGhvb2suXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgaW5pdGlhbCBzdGF0ZS5cbiAqL1xuXG5mdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUkMihwcm9wcykge1xuICB2YXIgYWN0aXZlSW5kZXggPSBnZXRJbml0aWFsVmFsdWUkMShwcm9wcywgJ2FjdGl2ZUluZGV4Jyk7XG4gIHZhciBzZWxlY3RlZEl0ZW1zID0gZ2V0SW5pdGlhbFZhbHVlJDEocHJvcHMsICdzZWxlY3RlZEl0ZW1zJyk7XG4gIHJldHVybiB7XG4gICAgYWN0aXZlSW5kZXg6IGFjdGl2ZUluZGV4LFxuICAgIHNlbGVjdGVkSXRlbXM6IHNlbGVjdGVkSXRlbXNcbiAgfTtcbn1cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIGRyb3Bkb3duIGtleWRvd24gb3BlcmF0aW9uIGlzIHBlcm1pdHRlZC4gU2hvdWxkIG5vdCBiZVxuICogYWxsb3dlZCBvbiBrZXlkb3duIHdpdGggbW9kaWZpZXIga2V5cyAoY3RybCwgYWx0LCBzaGlmdCwgbWV0YSksIG9uXG4gKiBpbnB1dCBlbGVtZW50IHdpdGggdGV4dCBjb250ZW50IHRoYXQgaXMgZWl0aGVyIGhpZ2hsaWdodGVkIG9yIHNlbGVjdGlvblxuICogY3Vyc29yIGlzIG5vdCBhdCB0aGUgc3RhcnRpbmcgcG9zaXRpb24uXG4gKlxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldmVudCBUaGUgZXZlbnQgZnJvbSBrZXlkb3duLlxuICogQHJldHVybnMge2Jvb2xlYW59IFdoZXRoZXIgdGhlIG9wZXJhdGlvbiBpcyBhbGxvd2VkLlxuICovXG5cbmZ1bmN0aW9uIGlzS2V5RG93bk9wZXJhdGlvblBlcm1pdHRlZChldmVudCkge1xuICBpZiAoZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQubWV0YUtleSB8fCBldmVudC5jdHJsS2V5IHx8IGV2ZW50LmFsdEtleSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHZhciBlbGVtZW50ID0gZXZlbnQudGFyZ2V0O1xuXG4gIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCAmJiAvLyBpZiBlbGVtZW50IGlzIGEgdGV4dCBpbnB1dFxuICBlbGVtZW50LnZhbHVlICE9PSAnJyAmJiAoIC8vIGFuZCB3ZSBoYXZlIHRleHQgaW4gaXRcbiAgLy8gYW5kIGN1cnNvciBpcyBlaXRoZXIgbm90IGF0IHRoZSBzdGFydCBvciBpcyBjdXJyZW50bHkgaGlnaGxpZ2h0aW5nIHRleHQuXG4gIGVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgIT09IDAgfHwgZWxlbWVudC5zZWxlY3Rpb25FbmQgIT09IDApKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG4vKipcbiAqIFJldHVybnMgYSBtZXNzYWdlIHRvIGJlIGFkZGVkIHRvIGFyaWEtbGl2ZSByZWdpb24gd2hlbiBpdGVtIGlzIHJlbW92ZWQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHNlbGVjdGlvblBhcmFtZXRlcnMgUGFyYW1ldGVycyByZXF1aXJlZCB0byBidWlsZCB0aGUgbWVzc2FnZS5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBhMTF5IG1lc3NhZ2UuXG4gKi9cblxuZnVuY3Rpb24gZ2V0QTExeVJlbW92YWxNZXNzYWdlKHNlbGVjdGlvblBhcmFtZXRlcnMpIHtcbiAgdmFyIHJlbW92ZWRTZWxlY3RlZEl0ZW0gPSBzZWxlY3Rpb25QYXJhbWV0ZXJzLnJlbW92ZWRTZWxlY3RlZEl0ZW0sXG4gICAgICBpdGVtVG9TdHJpbmdMb2NhbCA9IHNlbGVjdGlvblBhcmFtZXRlcnMuaXRlbVRvU3RyaW5nO1xuICByZXR1cm4gaXRlbVRvU3RyaW5nTG9jYWwocmVtb3ZlZFNlbGVjdGVkSXRlbSkgKyBcIiBoYXMgYmVlbiByZW1vdmVkLlwiO1xufVxuXG52YXIgcHJvcFR5cGVzJDIgPSB7XG4gIHNlbGVjdGVkSXRlbXM6IFByb3BUeXBlcy5hcnJheSxcbiAgaW5pdGlhbFNlbGVjdGVkSXRlbXM6IFByb3BUeXBlcy5hcnJheSxcbiAgZGVmYXVsdFNlbGVjdGVkSXRlbXM6IFByb3BUeXBlcy5hcnJheSxcbiAgaXRlbVRvU3RyaW5nOiBQcm9wVHlwZXMuZnVuYyxcbiAgZ2V0QTExeVJlbW92YWxNZXNzYWdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgc3RhdGVSZWR1Y2VyOiBQcm9wVHlwZXMuZnVuYyxcbiAgYWN0aXZlSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsXG4gIGluaXRpYWxBY3RpdmVJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgZGVmYXVsdEFjdGl2ZUluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICBvbkFjdGl2ZUluZGV4Q2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25TZWxlY3RlZEl0ZW1zQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAga2V5TmF2aWdhdGlvbk5leHQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGtleU5hdmlnYXRpb25QcmV2aW91czogUHJvcFR5cGVzLnN0cmluZyxcbiAgZW52aXJvbm1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZG9jdW1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBnZXRFbGVtZW50QnlJZDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICBhY3RpdmVFbGVtZW50OiBQcm9wVHlwZXMuYW55LFxuICAgICAgYm9keTogUHJvcFR5cGVzLmFueVxuICAgIH0pXG4gIH0pXG59O1xudmFyIGRlZmF1bHRQcm9wcyQzID0ge1xuICBpdGVtVG9TdHJpbmc6IGRlZmF1bHRQcm9wcy5pdGVtVG9TdHJpbmcsXG4gIHN0YXRlUmVkdWNlcjogZGVmYXVsdFByb3BzLnN0YXRlUmVkdWNlcixcbiAgZW52aXJvbm1lbnQ6IGRlZmF1bHRQcm9wcy5lbnZpcm9ubWVudCxcbiAgZ2V0QTExeVJlbW92YWxNZXNzYWdlOiBnZXRBMTF5UmVtb3ZhbE1lc3NhZ2UsXG4gIGtleU5hdmlnYXRpb25OZXh0OiAnQXJyb3dSaWdodCcsXG4gIGtleU5hdmlnYXRpb25QcmV2aW91czogJ0Fycm93TGVmdCdcbn07XG5cbnZhciBTZWxlY3RlZEl0ZW1DbGljayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3NlbGVjdGVkX2l0ZW1fY2xpY2tfXycgOiAwO1xudmFyIFNlbGVjdGVkSXRlbUtleURvd25EZWxldGUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19zZWxlY3RlZF9pdGVtX2tleWRvd25fZGVsZXRlX18nIDogMTtcbnZhciBTZWxlY3RlZEl0ZW1LZXlEb3duQmFja3NwYWNlID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fc2VsZWN0ZWRfaXRlbV9rZXlkb3duX2JhY2tzcGFjZV9fJyA6IDI7XG52YXIgU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25OZXh0ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fc2VsZWN0ZWRfaXRlbV9rZXlkb3duX25hdmlnYXRpb25fbmV4dF9fJyA6IDM7XG52YXIgU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25QcmV2aW91cyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3NlbGVjdGVkX2l0ZW1fa2V5ZG93bl9uYXZpZ2F0aW9uX3ByZXZpb3VzX18nIDogNDtcbnZhciBEcm9wZG93bktleURvd25OYXZpZ2F0aW9uUHJldmlvdXMgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19kcm9wZG93bl9rZXlkb3duX25hdmlnYXRpb25fcHJldmlvdXNfXycgOiA1O1xudmFyIERyb3Bkb3duS2V5RG93bkJhY2tzcGFjZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Ryb3Bkb3duX2tleWRvd25fYmFja3NwYWNlX18nIDogNjtcbnZhciBEcm9wZG93bkNsaWNrID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZHJvcGRvd25fY2xpY2tfXycgOiA3O1xudmFyIEZ1bmN0aW9uQWRkU2VsZWN0ZWRJdGVtID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fYWRkX3NlbGVjdGVkX2l0ZW1fXycgOiA4O1xudmFyIEZ1bmN0aW9uUmVtb3ZlU2VsZWN0ZWRJdGVtID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fcmVtb3ZlX3NlbGVjdGVkX2l0ZW1fXycgOiA5O1xudmFyIEZ1bmN0aW9uU2V0U2VsZWN0ZWRJdGVtcyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9zZWxlY3RlZF9pdGVtc19fJyA6IDEwO1xudmFyIEZ1bmN0aW9uU2V0QWN0aXZlSW5kZXggPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19mdW5jdGlvbl9zZXRfYWN0aXZlX2luZGV4X18nIDogMTE7XG52YXIgRnVuY3Rpb25SZXNldCQyID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fcmVzZXRfXycgOiAxMjtcblxudmFyIHN0YXRlQ2hhbmdlVHlwZXMkMyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBTZWxlY3RlZEl0ZW1DbGljazogU2VsZWN0ZWRJdGVtQ2xpY2ssXG4gIFNlbGVjdGVkSXRlbUtleURvd25EZWxldGU6IFNlbGVjdGVkSXRlbUtleURvd25EZWxldGUsXG4gIFNlbGVjdGVkSXRlbUtleURvd25CYWNrc3BhY2U6IFNlbGVjdGVkSXRlbUtleURvd25CYWNrc3BhY2UsXG4gIFNlbGVjdGVkSXRlbUtleURvd25OYXZpZ2F0aW9uTmV4dDogU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25OZXh0LFxuICBTZWxlY3RlZEl0ZW1LZXlEb3duTmF2aWdhdGlvblByZXZpb3VzOiBTZWxlY3RlZEl0ZW1LZXlEb3duTmF2aWdhdGlvblByZXZpb3VzLFxuICBEcm9wZG93bktleURvd25OYXZpZ2F0aW9uUHJldmlvdXM6IERyb3Bkb3duS2V5RG93bk5hdmlnYXRpb25QcmV2aW91cyxcbiAgRHJvcGRvd25LZXlEb3duQmFja3NwYWNlOiBEcm9wZG93bktleURvd25CYWNrc3BhY2UsXG4gIERyb3Bkb3duQ2xpY2s6IERyb3Bkb3duQ2xpY2ssXG4gIEZ1bmN0aW9uQWRkU2VsZWN0ZWRJdGVtOiBGdW5jdGlvbkFkZFNlbGVjdGVkSXRlbSxcbiAgRnVuY3Rpb25SZW1vdmVTZWxlY3RlZEl0ZW06IEZ1bmN0aW9uUmVtb3ZlU2VsZWN0ZWRJdGVtLFxuICBGdW5jdGlvblNldFNlbGVjdGVkSXRlbXM6IEZ1bmN0aW9uU2V0U2VsZWN0ZWRJdGVtcyxcbiAgRnVuY3Rpb25TZXRBY3RpdmVJbmRleDogRnVuY3Rpb25TZXRBY3RpdmVJbmRleCxcbiAgRnVuY3Rpb25SZXNldDogRnVuY3Rpb25SZXNldCQyXG59KTtcblxuLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqL1xuXG5mdW5jdGlvbiBkb3duc2hpZnRNdWx0aXBsZVNlbGVjdGlvblJlZHVjZXIoc3RhdGUsIGFjdGlvbikge1xuICB2YXIgdHlwZSA9IGFjdGlvbi50eXBlLFxuICAgICAgaW5kZXggPSBhY3Rpb24uaW5kZXgsXG4gICAgICBwcm9wcyA9IGFjdGlvbi5wcm9wcyxcbiAgICAgIHNlbGVjdGVkSXRlbSA9IGFjdGlvbi5zZWxlY3RlZEl0ZW07XG4gIHZhciBhY3RpdmVJbmRleCA9IHN0YXRlLmFjdGl2ZUluZGV4LFxuICAgICAgc2VsZWN0ZWRJdGVtcyA9IHN0YXRlLnNlbGVjdGVkSXRlbXM7XG4gIHZhciBjaGFuZ2VzO1xuXG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgU2VsZWN0ZWRJdGVtQ2xpY2s6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBhY3RpdmVJbmRleDogaW5kZXhcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25QcmV2aW91czpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGFjdGl2ZUluZGV4OiBhY3RpdmVJbmRleCAtIDEgPCAwID8gMCA6IGFjdGl2ZUluZGV4IC0gMVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBTZWxlY3RlZEl0ZW1LZXlEb3duTmF2aWdhdGlvbk5leHQ6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBhY3RpdmVJbmRleDogYWN0aXZlSW5kZXggKyAxID49IHNlbGVjdGVkSXRlbXMubGVuZ3RoID8gLTEgOiBhY3RpdmVJbmRleCArIDFcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgU2VsZWN0ZWRJdGVtS2V5RG93bkJhY2tzcGFjZTpcbiAgICBjYXNlIFNlbGVjdGVkSXRlbUtleURvd25EZWxldGU6XG4gICAgICB7XG4gICAgICAgIHZhciBuZXdBY3RpdmVJbmRleCA9IGFjdGl2ZUluZGV4O1xuXG4gICAgICAgIGlmIChzZWxlY3RlZEl0ZW1zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIG5ld0FjdGl2ZUluZGV4ID0gLTE7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aXZlSW5kZXggPT09IHNlbGVjdGVkSXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIG5ld0FjdGl2ZUluZGV4ID0gc2VsZWN0ZWRJdGVtcy5sZW5ndGggLSAyO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hhbmdlcyA9IF9leHRlbmRzKHtcbiAgICAgICAgICBzZWxlY3RlZEl0ZW1zOiBbXS5jb25jYXQoc2VsZWN0ZWRJdGVtcy5zbGljZSgwLCBhY3RpdmVJbmRleCksIHNlbGVjdGVkSXRlbXMuc2xpY2UoYWN0aXZlSW5kZXggKyAxKSlcbiAgICAgICAgfSwge1xuICAgICAgICAgIGFjdGl2ZUluZGV4OiBuZXdBY3RpdmVJbmRleFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICBjYXNlIERyb3Bkb3duS2V5RG93bk5hdmlnYXRpb25QcmV2aW91czpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGFjdGl2ZUluZGV4OiBzZWxlY3RlZEl0ZW1zLmxlbmd0aCAtIDFcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgRHJvcGRvd25LZXlEb3duQmFja3NwYWNlOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgc2VsZWN0ZWRJdGVtczogc2VsZWN0ZWRJdGVtcy5zbGljZSgwLCBzZWxlY3RlZEl0ZW1zLmxlbmd0aCAtIDEpXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIEZ1bmN0aW9uQWRkU2VsZWN0ZWRJdGVtOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgc2VsZWN0ZWRJdGVtczogW10uY29uY2F0KHNlbGVjdGVkSXRlbXMsIFtzZWxlY3RlZEl0ZW1dKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBEcm9wZG93bkNsaWNrOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgYWN0aXZlSW5kZXg6IC0xXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIEZ1bmN0aW9uUmVtb3ZlU2VsZWN0ZWRJdGVtOlxuICAgICAge1xuICAgICAgICB2YXIgX25ld0FjdGl2ZUluZGV4ID0gYWN0aXZlSW5kZXg7XG4gICAgICAgIHZhciBzZWxlY3RlZEl0ZW1JbmRleCA9IHNlbGVjdGVkSXRlbXMuaW5kZXhPZihzZWxlY3RlZEl0ZW0pO1xuXG4gICAgICAgIGlmIChzZWxlY3RlZEl0ZW1zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIF9uZXdBY3RpdmVJbmRleCA9IC0xO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkSXRlbUluZGV4ID09PSBzZWxlY3RlZEl0ZW1zLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICBfbmV3QWN0aXZlSW5kZXggPSBzZWxlY3RlZEl0ZW1zLmxlbmd0aCAtIDI7XG4gICAgICAgIH1cblxuICAgICAgICBjaGFuZ2VzID0gX2V4dGVuZHMoe1xuICAgICAgICAgIHNlbGVjdGVkSXRlbXM6IFtdLmNvbmNhdChzZWxlY3RlZEl0ZW1zLnNsaWNlKDAsIHNlbGVjdGVkSXRlbUluZGV4KSwgc2VsZWN0ZWRJdGVtcy5zbGljZShzZWxlY3RlZEl0ZW1JbmRleCArIDEpKVxuICAgICAgICB9LCB7XG4gICAgICAgICAgYWN0aXZlSW5kZXg6IF9uZXdBY3RpdmVJbmRleFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICBjYXNlIEZ1bmN0aW9uU2V0U2VsZWN0ZWRJdGVtczpcbiAgICAgIHtcbiAgICAgICAgdmFyIG5ld1NlbGVjdGVkSXRlbXMgPSBhY3Rpb24uc2VsZWN0ZWRJdGVtcztcbiAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICBzZWxlY3RlZEl0ZW1zOiBuZXdTZWxlY3RlZEl0ZW1zXG4gICAgICAgIH07XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgY2FzZSBGdW5jdGlvblNldEFjdGl2ZUluZGV4OlxuICAgICAge1xuICAgICAgICB2YXIgX25ld0FjdGl2ZUluZGV4MiA9IGFjdGlvbi5hY3RpdmVJbmRleDtcbiAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICBhY3RpdmVJbmRleDogX25ld0FjdGl2ZUluZGV4MlxuICAgICAgICB9O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgIGNhc2UgRnVuY3Rpb25SZXNldCQyOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgYWN0aXZlSW5kZXg6IGdldERlZmF1bHRWYWx1ZSQxKHByb3BzLCAnYWN0aXZlSW5kZXgnKSxcbiAgICAgICAgc2VsZWN0ZWRJdGVtczogZ2V0RGVmYXVsdFZhbHVlJDEocHJvcHMsICdzZWxlY3RlZEl0ZW1zJylcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlZHVjZXIgY2FsbGVkIHdpdGhvdXQgcHJvcGVyIGFjdGlvbiB0eXBlLicpO1xuICB9XG5cbiAgcmV0dXJuIF9leHRlbmRzKHt9LCBzdGF0ZSwgY2hhbmdlcyk7XG59XG5cbnVzZU11bHRpcGxlU2VsZWN0aW9uLnN0YXRlQ2hhbmdlVHlwZXMgPSBzdGF0ZUNoYW5nZVR5cGVzJDM7XG5cbmZ1bmN0aW9uIHVzZU11bHRpcGxlU2VsZWN0aW9uKHVzZXJQcm9wcykge1xuICBpZiAodXNlclByb3BzID09PSB2b2lkIDApIHtcbiAgICB1c2VyUHJvcHMgPSB7fTtcbiAgfVxuXG4gIC8vIFByb3BzIGRlZmF1bHRzIGFuZCBkZXN0cnVjdHVyaW5nLlxuICB2YXIgcHJvcHMgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdFByb3BzJDMsIHVzZXJQcm9wcyk7XG5cbiAgdmFyIGdldEExMXlSZW1vdmFsTWVzc2FnZSA9IHByb3BzLmdldEExMXlSZW1vdmFsTWVzc2FnZSxcbiAgICAgIGl0ZW1Ub1N0cmluZyA9IHByb3BzLml0ZW1Ub1N0cmluZyxcbiAgICAgIGVudmlyb25tZW50ID0gcHJvcHMuZW52aXJvbm1lbnQsXG4gICAgICBrZXlOYXZpZ2F0aW9uTmV4dCA9IHByb3BzLmtleU5hdmlnYXRpb25OZXh0LFxuICAgICAga2V5TmF2aWdhdGlvblByZXZpb3VzID0gcHJvcHMua2V5TmF2aWdhdGlvblByZXZpb3VzOyAvLyBSZWR1Y2VyIGluaXQuXG5cbiAgdmFyIF91c2VDb250cm9sbGVkUmVkdWNlciA9IHVzZUNvbnRyb2xsZWRSZWR1Y2VyKGRvd25zaGlmdE11bHRpcGxlU2VsZWN0aW9uUmVkdWNlciwgZ2V0SW5pdGlhbFN0YXRlJDIocHJvcHMpLCBwcm9wcyksXG4gICAgICBzdGF0ZSA9IF91c2VDb250cm9sbGVkUmVkdWNlclswXSxcbiAgICAgIGRpc3BhdGNoID0gX3VzZUNvbnRyb2xsZWRSZWR1Y2VyWzFdO1xuXG4gIHZhciBhY3RpdmVJbmRleCA9IHN0YXRlLmFjdGl2ZUluZGV4LFxuICAgICAgc2VsZWN0ZWRJdGVtcyA9IHN0YXRlLnNlbGVjdGVkSXRlbXM7IC8vIFJlZnMuXG5cbiAgdmFyIGlzSW5pdGlhbE1vdW50UmVmID0gdXNlUmVmKHRydWUpO1xuICB2YXIgZHJvcGRvd25SZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciBwcmV2aW91c1NlbGVjdGVkSXRlbXNSZWYgPSB1c2VSZWYoc2VsZWN0ZWRJdGVtcyk7XG4gIHZhciBzZWxlY3RlZEl0ZW1SZWZzID0gdXNlUmVmKCk7XG4gIHNlbGVjdGVkSXRlbVJlZnMuY3VycmVudCA9IFtdO1xuICB2YXIgbGF0ZXN0ID0gdXNlTGF0ZXN0UmVmKHtcbiAgICBzdGF0ZTogc3RhdGUsXG4gICAgcHJvcHM6IHByb3BzXG4gIH0pOyAvLyBFZmZlY3RzLlxuXG4gIC8qIFNldHMgYTExeSBzdGF0dXMgbWVzc2FnZSBvbiBjaGFuZ2VzIGluIHNlbGVjdGVkSXRlbS4gKi9cblxuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmIChpc0luaXRpYWxNb3VudFJlZi5jdXJyZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHNlbGVjdGVkSXRlbXMubGVuZ3RoIDwgcHJldmlvdXNTZWxlY3RlZEl0ZW1zUmVmLmN1cnJlbnQubGVuZ3RoKSB7XG4gICAgICB2YXIgcmVtb3ZlZFNlbGVjdGVkSXRlbSA9IHByZXZpb3VzU2VsZWN0ZWRJdGVtc1JlZi5jdXJyZW50LmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkSXRlbXMuaW5kZXhPZihpdGVtKSA8IDA7XG4gICAgICB9KTtcbiAgICAgIHNldFN0YXR1cyhnZXRBMTF5UmVtb3ZhbE1lc3NhZ2Uoe1xuICAgICAgICBpdGVtVG9TdHJpbmc6IGl0ZW1Ub1N0cmluZyxcbiAgICAgICAgcmVzdWx0Q291bnQ6IHNlbGVjdGVkSXRlbXMubGVuZ3RoLFxuICAgICAgICByZW1vdmVkU2VsZWN0ZWRJdGVtOiByZW1vdmVkU2VsZWN0ZWRJdGVtLFxuICAgICAgICBhY3RpdmVJbmRleDogYWN0aXZlSW5kZXgsXG4gICAgICAgIGFjdGl2ZVNlbGVjdGVkSXRlbTogc2VsZWN0ZWRJdGVtc1thY3RpdmVJbmRleF1cbiAgICAgIH0pLCBlbnZpcm9ubWVudC5kb2N1bWVudCk7XG4gICAgfVxuXG4gICAgcHJldmlvdXNTZWxlY3RlZEl0ZW1zUmVmLmN1cnJlbnQgPSBzZWxlY3RlZEl0ZW1zOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtzZWxlY3RlZEl0ZW1zLmxlbmd0aF0pOyAvLyBTZXRzIGZvY3VzIG9uIGFjdGl2ZSBpdGVtLlxuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoYWN0aXZlSW5kZXggPT09IC0xICYmIGRyb3Bkb3duUmVmLmN1cnJlbnQpIHtcbiAgICAgIGRyb3Bkb3duUmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICB9IGVsc2UgaWYgKHNlbGVjdGVkSXRlbVJlZnMuY3VycmVudFthY3RpdmVJbmRleF0pIHtcbiAgICAgIHNlbGVjdGVkSXRlbVJlZnMuY3VycmVudFthY3RpdmVJbmRleF0uZm9jdXMoKTtcbiAgICB9XG4gIH0sIFthY3RpdmVJbmRleF0pO1xuICB1c2VDb250cm9sUHJvcHNWYWxpZGF0b3Ioe1xuICAgIGlzSW5pdGlhbE1vdW50OiBpc0luaXRpYWxNb3VudFJlZi5jdXJyZW50LFxuICAgIHByb3BzOiBwcm9wcyxcbiAgICBzdGF0ZTogc3RhdGVcbiAgfSk7XG4gIHZhciBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8gPSB1c2VHZXR0ZXJQcm9wc0NhbGxlZENoZWNrZXIoJ2dldERyb3Bkb3duUHJvcHMnKTsgLy8gTWFrZSBpbml0aWFsIHJlZiBmYWxzZS5cblxuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgfSwgW10pOyAvLyBFdmVudCBoYW5kbGVyIGZ1bmN0aW9ucy5cblxuICB2YXIgc2VsZWN0ZWRJdGVtS2V5RG93bkhhbmRsZXJzID0gdXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9yZWY7XG5cbiAgICByZXR1cm4gX3JlZiA9IHt9LCBfcmVmW2tleU5hdmlnYXRpb25QcmV2aW91c10gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IFNlbGVjdGVkSXRlbUtleURvd25OYXZpZ2F0aW9uUHJldmlvdXNcbiAgICAgIH0pO1xuICAgIH0sIF9yZWZba2V5TmF2aWdhdGlvbk5leHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBTZWxlY3RlZEl0ZW1LZXlEb3duTmF2aWdhdGlvbk5leHRcbiAgICAgIH0pO1xuICAgIH0sIF9yZWYuRGVsZXRlID0gZnVuY3Rpb24gRGVsZXRlKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBTZWxlY3RlZEl0ZW1LZXlEb3duRGVsZXRlXG4gICAgICB9KTtcbiAgICB9LCBfcmVmLkJhY2tzcGFjZSA9IGZ1bmN0aW9uIEJhY2tzcGFjZSgpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogU2VsZWN0ZWRJdGVtS2V5RG93bkJhY2tzcGFjZVxuICAgICAgfSk7XG4gICAgfSwgX3JlZjtcbiAgfSwgW2Rpc3BhdGNoLCBrZXlOYXZpZ2F0aW9uTmV4dCwga2V5TmF2aWdhdGlvblByZXZpb3VzXSk7XG4gIHZhciBkcm9wZG93bktleURvd25IYW5kbGVycyA9IHVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHZhciBfcmVmMjtcblxuICAgIHJldHVybiBfcmVmMiA9IHt9LCBfcmVmMltrZXlOYXZpZ2F0aW9uUHJldmlvdXNdID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBpZiAoaXNLZXlEb3duT3BlcmF0aW9uUGVybWl0dGVkKGV2ZW50KSkge1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogRHJvcGRvd25LZXlEb3duTmF2aWdhdGlvblByZXZpb3VzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sIF9yZWYyLkJhY2tzcGFjZSA9IGZ1bmN0aW9uIEJhY2tzcGFjZShldmVudCkge1xuICAgICAgaWYgKGlzS2V5RG93bk9wZXJhdGlvblBlcm1pdHRlZChldmVudCkpIHtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IERyb3Bkb3duS2V5RG93bkJhY2tzcGFjZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LCBfcmVmMjtcbiAgfSwgW2Rpc3BhdGNoLCBrZXlOYXZpZ2F0aW9uUHJldmlvdXNdKTsgLy8gR2V0dGVyIHByb3BzLlxuXG4gIHZhciBnZXRTZWxlY3RlZEl0ZW1Qcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcCkge1xuICAgIHZhciBfZXh0ZW5kczI7XG5cbiAgICB2YXIgX3JlZjMgPSBfdGVtcCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcCxcbiAgICAgICAgX3JlZjMkcmVmS2V5ID0gX3JlZjMucmVmS2V5LFxuICAgICAgICByZWZLZXkgPSBfcmVmMyRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjMkcmVmS2V5LFxuICAgICAgICByZWYgPSBfcmVmMy5yZWYsXG4gICAgICAgIG9uQ2xpY2sgPSBfcmVmMy5vbkNsaWNrLFxuICAgICAgICBvbktleURvd24gPSBfcmVmMy5vbktleURvd24sXG4gICAgICAgIHNlbGVjdGVkSXRlbSA9IF9yZWYzLnNlbGVjdGVkSXRlbSxcbiAgICAgICAgaW5kZXggPSBfcmVmMy5pbmRleCxcbiAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYzLCBbXCJyZWZLZXlcIiwgXCJyZWZcIiwgXCJvbkNsaWNrXCIsIFwib25LZXlEb3duXCIsIFwic2VsZWN0ZWRJdGVtXCIsIFwiaW5kZXhcIl0pO1xuXG4gICAgdmFyIGxhdGVzdFN0YXRlID0gbGF0ZXN0LmN1cnJlbnQuc3RhdGU7XG4gICAgdmFyIGl0ZW1JbmRleCA9IGdldEl0ZW1JbmRleChpbmRleCwgc2VsZWN0ZWRJdGVtLCBsYXRlc3RTdGF0ZS5zZWxlY3RlZEl0ZW1zKTtcblxuICAgIGlmIChpdGVtSW5kZXggPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bhc3MgZWl0aGVyIHNlbGVjdGVkSXRlbSBvciBpbmRleCBpbiBnZXRTZWxlY3RlZEl0ZW1Qcm9wcyEnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gX2V4dGVuZHMoKF9leHRlbmRzMiA9IHt9LCBfZXh0ZW5kczJbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtTm9kZSkge1xuICAgICAgaWYgKHNlbGVjdGVkSXRlbU5vZGUpIHtcbiAgICAgICAgc2VsZWN0ZWRJdGVtUmVmcy5jdXJyZW50LnB1c2goc2VsZWN0ZWRJdGVtTm9kZSk7XG4gICAgICB9XG4gICAgfSksIF9leHRlbmRzMi50YWJJbmRleCA9IGluZGV4ID09PSBsYXRlc3RTdGF0ZS5hY3RpdmVJbmRleCA/IDAgOiAtMSwgX2V4dGVuZHMyLm9uQ2xpY2sgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkNsaWNrLCBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1IYW5kbGVDbGljaygpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogU2VsZWN0ZWRJdGVtQ2xpY2ssXG4gICAgICAgIGluZGV4OiBpbmRleFxuICAgICAgfSk7XG4gICAgfSksIF9leHRlbmRzMi5vbktleURvd24gPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbktleURvd24sIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUhhbmRsZUtleURvd24oZXZlbnQpIHtcbiAgICAgIHZhciBrZXkgPSBub3JtYWxpemVBcnJvd0tleShldmVudCk7XG5cbiAgICAgIGlmIChrZXkgJiYgc2VsZWN0ZWRJdGVtS2V5RG93bkhhbmRsZXJzW2tleV0pIHtcbiAgICAgICAgc2VsZWN0ZWRJdGVtS2V5RG93bkhhbmRsZXJzW2tleV0oZXZlbnQpO1xuICAgICAgfVxuICAgIH0pLCBfZXh0ZW5kczIpLCByZXN0KTtcbiAgfSwgW2Rpc3BhdGNoLCBsYXRlc3QsIHNlbGVjdGVkSXRlbUtleURvd25IYW5kbGVyc10pO1xuICB2YXIgZ2V0RHJvcGRvd25Qcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcDIsIF90ZW1wMykge1xuICAgIHZhciBfZXh0ZW5kczM7XG5cbiAgICB2YXIgX3JlZjQgPSBfdGVtcDIgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAyLFxuICAgICAgICBfcmVmNCRyZWZLZXkgPSBfcmVmNC5yZWZLZXksXG4gICAgICAgIHJlZktleSA9IF9yZWY0JHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmNCRyZWZLZXksXG4gICAgICAgIHJlZiA9IF9yZWY0LnJlZixcbiAgICAgICAgb25LZXlEb3duID0gX3JlZjQub25LZXlEb3duLFxuICAgICAgICBvbkNsaWNrID0gX3JlZjQub25DbGljayxcbiAgICAgICAgX3JlZjQkcHJldmVudEtleUFjdGlvID0gX3JlZjQucHJldmVudEtleUFjdGlvbixcbiAgICAgICAgcHJldmVudEtleUFjdGlvbiA9IF9yZWY0JHByZXZlbnRLZXlBY3RpbyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmNCRwcmV2ZW50S2V5QWN0aW8sXG4gICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNCwgW1wicmVmS2V5XCIsIFwicmVmXCIsIFwib25LZXlEb3duXCIsIFwib25DbGlja1wiLCBcInByZXZlbnRLZXlBY3Rpb25cIl0pO1xuXG4gICAgdmFyIF9yZWY1ID0gX3RlbXAzID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wMyxcbiAgICAgICAgX3JlZjUkc3VwcHJlc3NSZWZFcnJvID0gX3JlZjUuc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgICAgc3VwcHJlc3NSZWZFcnJvciA9IF9yZWY1JHN1cHByZXNzUmVmRXJybyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmNSRzdXBwcmVzc1JlZkVycm87XG5cbiAgICBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8oJ2dldERyb3Bkb3duUHJvcHMnLCBzdXBwcmVzc1JlZkVycm9yLCByZWZLZXksIGRyb3Bkb3duUmVmKTtcbiAgICByZXR1cm4gX2V4dGVuZHMoKF9leHRlbmRzMyA9IHt9LCBfZXh0ZW5kczNbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBmdW5jdGlvbiAoZHJvcGRvd25Ob2RlKSB7XG4gICAgICBpZiAoZHJvcGRvd25Ob2RlKSB7XG4gICAgICAgIGRyb3Bkb3duUmVmLmN1cnJlbnQgPSBkcm9wZG93bk5vZGU7XG4gICAgICB9XG4gICAgfSksIF9leHRlbmRzMyksICFwcmV2ZW50S2V5QWN0aW9uICYmIHtcbiAgICAgIG9uS2V5RG93bjogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCBmdW5jdGlvbiBkcm9wZG93bkhhbmRsZUtleURvd24oZXZlbnQpIHtcbiAgICAgICAgdmFyIGtleSA9IG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KTtcblxuICAgICAgICBpZiAoa2V5ICYmIGRyb3Bkb3duS2V5RG93bkhhbmRsZXJzW2tleV0pIHtcbiAgICAgICAgICBkcm9wZG93bktleURvd25IYW5kbGVyc1trZXldKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSksXG4gICAgICBvbkNsaWNrOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkNsaWNrLCBmdW5jdGlvbiBkcm9wZG93bkhhbmRsZUNsaWNrKCkge1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogRHJvcGRvd25DbGlja1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgfSwgcmVzdCk7XG4gIH0sIFtkaXNwYXRjaCwgZHJvcGRvd25LZXlEb3duSGFuZGxlcnMsIHNldEdldHRlclByb3BDYWxsSW5mb10pOyAvLyByZXR1cm5zXG5cbiAgdmFyIGFkZFNlbGVjdGVkSXRlbSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvbkFkZFNlbGVjdGVkSXRlbSxcbiAgICAgIHNlbGVjdGVkSXRlbTogc2VsZWN0ZWRJdGVtXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgcmVtb3ZlU2VsZWN0ZWRJdGVtID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6IEZ1bmN0aW9uUmVtb3ZlU2VsZWN0ZWRJdGVtLFxuICAgICAgc2VsZWN0ZWRJdGVtOiBzZWxlY3RlZEl0ZW1cbiAgICB9KTtcbiAgfSwgW2Rpc3BhdGNoXSk7XG4gIHZhciBzZXRTZWxlY3RlZEl0ZW1zID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKG5ld1NlbGVjdGVkSXRlbXMpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNldFNlbGVjdGVkSXRlbXMsXG4gICAgICBzZWxlY3RlZEl0ZW1zOiBuZXdTZWxlY3RlZEl0ZW1zXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2V0QWN0aXZlSW5kZXggPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAobmV3QWN0aXZlSW5kZXgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNldEFjdGl2ZUluZGV4LFxuICAgICAgYWN0aXZlSW5kZXg6IG5ld0FjdGl2ZUluZGV4XG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgcmVzZXQgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25SZXNldCQyXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICByZXR1cm4ge1xuICAgIGdldFNlbGVjdGVkSXRlbVByb3BzOiBnZXRTZWxlY3RlZEl0ZW1Qcm9wcyxcbiAgICBnZXREcm9wZG93blByb3BzOiBnZXREcm9wZG93blByb3BzLFxuICAgIGFkZFNlbGVjdGVkSXRlbTogYWRkU2VsZWN0ZWRJdGVtLFxuICAgIHJlbW92ZVNlbGVjdGVkSXRlbTogcmVtb3ZlU2VsZWN0ZWRJdGVtLFxuICAgIHNldFNlbGVjdGVkSXRlbXM6IHNldFNlbGVjdGVkSXRlbXMsXG4gICAgc2V0QWN0aXZlSW5kZXg6IHNldEFjdGl2ZUluZGV4LFxuICAgIHJlc2V0OiByZXNldCxcbiAgICBzZWxlY3RlZEl0ZW1zOiBzZWxlY3RlZEl0ZW1zLFxuICAgIGFjdGl2ZUluZGV4OiBhY3RpdmVJbmRleFxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBEb3duc2hpZnQ7XG5leHBvcnQgeyByZXNldElkQ291bnRlciwgdXNlQ29tYm9ib3gsIHVzZU11bHRpcGxlU2VsZWN0aW9uLCB1c2VTZWxlY3QgfTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/downshift/dist/downshift.esm.js\n");

/***/ })

})